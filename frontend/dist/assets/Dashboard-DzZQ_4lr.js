import{b as tt,c as st,u as at,r as a,a as m,j as e,R as ce}from"./index-xcBp2yTO.js";import{A as rt}from"./AchievementUnlock-DNpO4tS9.js";import{L as lt}from"./LoadingRunner-D_xQNgIC.js";import{X as de}from"./x-BMwewO6c.js";import{F as nt}from"./footprints-Bp_KyIQG.js";import{D as ot}from"./dumbbell-Ctdbn47z.js";import{F as it}from"./flame-BeY_CO8H.js";import{A as ct,a as dt}from"./arrow-up-right-CdWIPC_G.js";import{T as ut}from"./triangle-alert-Zm4z8z4-.js";import{W as xt}from"./watch-CE0LhDaa.js";function ue(s){if(!s)return"0 min";const l=Math.floor(s/3600),o=Math.floor(s%3600/60);return l>0?o>0?`${l}h ${o}min`:`${l}h`:`${o} min`}function mt(s){if(!s)return"0m";const l=Math.floor(s/3600),o=Math.floor(s%3600/60);return l>0?`${l}h ${o}m`:`${o}m`}function Y(s,l=900){const[o,r]=ce.useState(0);return ce.useEffect(()=>{if(!s){r(0);return}let g=0;const f=s/(l/16),x=setInterval(()=>{g+=f,g>=s?(r(s),clearInterval(x)):r(Math.floor(g))},16);return()=>clearInterval(x)},[s,l]),o}function pt({data:s=[]}){if(!s.length)return null;const l=Math.max(...s.map(x=>x.miles),1),o=100,r=40,g=s.map((x,d)=>{const v=d/(s.length-1)*o,$=r-x.miles/l*r;return`${v},${$}`}).join(" "),f=`0,${r} `+g+` ${o},${r}`;return e.jsxs("svg",{viewBox:`0 0 ${o} ${r}`,className:"w-full h-16",preserveAspectRatio:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--accent)",stopOpacity:"0.4"}),e.jsx("stop",{offset:"100%",stopColor:"var(--accent)",stopOpacity:"0"})]})}),e.jsx("polygon",{points:f,fill:"url(#trendGrad)"}),e.jsx("polyline",{points:g,fill:"none",stroke:"var(--accent)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),s.map((x,d)=>{const v=d/(s.length-1)*o,$=r-x.miles/l*r;return x.miles>0?e.jsx("circle",{cx:v,cy:$,r:"1.5",fill:"var(--accent)"},d):null})]})}function ht({score:s,onClick:l}){const f=2*Math.PI*28,x=s/100*f,d=s>=75?"#22c55e":s>=50?"var(--accent)":"#ef4444",v=s>=80?"Optimal":s>=60?"Good":s>=40?"Moderate":"Low";return e.jsxs("div",{onClick:l,style:{cursor:"pointer"},className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("svg",{width:"72",height:"72",viewBox:"0 0 72 72",children:[e.jsx("circle",{cx:36,cy:36,r:28,fill:"none",stroke:"var(--border-subtle)",strokeWidth:"5"}),e.jsx("circle",{cx:36,cy:36,r:28,fill:"none",stroke:d,strokeWidth:"5",strokeDasharray:`${x} ${f}`,strokeLinecap:"round",transform:"rotate(-90 36 36)"}),e.jsx("text",{x:36,y:37,textAnchor:"middle",dominantBaseline:"middle",fontSize:"13",fontWeight:"bold",fill:d,children:s})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-base",style:{color:"var(--text-primary)"},children:v}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:"Training readiness"}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)",opacity:.7},children:s>=75?"Go hard today.":s>=50?"Moderate effort.":"Take it easy today."})]})]}),e.jsx("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)",opacity:.6},children:"Tap to see breakdown"})]})}function xe(){const s=new Date,l=new Date(Date.UTC(s.getFullYear(),0,1)),o=Math.floor((s-l)/864e5),r=Math.ceil((o+l.getUTCDay()+1)/7);return`${s.getFullYear()}-${String(r).padStart(2,"0")}`}function yt(){const[s,l]=a.useState(null),[o,r]=a.useState(!1),[g,f]=a.useState(!1);a.useEffect(()=>{const v=localStorage.getItem("forge_token");if(!v)return;fetch("/api/watch-sync/status",{headers:{Authorization:`Bearer ${v}`}}).then(h=>h.ok?h.json():null).then(h=>l(h)).catch(()=>{});const $=setInterval(()=>{fetch("/api/watch-sync/status",{headers:{Authorization:`Bearer ${v}`}}).then(h=>h.ok?h.json():null).then(h=>{h&&s&&h.synced_at!==(s==null?void 0:s.synced_at)&&(f(!0),setTimeout(()=>f(!1),3e3)),l(h)}).catch(()=>{})},1e4);return()=>clearInterval($)},[]);const x=(s==null?void 0:s.treadmill_brand)||(s==null?void 0:s.watch_mode)||null,d=s&&(s.avg_heart_rate||s.distance_miles);return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("style",{children:`
        @keyframes watchPulse { 0%,100% { box-shadow: 0 0 0 0 rgba(234,179,8,0.4); } 50% { box-shadow: 0 0 0 8px rgba(234,179,8,0); } }
        @keyframes syncFlash { 0% { background: rgba(34,197,94,0.3); } 100% { background: transparent; } }
      `}),e.jsxs("button",{onClick:()=>{r(!0),setTimeout(()=>r(!1),1500)},style:{display:"flex",alignItems:"center",gap:6,background:d?"rgba(234,179,8,0.1)":"var(--bg-input)",border:`1px solid ${d?"rgba(234,179,8,0.4)":"var(--border-subtle)"}`,borderRadius:10,padding:"6px 12px",cursor:"pointer",animation:o?"watchPulse 1s ease-in-out infinite":"none",transition:"all 0.3s ease",...g?{animation:"syncFlash 1s ease forwards"}:{}},children:[e.jsx(xt,{size:14,color:d?"#EAB308":"var(--text-muted)"}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("p",{style:{fontSize:9,color:"var(--text-muted)",margin:0,letterSpacing:.5,textTransform:"uppercase"},children:x||"Watch"}),e.jsx("p",{style:{fontSize:11,fontWeight:700,color:d?"#EAB308":"var(--text-muted)",margin:0},children:g?"Synced!":d?`HR ${s.avg_heart_rate||"--"} bpm`:"No data"})]}),d&&e.jsx("div",{style:{width:6,height:6,borderRadius:"50%",background:"#22c55e",animation:"watchPulse 2s ease infinite"}})]}),e.jsx("p",{style:{fontSize:9,color:"var(--text-muted)",textAlign:"center",marginTop:2},children:"+ Meta Glasses (soon)"})]})}function $t(){var I,re,le,ne;const s=tt(),{fmt:l}=st(),{t:o}=at(),[r,g]=a.useState(null),[f,x]=a.useState([]),[d,v]=a.useState([]),[$,h]=a.useState(!1),[me,pe]=a.useState(!0),[M,he]=a.useState("week"),[H,ye]=a.useState(!1),[O,ge]=a.useState(!1),[V,fe]=a.useState("auto"),[G,be]=a.useState(null),[gt,ft]=a.useState(!1),[bt,vt]=a.useState(""),[ve,U]=a.useState(!1),[i,F]=a.useState(null),[y,K]=a.useState(null),[Q,je]=a.useState([]),[ke,Se]=a.useState({currentStreak:0,bestStreak:0}),[J,X]=a.useState([]),[q,Z]=a.useState(null),[b,we]=a.useState(null),[ee,Ne]=a.useState(!1),[N,_e]=a.useState(null),[P,Re]=a.useState(null),[Ce,De]=a.useState(Number(localStorage.getItem("forge_load_warning_dismissed_until")||0)),[Te,$e]=a.useState([]),[ze,We]=a.useState(0),[D,Ae]=a.useState(null),[_,Me]=a.useState(null),[Le,te]=a.useState(!1),[L,Be]=a.useState(null),[Ie,se]=a.useState(!1);a.useEffect(()=>{(async()=>{var t,n,u,p,c,j,k;try{const[W,R,T,S,A,C,Oe,Ve,Ke,Qe,Je,Xe,qe]=await Promise.all([m.get("/auth/me/stats"),m.get("/runs",{params:{limit:5}}),m.get("/lifts"),m.get("/coach/warning"),m.get("/checkin/today").catch(()=>({data:null})),m.get("/users/goal").catch(()=>({data:null})),m.get("/auth/me/streak").catch(()=>({data:{currentStreak:0,bestStreak:0}})),m.get("/milestones/new").catch(()=>({data:{milestones:[]}})),m.get("/plans/compliance").catch(()=>({data:null})),m.get("/runs/load-analysis").catch(()=>({data:null})),m.get("/races/next").catch(()=>({data:{race:null}})),m.get("/gear/shoes").catch(()=>({data:{shoes:[]}})),m.get("/injury/active").catch(()=>({data:{injuries:[]}}))]);g(W.data);const oe=Array.isArray(R.data)?R.data:((t=R.data)==null?void 0:t.runs)||[];x(oe),ge(oe.some(w=>w.avg_heart_rate||w.watch_mode||w.route_coords)),v(Array.isArray(T.data)?T.data:((n=T.data)==null?void 0:n.lifts)||[]),h(((u=S.data)==null?void 0:u.warning)===!0),A.data&&(ye(!0),Ae(A.data)),C.data&&(fe(C.data.mode||"auto"),be(C.data.miles||null)),Se(Oe.data||{currentStreak:0,bestStreak:0});const E=((p=Ve.data)==null?void 0:p.milestones)||[];X(E),E.length>0&&Z(w=>w||{name:E[0].title,description:E[0].description,icon:"Award",color:"#EAB308"}),we(Ke.data),_e(Qe.data),Re(((c=Je.data)==null?void 0:c.race)||null),$e((((j=Xe.data)==null?void 0:j.shoes)||[]).filter(w=>Number(w.total_miles||0)>450)),Me((((k=qe.data)==null?void 0:k.injuries)||[])[0]||null),m.get("/recap/weekly").then(w=>{var ie;We(((ie=w.data)==null?void 0:ie.totalCalories)||0);const Ze=new Date().getDay()===0,et=`recap-seen-${xe()}`;Ze&&localStorage.getItem(et)!=="1"&&(Be(w.data||null),se(!0))}).catch(()=>{})}finally{pe(!1)}})()},[]),a.useEffect(()=>{const t=localStorage.getItem("forge_last_watch_sync_seen_at")||"1970-01-01T00:00:00";m.get("/watch-sync/recent",{params:{since:t}}).then(n=>{var p;const u=((p=n.data)==null?void 0:p.items)||[];u.length&&(je(u.filter(c=>c.routed_section==="other")),K(u[0]))}).catch(()=>{})},[]),a.useEffect(()=>{te(!1)},[_==null?void 0:_.id]);const{readiness:z,readinessBreakdown:Ee}=a.useMemo(()=>{var A;if(!r||!H||!O)return{readiness:null,readinessBreakdown:[]};const{streak:t,week:n,all:u}=r;let p=50;const c=[];c.push({label:"Base score",value:50,delta:0,reason:"Starting point for all athletes."});const j=Math.min(t*4,20);p+=j,c.push({label:"Consistency streak",value:j,delta:j,reason:t>0?`${t}-day active streak adds +${j} pts. Staying consistent pays off.`:"No active streak. Logging runs builds your streak bonus."});const k=u.miles/Math.max((A=r.weeklyTrend)==null?void 0:A.filter(C=>C.miles>0).length,1),W=k>0?n.miles/k:0;let R=0,T="";W<.5?(R=15,T=`This week you ran ${l.distance(n.miles,1)} vs your avg ${l.distance(k,1)} — low volume means your legs are fresh.`):W>1.3?(R=-15,T=`This week you ran ${l.distance(n.miles,1)} vs your avg ${l.distance(k,1)} — high volume week, body needs recovery.`):T=`This week (${l.distance(n.miles,1)}) is on par with your average (${l.distance(k,1)}) — balanced load.`,p+=R,c.push({label:"Weekly load",value:R,delta:R,reason:T});const S=Number((D==null?void 0:D.sleep_hours)||0);if(S>0){const C=S<6?-12:S>=8?5:0;p+=C,c.push({label:"Sleep",value:C,delta:C,reason:S<6?`${S}h sleep lowers readiness today.`:S>=8?`${S}h sleep boosts recovery readiness.`:`${S}h sleep is neutral for readiness.`})}return{readiness:Math.max(1,Math.min(99,Math.round(p))),readinessBreakdown:c}},[r,H,O,D,l]);a.useMemo(()=>{var p;if(!r)return null;const t=((p=r.month)==null?void 0:p.miles)||0;let n;V==="manual"&&G?n=G:n=Math.max(25,Math.ceil(t/25)*25+(t>=25?25:0));const u=Math.min(t/n*100,100);return{miles:t,goal:n,pct:u}},[r,V,G]);const B=(r==null?void 0:r[M])||{},He=Y(Math.round((B.miles||0)*10),900),Ge=Y(B.count||0,900);Y(ke.currentStreak||0,900);const ae=a.useMemo(()=>{const t=f.slice(0,3).map(c=>({...c,_type:"run"})),n=(d||[]).slice(0,3).map(c=>({...c,_type:"lift"})),u=(Q||[]).slice(0,3).map(c=>({...c,_type:"other"}));return[...t,...n,...u].sort((c,j)=>{const k=c.date||c.started_at||c.created_at||"";return(j.date||j.started_at||j.created_at||"").localeCompare(k)}).slice(0,4)},[f,d,Q]),Ue=N&&["elevated","high","danger"].includes(N.loadStatus)&&Date.now()>Ce,Fe=(b==null?void 0:b.score)>=80?"#22c55e":(b==null?void 0:b.score)>=50?"#EAB308":"#ef4444",Pe={day:"Today",week:o("dashboard.thisWeek"),month:"This Month",year:"This Year",all:"All Time"},Ye=Le||_&&localStorage.getItem(`forge-injury-dismissed-${_.id}`)==="1";return me?e.jsx(lt,{message:"Getting ready"}):e.jsxs("div",{className:"space-y-4",children:[q&&e.jsx(rt,{badge:q,onDismiss:()=>Z(null)}),e.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes ringClose {
          0% { opacity: 1; stroke-dasharray: 157 0; }
          80% { opacity: 1; stroke-dasharray: 157 0; }
          100% { opacity: 0; stroke-dasharray: 157 0; }
        }
      `}),!Ye&&_&&e.jsx("div",{className:"rounded-xl p-4",style:{background:"rgba(234,179,8,0.2)",border:"1px solid #EAB308"},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold",style:{color:"#0f1117"},children:["Recovery Mode — ",_.body_part||"Injury"," — Est. return: ",_.date||"--"]}),e.jsx("p",{className:"text-xs mt-1",style:{color:"#0f1117"},children:"Your plan has been adjusted for recovery. Focus on PT and low-impact activity."})]}),e.jsx("button",{onClick:()=>{localStorage.setItem(`forge-injury-dismissed-${_.id}`,"1"),te(!0)},className:"rounded-md p-1",style:{background:"transparent",color:"#0f1117"},"aria-label":"Dismiss injury warning",children:e.jsx(de,{size:16})})]})}),e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"#1a1d2e",border:"1px solid #2a2d3e"},children:[e.jsx("p",{className:"text-xs mb-3",style:{color:"#EAB308"},children:"Quick Log"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>s("/log-run"),className:"rounded-xl px-4 py-5 font-black text-base flex items-center justify-center gap-2",style:{background:"#EAB308",color:"#0f1117",minHeight:72},children:[e.jsx(nt,{size:20})," Log Run"]}),e.jsxs("button",{onClick:()=>s("/log-lift"),className:"rounded-xl px-4 py-5 font-black text-base flex items-center justify-center gap-2",style:{background:"#EAB308",color:"#0f1117",minHeight:72},children:[e.jsx(ot,{size:20})," Log Lift"]})]})]}),e.jsx(yt,{}),Ie&&L&&e.jsx("div",{className:"rounded-xl p-4",style:{background:"#1a1d2e",border:"1px solid #2a2d3e"},children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",style:{color:"#EAB308"},children:"Weekly Recap"}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:[((re=(I=L.totalMiles)==null?void 0:I.toFixed)==null?void 0:re.call(I,1))||0," mi · ",L.totalRuns||0," runs · ",(L.totalCalories||0).toLocaleString()," cal"]})]}),e.jsx("button",{onClick:()=>{localStorage.setItem(`recap-seen-${xe()}`,"1"),se(!1)},style:{background:"transparent",color:"var(--text-muted)"},className:"p-1","aria-label":"Dismiss weekly recap",children:e.jsx(de,{size:16})})]})}),Ue&&e.jsxs("div",{className:"rounded-xl p-3",style:{background:N.loadStatus==="danger"?"rgba(239,68,68,0.12)":N.loadStatus==="high"?"rgba(249,115,22,0.12)":"rgba(234,179,8,0.12)",border:`1px solid ${N.loadStatus==="danger"?"rgba(239,68,68,0.35)":N.loadStatus==="high"?"rgba(249,115,22,0.35)":"rgba(234,179,8,0.35)"}`},children:[e.jsxs("p",{className:"text-xs font-bold uppercase",style:{color:"var(--text-primary)"},children:[N.loadStatus," load"]}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:N.warning||N.recommendation}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{className:"rounded-lg px-3 py-1.5 text-xs font-bold",style:{background:"var(--accent)",color:"#000"},onClick:()=>s("/plan",{state:{suggestEasyDay:!0}}),children:"Take Easy Day"}),e.jsx("button",{className:"rounded-lg px-3 py-1.5 text-xs",style:{background:"var(--bg-input)",color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},onClick:()=>{const t=Date.now()+864e5;localStorage.setItem("forge_load_warning_dismissed_until",String(t)),De(t)},children:"OK"})]})]}),P&&(()=>{const t=Math.ceil((new Date(`${P.race_date}T12:00:00`).getTime()-Date.now())/864e5);return t>0&&t<=60?e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Next Race"}),e.jsx("p",{className:"text-base font-bold",style:{color:"var(--text-primary)"},children:P.race_name}),e.jsxs("p",{className:"text-sm",style:{color:"var(--accent)"},children:[t," days to go"]})]}):null})(),b&&e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},onClick:()=>Ne(!ee),children:[e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:[o("dashboard.thisWeek"),": ",b.completed,"/",b.planned," sessions — ",b.score,"%"]}),e.jsx("div",{className:"w-full h-2 rounded-full mt-2",style:{background:"var(--bg-input)"},children:e.jsx("div",{className:"h-2 rounded-full",style:{width:`${b.score}%`,background:Fe}})}),ee&&e.jsx("div",{className:"mt-3 space-y-1",children:(b.sessions||[]).map((t,n)=>e.jsxs("p",{className:"text-xs",style:{color:t.completed?"#22c55e":"#ef4444"},children:[t.day,": ",t.type," ",t.completed?"hit":"missed"]},n))})]}),J.length>0&&e.jsx("div",{className:"space-y-2",children:J.map(t=>e.jsxs("div",{className:"rounded-xl p-3 flex items-center justify-between",style:{background:"rgba(234,179,8,0.12)",border:"1px solid rgba(234,179,8,0.3)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:t.title}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:t.description})]}),e.jsx("button",{onClick:()=>X(n=>n.filter(u=>u.key!==t.key)),className:"text-xs",style:{color:"var(--text-muted)"},children:"Dismiss"})]},t.key))}),!H&&e.jsxs("a",{href:"/checkin",style:{display:"block",background:"rgba(234,179,8,0.12)",border:"1px solid rgba(234,179,8,0.3)",borderRadius:14,padding:"12px 16px",marginBottom:12,textDecoration:"none"},children:[e.jsx("p",{style:{color:"var(--accent)",fontWeight:700,fontSize:14,margin:0},children:"Quick check-in — 3 taps"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:12,margin:"2px 0 0"},children:"Help me adjust today's plan around your day"})]}),y&&e.jsxs("div",{className:"rounded-xl p-3",style:{background:"rgba(234,179,8,0.12)",border:"1px solid rgba(234,179,8,0.3)"},children:[e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:["New activity synced from your watch — ",y.activity_name,". View it in ",y.routed_section==="lift"?"Lift":y.routed_section==="other"?"History":"Run"," tab."]}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>{localStorage.setItem("forge_last_watch_sync_seen_at",y.synced_at),y.routed_section==="lift"?s("/log-lift"):y.normalized_type==="treadmill"?s("/run/treadmill",{state:{incline:y.incline_pct,speed:y.belt_speed_mph,durationSeconds:y.duration_seconds,treadmillType:y.treadmill_brand||"Generic",watchMetrics:y}}):s("/log-run")},className:"rounded-lg px-3 py-1.5 text-xs font-bold",style:{background:"var(--accent)",color:"#000"},children:"View"}),e.jsx("button",{onClick:()=>{localStorage.setItem("forge_last_watch_sync_seen_at",y.synced_at),K(null)},className:"rounded-lg px-3 py-1.5 text-xs",style:{background:"var(--bg-input)",color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:"Dismiss"})]})]}),e.jsxs("div",{className:"rounded-2xl p-6 flex flex-col items-center",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h2",{className:"text-2xl font-black mb-1",style:{color:"var(--text-primary)"},children:"Ready to Run?"}),e.jsx("p",{className:"text-sm mb-10 text-center",style:{color:"var(--text-muted)"},children:"Dynamic warm-up reduces injury risk and improves performance."}),e.jsxs("button",{onClick:()=>s("/log-run?warmup=true"),className:"rounded-full w-28 h-28 mb-3 font-black flex flex-col items-center justify-center",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:[e.jsx(it,{className:"mb-1"}),e.jsx("span",{className:"text-xs font-black",children:"Start Warm-Up"})]}),e.jsx("button",{onClick:()=>s("/log-run"),style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",fontSize:14,padding:"8px 0"},children:"Skip warm-up"})]}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:z===null?e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Complete your daily check-in and sync your watch to unlock your Training Readiness score"}):e.jsxs(e.Fragment,{children:[e.jsx(ht,{score:z,onClick:()=>U(!0)}),e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:["Based on your HRV, sleep, soreness, and energy levels",D!=null&&D.sleep_hours?` · Sleep: ${D.sleep_hours}h`:""]})]})}),(r==null?void 0:r.calendarDays)&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsx("p",{className:"text-xs font-medium mb-3",style:{color:"var(--text-muted)"},children:o("dashboard.thisWeek")}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:r.calendarDays.map(t=>e.jsxs("div",{className:"flex flex-col items-center gap-1",onClick:()=>F(t),style:{cursor:"pointer"},children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.6},children:t.day}),e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{background:t.hasRun||t.hasLift?"var(--accent)":"var(--bg-input)",borderColor:t.isToday?"var(--accent)":"transparent",borderWidth:t.isToday?2:1},children:t.hasRun&&t.hasLift?e.jsx("span",{className:"text-xs font-bold text-black",children:"R+L"}):t.hasRun?e.jsx("span",{className:"text-xs font-bold text-black",children:"R"}):t.hasLift?e.jsx("span",{className:"text-xs font-bold text-black",children:"L"}):e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.4},children:"·"})})]},t.date))})]}),e.jsxs("div",{className:"rounded-2xl p-4 space-y-3",style:{background:"var(--bg-card)"},children:[e.jsx("div",{className:"flex gap-2",children:[{key:"day",label:"D"},{key:"week",label:"W"},{key:"month",label:"M"},{key:"all",label:"All"}].map(({key:t,label:n})=>e.jsx("button",{onClick:()=>he(t),className:"px-4 py-1.5 rounded-full text-xs font-semibold transition-all",style:M===t?{background:"var(--accent)",color:"#000"}:{background:"var(--bg-input)",color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:n},t))}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:Pe[M]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-5xl font-black tabular-nums",style:{color:"var(--text-primary)"},children:l.distanceValue(He/10).toFixed(1)}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[l.distanceLabel.charAt(0).toUpperCase()+l.distanceLabel.slice(1),"s"]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{label:"Runs",value:Ge},{label:"Time",value:mt(B.seconds)},{label:"Cal",value:M==="week"?ze.toLocaleString():(B.calories||0).toLocaleString()}].map((t,n)=>{const u=n%2===0;return e.jsxs("div",{className:"rounded-lg p-2",style:{border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:t.value}),e.jsxs("p",{className:"text-xs flex items-center gap-1",style:{color:"var(--text-muted)"},children:[t.label,u?e.jsx(ct,{size:12,color:"#22c55e"}):e.jsx(dt,{size:12,color:"#ef4444"})]})]},t.label)})})]}),(r==null?void 0:r.weeklyTrend)&&r.weeklyTrend.some(t=>t.miles>0)&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"Past 12 Weeks"}),e.jsxs("p",{className:"text-xs font-semibold",style:{color:"var(--accent)"},children:[l.distance((le=r.weeklyTrend[r.weeklyTrend.length-1])==null?void 0:le.miles,1)," last week"]})]}),e.jsx(pt,{data:r.weeklyTrend}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.5},children:new Date((ne=r.weeklyTrend[0])==null?void 0:ne.week).toLocaleDateString("en-US",{month:"short"})}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.5},children:"Now"})]})]}),$&&e.jsx("div",{className:"rounded-xl border p-3 text-sm",style:{borderColor:"rgba(234,179,8,0.3)",background:"rgba(234,179,8,0.08)",color:"var(--accent)"},children:"Heavy legs detected — consider a rest day or easy run today"}),Te.map(t=>e.jsxs("div",{style:{background:"rgba(239,68,68,0.08)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:12,padding:"10px 14px"},children:[e.jsxs("p",{style:{fontSize:13,fontWeight:700,color:"#ef4444",margin:0,display:"flex",alignItems:"center",gap:6},children:[e.jsx(ut,{size:14})," Your ",t.nickname||`${t.brand} ${t.model}`," has ",Number(t.total_miles||0).toFixed(0)," miles — time to replace soon"]}),e.jsxs("p",{style:{fontSize:11,color:"var(--text-muted)",margin:"2px 0 0"},children:[t.total_miles," of 500 miles"]})]},t.id)),e.jsxs("section",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsx("h3",{className:"text-base font-bold mb-3",style:{color:"var(--text-primary)",borderBottom:"1px solid rgba(234,179,8,0.45)",paddingBottom:6},children:"Recent Activity"}),e.jsxs("div",{className:"space-y-3",children:[ae.map(t=>t._type==="run"?e.jsxs("div",{onClick:()=>s(`/history?runId=${t.id}`),className:"rounded-xl p-3 border",style:{background:"var(--bg-input)",borderColor:"var(--border-subtle)",borderLeft:"4px solid #EAB308",cursor:"pointer"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium",style:{background:"var(--accent-dim)",color:"var(--accent)"},children:"Run"}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:new Date(t.date||t.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"flex gap-4 mt-1",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:l.distance(Number(t.distance_miles||0),2)})}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:l.pace(t.duration_seconds/t.distance_miles)})}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:ue(t.duration_seconds)})}),t.calories>0&&e.jsx("div",{children:e.jsxs("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:[t.calories," cal"]})})]})]},t.id):t._type==="other"?e.jsxs("div",{className:"rounded-xl p-3 border",style:{background:"var(--bg-input)",borderColor:"var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium",style:{background:"rgba(234,179,8,0.2)",color:"var(--accent)"},children:"Other Activity"}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:new Date(t.synced_at||t.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsx("p",{className:"text-sm font-bold mt-1",style:{color:"var(--text-primary)"},children:t.activity_name||t.activity_type||"Synced activity"})]},t.id):e.jsxs("div",{onClick:()=>s(`/history?workoutId=${t.id}`),className:"rounded-xl p-3 border",style:{background:"var(--bg-input)",borderColor:"var(--border-subtle)",borderLeft:"4px solid #ffffff",cursor:"pointer"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium",style:{background:"rgba(139,92,246,0.15)",color:"#a78bfa"},children:"Lift"}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:new Date(t.date||t.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsx("p",{className:"text-sm font-bold mt-1",style:{color:"var(--text-primary)"},children:t.exercise_name||(Array.isArray(t.muscle_groups)?t.muscle_groups.join(", "):"Workout")}),t.sets&&e.jsxs("p",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:[t.sets," sets · ",t.reps," reps · ",t.weight_lbs," lbs"]})]},t.id)),ae.length===0&&e.jsx("p",{className:"text-sm py-4 text-center",style:{color:"var(--text-muted)"},children:o("dashboard.noActivity")})]})]}),i&&e.jsx("div",{onClick:()=>F(null),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",zIndex:50,display:"flex",alignItems:"flex-end"},children:e.jsxs("div",{onClick:t=>t.stopPropagation(),style:{background:"var(--bg-card)",borderRadius:"20px 20px 0 0",padding:24,width:"100%",maxHeight:"60vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:new Date(i.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),e.jsx("p",{style:{fontSize:20,fontWeight:900,color:"var(--text-primary)"},children:i.hasRun||i.hasLift?"Active Day":"Rest Day"})]}),e.jsx("button",{onClick:()=>F(null),style:{background:"var(--bg-input)",border:"none",borderRadius:10,padding:"8px 14px",color:"var(--text-muted)",cursor:"pointer",fontSize:13},children:"Close"})]}),i.run&&e.jsxs("div",{style:{background:"var(--bg-base)",borderRadius:14,padding:16,marginBottom:12},children:[e.jsx("p",{style:{fontSize:11,fontWeight:700,color:"var(--accent)",letterSpacing:1,textTransform:"uppercase",marginBottom:10},children:"Run"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:22,fontWeight:900,color:"var(--text-primary)"},children:Number(i.run.distance||0).toFixed(2)}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"miles"})]}),i.run.duration>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:22,fontWeight:900,color:"var(--text-primary)"},children:ue(i.run.duration)}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"duration"})]}),i.run.distance>0&&i.run.duration>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:22,fontWeight:900,color:"var(--text-primary)"},children:(()=>{const t=i.run.duration/i.run.distance;return`${Math.floor(t/60)}:${String(Math.round(t%60)).padStart(2,"0")}`})()}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"avg pace /mi"})]}),i.run.surface&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)",textTransform:"capitalize"},children:i.run.surface}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"surface"})]})]}),i.run.notes&&e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",marginTop:12,lineHeight:1.5,borderTop:"1px solid var(--border-subtle)",paddingTop:10},children:i.run.notes})]}),i.lifts&&e.jsxs("div",{style:{background:"var(--bg-base)",borderRadius:14,padding:16,marginBottom:12},children:[e.jsx("p",{style:{fontSize:11,fontWeight:700,color:"var(--accent)",letterSpacing:1,textTransform:"uppercase",marginBottom:8},children:"Strength"}),e.jsxs("p",{style:{fontSize:20,fontWeight:900,color:"var(--text-primary)"},children:[i.lifts," workout session",i.lifts>1?"s":""]})]}),!i.hasRun&&!i.hasLift&&e.jsxs("div",{style:{background:"var(--bg-base)",borderRadius:14,padding:20,textAlign:"center"},children:[e.jsx("p",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)",marginBottom:6},children:"Rest day"}),e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",lineHeight:1.6},children:i.isToday?"No activity logged yet today.":"Recovery is part of training. Rest days make you stronger."})]})]})}),ve&&e.jsx("div",{onClick:()=>U(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",zIndex:50,display:"flex",alignItems:"flex-end"},children:e.jsxs("div",{onClick:t=>t.stopPropagation(),style:{background:"var(--bg-card)",borderRadius:"20px 20px 0 0",padding:24,width:"100%",maxHeight:"70vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"Training Readiness"}),e.jsxs("p",{style:{fontSize:28,fontWeight:900,color:"var(--accent)"},children:[z," ",e.jsx("span",{style:{fontSize:14,fontWeight:400,color:"var(--text-muted)"},children:"/ 100"})]}),e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",marginTop:2},children:z>=80?"Go hard today.":z>=60?"Moderate effort — push but listen to your body.":z>=40?"Take it easy — a recovery run or rest day is smart.":"Rest today. Your body is telling you something."})]}),e.jsx("button",{onClick:()=>U(!1),style:{background:"var(--bg-input)",border:"none",borderRadius:10,padding:"8px 14px",color:"var(--text-muted)",cursor:"pointer",fontSize:13},children:"Close"})]}),e.jsx("p",{style:{fontSize:11,fontWeight:700,color:"var(--text-muted)",letterSpacing:1,textTransform:"uppercase",marginBottom:12},children:"Score Breakdown"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:Ee.map((t,n)=>e.jsxs("div",{style:{background:"var(--bg-base)",borderRadius:12,padding:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsx("p",{style:{fontSize:13,fontWeight:700,color:"var(--text-primary)"},children:t.label}),e.jsx("p",{style:{fontSize:13,fontWeight:700,color:t.delta>0?"#22c55e":t.delta<0?"#ef4444":"var(--text-muted)"},children:t.delta>0?`+${t.delta}`:t.delta<0?`${t.delta}`:`${t.value}`})]}),e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",lineHeight:1.5},children:t.reason})]},n))}),e.jsxs("div",{style:{marginTop:20,padding:14,background:"var(--bg-base)",borderRadius:12,borderLeft:"3px solid var(--accent)"},children:[e.jsx("p",{style:{fontSize:12,fontWeight:700,color:"var(--accent)",marginBottom:6},children:"How to improve your score"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",lineHeight:1.6},children:"Log runs consistently to build your streak. Keep weekly mileage within 10–20% of your average. Connect your Garmin for HRV and sleep data — that unlocks a much more accurate score."})]})]})})]})}export{$t as default};
