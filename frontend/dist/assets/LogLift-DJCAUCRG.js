import{b as ee,r as l,a as h,j as e}from"./index-vmUng2Mm.js";import{q as v}from"./offlineQueue-B-c8T9Pb.js";const te=[{key:"chest",label:"Chest"},{key:"back",label:"Back"},{key:"legs",label:"Legs"},{key:"shoulders",label:"Shoulders"},{key:"arms",label:"Arms"},{key:"core",label:"Core"}],j="#374151",d="#EAB308";function U({highlight:c,sex:b="male"}){const y=x=>c==="full"||c===x?d:j,i=b==="female";return e.jsxs("svg",{viewBox:"0 0 60 90",width:"52",height:"78",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"30",cy:"9",r:"8",fill:j}),e.jsx("rect",{x:"27",y:"17",width:"6",height:"5",fill:j}),e.jsx("rect",{x:i?9:7,y:"20",width:"9",height:"24",rx:"4",fill:y("arms")}),e.jsx("rect",{x:i?42:44,y:"20",width:"9",height:"24",rx:"4",fill:y("arms")}),e.jsx("rect",{x:"16",y:"20",width:"28",height:"33",rx:"4",fill:j}),i&&e.jsx("rect",{x:"18",y:"34",width:"24",height:"8",rx:"2",fill:j}),(c==="shoulders"||c==="full")&&e.jsxs(e.Fragment,{children:[e.jsx("rect",{x:i?9:7,y:"20",width:"9",height:"11",rx:"4",fill:d}),e.jsx("rect",{x:i?42:44,y:"20",width:"9",height:"11",rx:"4",fill:d}),e.jsx("rect",{x:"15",y:"20",width:"30",height:"8",rx:"3",fill:d})]}),(c==="chest"||c==="full")&&e.jsx("rect",{x:"18",y:"23",width:"24",height:"14",rx:"3",fill:d}),(c==="back"||c==="full")&&e.jsx("rect",{x:"16",y:"22",width:"28",height:"13",rx:"3",fill:d}),(c==="core"||c==="full")&&e.jsx("rect",{x:"18",y:"37",width:"24",height:"14",rx:"3",fill:d}),e.jsx("rect",{x:i?15:17,y:"53",width:i?13:11,height:"33",rx:"4",fill:y("legs")}),e.jsx("rect",{x:32,y:"53",width:i?13:11,height:"33",rx:"4",fill:y("legs")})]})}function re(){const c=ee(),[b,y]=l.useState([]),[i,x]=l.useState(!1),[C,m]=l.useState(""),[r,A]=l.useState(null),[F,q]=l.useState("male"),[_,D]=l.useState(""),[k,H]=l.useState(null),[w,Y]=l.useState("ai"),[o,G]=l.useState(null),[L,T]=l.useState(!1),[N,$]=l.useState(null),[V,E]=l.useState(""),[u,J]=l.useState(null),[B,I]=l.useState(!1),[O,P]=l.useState(""),[M,p]=l.useState("");l.useEffect(()=>{h.get("/auth/me").then(t=>{var s;q(((s=t.data.user)==null?void 0:s.sex)||"male")}).catch(()=>{})},[]);const g=b[0]||"";l.useEffect(()=>{T(!0),$(null),h.get("/ai/workout-recommendation?date=today").then(t=>{var s;G(((s=t.data)==null?void 0:s.recommendation)||null)}).catch(t=>{console.error("Failed to fetch AI recommendation:",t),$("Could not generate recommendation"),G(null)}).finally(()=>T(!1))},[]);const W=t=>y(s=>{const a=s.includes(t)?s.filter(f=>f!==t):[...s,t],n=a[0]||"";return r&&r.muscle_group!==n&&(A(null),E("")),a}),K=async()=>{var t,s;x(!0),m(""),p("");try{const n=((o==null?void 0:o.target)||"").split(/[,\/\s]+/).map(Z=>Z.trim().toLowerCase()).filter(Boolean),f={muscle_groups:n.length?n:["full"]};if(!navigator.onLine){await v("/api/workouts/start","POST",f),p("Saved offline — will sync when connected"),x(!1);return}const S=await h.post("/workouts/start",f);c(`/workout/active/${S.data.session.id}`,{state:{exercises:(o==null?void 0:o.main)||[],workoutName:(o==null?void 0:o.workoutName)||""}})}catch(a){if(!(a!=null&&a.response)){const f=((o==null?void 0:o.target)||"").split(/[,\/\s]+/).map(S=>S.trim().toLowerCase()).filter(Boolean);await v("/api/workouts/start","POST",{muscle_groups:f.length?f:["full"]}),p("Saved offline — will sync when connected"),m("");return}m(((s=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:s.error)||"Could not start workout. Try again.")}finally{x(!1)}},Q=async()=>{var t,s;x(!0),m(""),p("");try{const a={muscle_groups:b,exercise_name:(r==null?void 0:r.name)||""};if(!navigator.onLine){await v("/api/workouts/start","POST",a),p("Saved offline — will sync when connected");return}const n=await h.post("/workouts/start",a);c(`/workout/active/${n.data.session.id}`)}catch(a){if(!(a!=null&&a.response)){await v("/api/workouts/start","POST",{muscle_groups:b,exercise_name:(r==null?void 0:r.name)||""}),p("Saved offline — will sync when connected"),m("");return}m(((s=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:s.error)||"Could not start workout. Try again.")}finally{x(!1)}},R=async()=>{var t,s,a;if(!(!g||!(r!=null&&r.name))){I(!0),P("");try{const n=await h.post("/ai/workout",{bodyPart:g,exercise:r.name});J(((t=n.data)==null?void 0:t.recommendation)||null)}catch(n){P(((a=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:a.error)||"Could not generate AI workout")}finally{I(!1)}}},X=async()=>{var t,s;if(u){x(!0),m(""),p("");try{const n={muscle_groups:[g||"full"],exercise_name:(r==null?void 0:r.name)||""};if(!navigator.onLine){await v("/api/workouts/start","POST",n),p("Saved offline — will sync when connected");return}const f=await h.post("/workouts/start",n);c(`/workout/active/${f.data.session.id}`,{state:{exercises:(u==null?void 0:u.main)||[],workoutName:(u==null?void 0:u.workoutName)||""}})}catch(a){if(!(a!=null&&a.response)){await v("/api/workouts/start","POST",{muscle_groups:[g||"full"],exercise_name:(r==null?void 0:r.name)||""}),p("Saved offline — will sync when connected"),m("");return}m(((s=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:s.error)||"Could not start workout. Try again.")}finally{x(!1)}}},z=(t="")=>String(t).replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase());return e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-1",style:{color:"var(--text-primary)"},children:"Start Workout"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Select the muscle groups you are targeting today"})]}),e.jsx("div",{className:"flex gap-2",children:["manual","ai"].map(t=>e.jsx("button",{onClick:()=>Y(t),className:"rounded-full px-4 py-2 text-xs font-bold",style:{background:w===t?"var(--accent)":"var(--bg-input)",color:w===t?"#000":"var(--text-muted)"},children:t==="manual"?"Manual":"AI Recommends"},t))}),w==="ai"&&e.jsxs(e.Fragment,{children:[L&&e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)",color:"var(--text-muted)"},children:e.jsx("p",{className:"text-sm",children:"Generating your personalized workout..."})}),N&&e.jsx("div",{className:"rounded-2xl p-4",style:{background:"rgba(239,68,68,0.1)",color:"#ef4444",border:"1px solid rgba(239,68,68,0.3)"},children:e.jsx("p",{className:"text-sm",children:N})}),!L&&!o&&!N&&e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)",color:"var(--text-muted)"},children:e.jsx("p",{className:"text-sm",children:"No recommendation available yet. Check back later."})}),o&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"#F5F0E8",color:"#1a1a2e",border:"1px solid #d6c9a0",position:"relative",fontFamily:"Caveat, cursive",backgroundImage:"repeating-linear-gradient(to bottom, transparent 0 27px, rgba(26,26,46,0.12) 27px 28px)"},children:[e.jsx("div",{style:{position:"absolute",top:8,right:10,fontSize:11,fontWeight:700,border:"1px solid #1a1a2e66",borderRadius:999,padding:"2px 8px"},children:"FORGE"}),e.jsx("div",{style:{position:"absolute",left:0,right:0,bottom:-1,height:14,background:"linear-gradient(135deg, #eadfcd 25%, transparent 25%) 0 0/12px 12px, linear-gradient(225deg, #eadfcd 25%, transparent 25%) 6px 0/12px 12px"}}),e.jsxs("p",{className:"text-lg font-bold",children:[o.workoutName," — ",z(o.target)]}),e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("strong",{children:"Warmup:"})," ",(o.warmup||[]).join(", ")]}),e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("strong",{children:"Main:"})," ",(o.main||[]).map(t=>`${t.name} ${t.sets}x${t.reps} (${t.rest})`).join(" • ")]}),e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("strong",{children:"Recovery:"})," ",(o.recovery||[]).join(", ")]}),e.jsx("p",{className:"text-sm mt-2",children:o.explanation}),e.jsx("p",{className:"text-xs mt-1",children:o.restExplanation}),e.jsx("button",{onClick:K,disabled:i,className:"mt-3 w-full rounded-2xl py-4 text-base font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer",opacity:i?.6:1,fontFamily:"inherit"},children:i?"Starting...":"Start Workout"})]})]}),w==="manual"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[te.map(({key:t,label:s})=>{const a=b.includes(t);return e.jsxs("button",{onClick:()=>W(t),className:"flex flex-col items-center justify-between rounded-2xl py-3 px-2 transition-all",style:{background:a?"rgba(234,179,8,0.08)":"var(--bg-card)",border:`2px solid ${a?d:"var(--border-subtle)"}`,minHeight:110,boxShadow:a?"0 0 10px rgba(234,179,8,0.25)":"none"},children:[e.jsx(U,{highlight:t,sex:F}),e.jsx("span",{className:"text-xs font-semibold mt-1 capitalize",style:{color:a?d:"var(--text-muted)"},children:s})]},t)}),(()=>{const t=b.includes("full");return e.jsxs("button",{onClick:()=>W("full"),className:"col-span-3 flex items-center justify-center gap-4 rounded-2xl py-3 px-4 transition-all",style:{background:t?"rgba(234,179,8,0.08)":"var(--bg-card)",border:`2px solid ${t?d:"var(--border-subtle)"}`,minHeight:72,boxShadow:t?"0 0 10px rgba(234,179,8,0.25)":"none"},children:[e.jsx(U,{highlight:"full",sex:F}),e.jsx("span",{className:"text-sm font-bold",style:{color:t?d:"var(--text-muted)"},children:"Full Body"})]})})()]}),g&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"How much time do you have?"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["15","30","45","60","90+"].map(t=>e.jsxs("button",{type:"button",onClick:async()=>{var a;D(t);const s=await h.post("/ai/lift-plan",{bodyPart:g,timeAvailable:t,userId:"me"}).catch(()=>null);H(((a=s==null?void 0:s.data)==null?void 0:a.plan)||null)},className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:_===t?"var(--accent)":"var(--bg-input)",color:_===t?"#000":"var(--text-muted)"},children:[t," min"]},t))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Exercise"}),e.jsx("input",{value:V,onChange:t=>{E(t.target.value),A(t.target.value?{name:t.target.value,muscle_group:g}:null)},placeholder:"e.g. Incline Dumbbell Press",className:"w-full mt-1 rounded-xl px-3 py-2",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"}})]}),r&&e.jsxs("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:["Exercise: ",r.name]}),k&&e.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[k.workoutName," · Estimated: ",k.estimatedTime]}),g&&(r==null?void 0:r.name)&&e.jsx("button",{type:"button",onClick:R,disabled:B,className:"rounded-xl px-4 py-2 text-sm font-bold",style:{background:"#EAB308",color:"#000",border:"none"},children:B?"Generating...":`Generate AI Workout for ${z(g)}`}),O&&e.jsx("p",{className:"text-xs",style:{color:"#ef4444"},children:O}),u&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"#F5F0E8",color:"#1a1a2e",border:"1px solid #d6c9a0",position:"relative",fontFamily:"Caveat, cursive",backgroundImage:"repeating-linear-gradient(to bottom, transparent 0 27px, rgba(26,26,46,0.12) 27px 28px)"},children:[e.jsx("div",{style:{position:"absolute",top:8,right:10,fontSize:11,fontWeight:700,border:"1px solid #1a1a2e66",borderRadius:999,padding:"2px 8px"},children:"FORGE"}),e.jsx("p",{className:"text-lg font-bold",children:u.workoutName}),e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("strong",{children:"Main:"})," ",(u.main||[]).map(t=>`${t.name} ${t.sets}x${t.reps} (${t.rest})`).join(" • ")]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{type:"button",onClick:X,className:"flex-1 rounded-xl py-2 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",fontFamily:"inherit"},children:"Accept Workout"}),e.jsx("button",{type:"button",onClick:R,className:"flex-1 rounded-xl py-2 font-bold",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)",fontFamily:"inherit"},children:"Regenerate"})]})]})]}),C&&e.jsx("p",{className:"text-sm",style:{color:"var(--accent)"},children:C}),M&&e.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:M}),e.jsx("button",{onClick:Q,disabled:i||b.length===0,className:"w-full rounded-2xl py-4 text-lg font-bold disabled:opacity-60 transition-all",style:{background:"var(--accent)",color:"black"},children:i?"Starting...":"Begin Workout"})]})]})}export{re as default};
