import{d as we,b as nt,e as lt,c as ct,r as a,a as m,j as e,L as it}from"./index-Bez5XITZ.js";import{p as ge,f as dt}from"./parseDuration-3bmQJghK.js";import{P as ut}from"./PostRunCheckIn-BEvfccyA.js";import{P as xt}from"./PhotoUploader-Dj1q3X7J.js";import{q as je}from"./offlineQueue-B-c8T9Pb.js";import{v as mt,s as pt}from"./validation-CCcprX5w.js";import{R as bt}from"./refresh-cw-DO0Gv_77.js";import{M as ht}from"./mountain-BTqurYAS.js";import{P as vt}from"./pencil-C6vFCChx.js";import"./check-C5snY8yZ.js";import"./camera-C730ymdY.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],ft=we("Gauge",yt);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],ke=we("MapPin",gt);function jt(){return new Date().toISOString().slice(0,10)}const kt=["Leg swings — 10 each side","High knees — 30 seconds","Ankle circles — 10 each side","Hip circles — 10 each direction","Arm swings — 20 reps"],Nt=[{value:"road",label:"Road",icon:ke},{value:"track",label:"Track",icon:bt},{value:"trail",label:"Trail",icon:ht},{value:"treadmill",label:"Treadmill",icon:ft},{value:"other",label:"Other",icon:ke}],Ne="forge_run_detail_panels",Se={overview:!0,stats:!0,pace:!0,hr:!0,notes:!0};function St(s){return s<=3?"var(--text-muted)":s<=6?"var(--text-primary)":"var(--accent)"}function wt(s){return s<=3?"Easy":s<=6?"Moderate":s<=8?"Hard":"Max Effort"}function Ct(s){const d=Math.floor(s/3600),i=Math.floor(s%3600/60),x=s%60;return d>0?`${d}:${String(i).padStart(2,"0")}:${String(x).padStart(2,"0")}`:`${i}:${String(x).padStart(2,"0")}`}function _t(s,d){if(!s||!d)return"—";const i=Math.round(s/d),x=Math.floor(i/60),B=i%60;return`${x}:${String(B).padStart(2,"0")}/mi`}function Rt(s){const d=(s==null?void 0:s.splits)||(s==null?void 0:s.splits_json)||(s==null?void 0:s.gps_splits);if(!d)return[];if(Array.isArray(d))return d;if(typeof d=="string")try{const i=JSON.parse(d);return Array.isArray(i)?i:[]}catch{return[]}return[]}function Pt({effort:s,setEffort:d}){return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:4},children:Array.from({length:10},(i,x)=>x+1).map(i=>{const x=i<=s;return e.jsx("button",{type:"button",onClick:()=>d(i),style:{flex:1,height:40,borderRadius:6,border:"1px solid var(--border-subtle)",cursor:"pointer",background:x?"var(--accent)":"var(--bg-base)"}},i)})}),e.jsxs("div",{style:{marginTop:10,textAlign:"center"},children:[e.jsx("span",{style:{fontSize:36,fontWeight:900,color:St(s),lineHeight:1},children:s}),e.jsx("div",{style:{fontSize:13,color:"var(--text-muted)",marginTop:3,fontWeight:600},children:wt(s)})]})]})}function Tt({workout:s,onClose:d}){if(!s)return null;const i=async()=>{const x=`${s.day}: ${s.typeLabel}
Distance: ${s.distanceLabel}
${s.pace?`Pace: ${s.pace}
`:""}${s.description?`Notes: ${s.description}`:""}`;try{await navigator.clipboard.writeText(x)}catch{}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)"},children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl p-5",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h3",{className:"text-xl font-black mb-4",style:{color:"var(--text-primary)"},children:"Today's Workout"}),e.jsxs("div",{className:"rounded-xl p-4 mb-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"text-xs font-semibold uppercase mb-2",style:{color:"var(--text-muted)"},children:s.day}),e.jsx("span",{className:"inline-block rounded-full px-3 py-1 text-xs font-bold mb-3",style:{background:"var(--accent)",color:"#000"},children:s.typeLabel}),e.jsxs("div",{className:"text-sm mb-1",style:{color:"var(--text-primary)"},children:[e.jsx("strong",{children:"Distance:"})," ",s.distanceLabel]}),s.pace&&e.jsxs("div",{className:"text-sm mb-1",style:{color:"var(--text-primary)"},children:[e.jsx("strong",{children:"Pace:"})," ",s.pace]}),s.description&&e.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s.description})]}),e.jsx("button",{onClick:i,className:"w-full rounded-xl py-3 font-bold mb-3",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Copy Workout"}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"Automatic watch sync is coming in the FORGE mobile app"}),e.jsx("button",{onClick:d,className:"w-full rounded-xl py-2",style:{background:"var(--bg-base)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},children:"Close"})]})})}function qt(){var ve,ye;const s=nt();lt();const{units:d,fmt:i}=ct(),[x,B]=a.useState(()=>new URLSearchParams(window.location.search).get("warmup")==="true"?"warmup":"done"),[b,U]=a.useState("today"),[Ce,Lt]=a.useState(3),[H,_e]=a.useState("road"),[E,Re]=a.useState("easy"),[j,Pe]=a.useState("outside"),[M,Te]=a.useState("Generic"),[N,Z]=a.useState(null),[D,Le]=a.useState("no"),[G,ze]=a.useState(jt()),[k,Ee]=a.useState(""),[q,ee]=a.useState("30:00"),[Y,Me]=a.useState(""),[J,De]=a.useState(5),[te,re]=a.useState(!1),[We,se]=a.useState(!1),[ae,S]=a.useState(""),[oe,K]=a.useState(""),[W,Ie]=a.useState({}),[ne,Ae]=a.useState({}),[$e,I]=a.useState(!1),[Oe,le]=a.useState(!1),[A,Fe]=a.useState(null),[Q,V]=a.useState([]),[zt,Et]=a.useState(!1),[c,Be]=a.useState(null),[Ue,ce]=a.useState(!1),[w,He]=a.useState(null),[ie,de]=a.useState(!1),[Ge,qe]=a.useState(null),[Ye,ue]=a.useState(!1),[n,$]=a.useState(null),[Je,xe]=a.useState(!1),[f,Ke]=a.useState(()=>{try{return{...Se,...JSON.parse(localStorage.getItem(Ne)||"{}")}}catch{return Se}}),[C,Qe]=a.useState(""),[O,Ve]=a.useState([]),[_,Xe]=a.useState(""),[Ze,et]=a.useState(!0),[tt,me]=a.useState(!1),pe=a.useRef(null),be=a.useRef(null);a.useEffect(()=>{x==="done"&&U("today")},[x]),a.useEffect(()=>{let t=!0;return(async()=>{try{const{data:o}=await m.get("/checkin/today"),l=!!((o==null?void 0:o.completed)??(o==null?void 0:o.id)??o);t&&me(l)}catch{t&&me(!1)}finally{t&&et(!1)}})(),()=>{t=!1}},[]),a.useEffect(()=>{b!=="today"||c||(ce(!0),m.get("/plans/today").then(t=>{var o;const r=((o=t.data)==null?void 0:o.today)||null;r&&Be({day:r.day||r.day_of_week||new Date().toLocaleDateString(void 0,{weekday:"short"}),typeLabel:String(r.type||"run").replace("-"," ").replace(/\b\w/g,l=>l.toUpperCase()),distanceLabel:Number(r.distance_miles)>0?`${Number(r.distance_miles).toFixed(1)} miles`:"No distance target",pace:r.pace_target||r.pace||r.target_pace||"",description:r.description||r.notes||""})}).catch(()=>{}).finally(()=>ce(!1)))},[b,c]),a.useEffect(()=>{localStorage.setItem(Ne,JSON.stringify(f))},[f]),a.useEffect(()=>{m.get("/gear/shoes").then(t=>{var r;return Ve(((r=t.data)==null?void 0:r.shoes)||[])}).catch(()=>{})},[]),a.useEffect(()=>{b!=="week"||w||(de(!0),m.get("/plans/my").then(t=>{var l,v,p,u,g,P,T;const r=((v=(l=t.data)==null?void 0:l.plan)==null?void 0:v.plan_data)||((u=(p=t.data)==null?void 0:p.plan)==null?void 0:u.plan_json),o=Math.max(1,Number(((P=(g=t.data)==null?void 0:g.user_plan)==null?void 0:P.current_week)||1));if((T=r==null?void 0:r.weeks)!=null&&T.length){const y=r.weeks[o-1]||r.weeks[0];He((y==null?void 0:y.days)||(y==null?void 0:y.sessions)||[])}}).catch(()=>{}).finally(()=>de(!1)))},[b,w]),a.useEffect(()=>{const t=(n==null?void 0:n.id)||(c==null?void 0:c.id);t&&m.get(`/ai/run-brief?sessionId=${t}`).then(r=>Z(r.data||null)).catch(()=>Z(null))},[n==null?void 0:n.id,c==null?void 0:c.id]);const R=a.useMemo(()=>{var p;const t=Number(k||((p=c==null?void 0:c.distanceLabel)==null?void 0:p.split(" ")[0])||0);if(!t||Q.length===0)return null;const r=Q.filter(u=>u.distance_miles>0&&u.duration_seconds>0).map(u=>u.duration_seconds/60/u.distance_miles);if(!r.length)return null;const o=r.reduce((u,g)=>u+g,0)/r.length,l=Math.round(o*.95*t),v=Math.round(o*1.05*t);return{low:l,high:v,avg:o}},[k,c,Q]),rt=async t=>{var p,u,g,P,T,y;t.preventDefault(),K(""),S("");const r=ge(q),o=d==="metric"?i.milesFromKm(Number(k)):Number(k),{errors:l,warnings:v}=mt({distance:k,durationSeconds:r,distanceMiles:o});if(Ie(l),Ae(v),Object.keys(l).length){pt({distance:pe,duration:be},["distance","duration"]);return}try{re(!0);const h=j==="inside"?"treadmill":H;if(h==="treadmill"){s("/run/treadmill",{state:{treadmillType:M}});return}const L={date:G,type:E,surface:h,run_surface:h,distance_miles:o,duration_seconds:r,notes:Y,perceived_effort:Number(J),treadmill_brand:M,shoe_id:_||null};if(!navigator.onLine){await je("/api/runs","POST",L),S("Saved offline — will sync when connected");return}const F=await m.post("/runs",L),z=((p=F.data)==null?void 0:p.id)||((g=(u=F.data)==null?void 0:u.run)==null?void 0:g.id);if(z&&m.post("/prs/auto-detect",{run_id:z}).catch(()=>{}),m.post("/badges/check",{}).catch(()=>{}),!z){S("Feedback coming soon..."),I(!0);return}Fe(z),le(!0),se(!0);let fe=0,X="";for(;fe<5&&!X;)fe+=1,await new Promise(ot=>setTimeout(ot,2e3)),X=((P=(await m.get(`/coach/feedback/${z}`)).data)==null?void 0:P.ai_feedback)||"";S(X||"Your coach is thinking... check back after your next run."),I(!0)}catch(h){if(!(h!=null&&h.response)){const L=j==="inside"?"treadmill":H,F={date:G,type:E,surface:L,run_surface:L,distance_miles:o,duration_seconds:r,notes:Y,perceived_effort:Number(J),treadmill_brand:M,shoe_id:_||null};await je("/api/runs","POST",F),S("Saved offline — will sync when connected"),K("");return}K(((y=(T=h==null?void 0:h.response)==null?void 0:T.data)==null?void 0:y.error)||"Could not save run. Check your connection and try again.")}finally{re(!1),se(!1)}},he=a.useMemo(()=>Rt(n),[n]),st=async()=>{if(n)try{const r=(await m.patch(`/runs/${n.id}`,{notes:C})).data||{...n,notes:C};$(r),V(o=>o.map(l=>l.id===r.id?{...l,notes:r.notes}:l))}catch{try{const r=(await m.put(`/runs/${n.id}`,{notes:C})).data||{...n,notes:C};$(r),V(o=>o.map(l=>l.id===r.id?{...l,notes:r.notes}:l))}catch{}}},at=async()=>{n&&window.confirm("Are you sure? This can't be undone.")&&(await m.delete(`/runs/${n.id}`),V(t=>t.filter(r=>r.id!==n.id)),$(null))};return Ze?e.jsx("div",{className:"p-4",style:{color:"var(--text-muted)"},children:"Checking today's check-in..."}):tt?x==="warmup"?e.jsxs("div",{className:"rounded-2xl p-6",style:{background:"var(--bg-card)"},children:[e.jsx("h2",{className:"text-xl font-black mb-1",style:{color:"var(--text-primary)"},children:"Dynamic Warm-Up"}),e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:"Complete each movement before you run."}),e.jsx("div",{className:"space-y-3 mb-6",children:kt.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl p-3",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{style:{width:30,height:30,borderRadius:"50%",background:"var(--accent)",color:"#000",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:900,fontSize:13,flexShrink:0},children:r+1}),e.jsx("span",{style:{color:"var(--text-primary)",fontSize:14,fontWeight:500},children:t})]},r))}),e.jsx("button",{onClick:()=>B("done"),className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer",fontSize:16},children:"Done — Start Run"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsx("div",{className:"flex gap-2 mb-5 flex-wrap",children:[{key:"today",label:"Today"},{key:"week",label:"Week"},{key:"log",label:"Manual"}].map(t=>e.jsx("button",{onClick:()=>U(t.key),style:{padding:"5px 18px",borderRadius:999,border:b===t.key?"1.5px solid var(--accent)":"1.5px solid var(--border-subtle)",background:b===t.key?"var(--accent)":"transparent",color:b===t.key?"#000":"var(--text-muted)",fontWeight:700,fontSize:13,cursor:"pointer"},children:t.label},t.key))}),b==="today"&&e.jsxs("div",{children:[N&&e.jsxs("div",{className:"rounded-xl p-3 mb-3",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:N.why}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:["Effort: ",N.effort," · BPM: ",N.bpmRange," · Cadence: ",N.cadence]})]}),Ue?e.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading workout..."}):c?e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("span",{className:"inline-block rounded-full px-3 py-1 text-xs font-bold mb-3",style:{background:"var(--accent)",color:"#000"},children:c.typeLabel}),e.jsx("p",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:c.distanceLabel}),c.pace&&e.jsx("p",{className:"mt-1",style:{color:"var(--text-muted)"},children:c.pace}),c.description&&e.jsx("p",{className:"mt-3 text-sm",style:{color:"var(--text-muted)"},children:c.description}),e.jsx("button",{onClick:()=>ue(!0),className:"w-full mt-4 rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Send to Watch"})]}):e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{style:{color:"var(--text-muted)"},children:"No workout scheduled today — rest up or log a free run."}),e.jsx("button",{onClick:()=>U("log"),className:"mt-4 rounded-xl px-4 py-2 font-semibold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Log Free Run"})]})]}),b==="week"&&e.jsxs("div",{children:[ie&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:14},children:"Loading your week..."}),!ie&&!w&&e.jsx("div",{style:{textAlign:"center",padding:"24px 0",color:"var(--text-muted)",fontSize:14},children:"No training plan yet. Go to your Plan tab to generate one."}),w&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:(()=>{const t=new Date().toLocaleDateString("en-US",{weekday:"short"});return w.map((r,o)=>{const l=r.day===t,v=Ge===o,p=r.rest?"var(--text-muted)":r.type==="long"?"#3b82f6":"var(--accent)";return e.jsxs("div",{onClick:()=>qe(v?null:o),style:{borderRadius:14,padding:"12px 16px",cursor:"pointer",background:l?"var(--accent-dim)":"var(--bg-base)",border:`1.5px solid ${l?"var(--accent)":"var(--border-subtle)"}`,transition:"background 0.15s"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{width:36,textAlign:"center"},children:[e.jsx("p",{style:{fontSize:12,fontWeight:700,color:l?"var(--accent)":"var(--text-muted)"},children:r.day}),l&&e.jsx("p",{style:{fontSize:9,color:"var(--accent)",fontWeight:700},children:"TODAY"})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)",textTransform:"capitalize"},children:r.rest?"Rest Day":r.type==="long"?"Long Run":r.type==="easy"?"Easy Run":String(r.type).replace(/_/g," ")}),!r.rest&&r.distance_miles>0&&e.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)"},children:[Number(r.distance_miles).toFixed(1)," miles"]})]})]}),e.jsx("span",{style:{fontSize:11,fontWeight:700,color:p,background:r.rest?"var(--bg-card)":"transparent",padding:"3px 8px",borderRadius:8,border:`1px solid ${p}`},children:r.rest?"Rest":r.type==="long"?"Long":"Easy"})]}),v&&e.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid var(--border-subtle)"},children:[r.description&&e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",lineHeight:1.6,marginBottom:12},children:r.description}),!r.rest&&e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12},children:[r.distance_miles>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:Number(r.distance_miles).toFixed(1)}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"miles"})]}),r.duration_min>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:r.duration_min}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"minutes"})]}),r.pace_target&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:r.pace_target}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"target pace"})]})]}),!r.rest&&l&&e.jsx("button",{onClick:u=>{u.stopPropagation(),s("/run/active",{state:{countdown:Ce,runType:r.type||"easy",runEnvironment:"outdoor",surface:D==="yes"?"track":"road",mapMyRun:!0,trackMode:D==="yes"}})},style:{width:"100%",background:"var(--accent)",color:"#000",fontWeight:900,borderRadius:10,padding:"12px",border:"none",cursor:"pointer",fontSize:14},children:"Start This Run"})]})]},o)})})()})]}),b==="log"&&e.jsxs("form",{onSubmit:rt,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm mb-2",style:{color:"var(--text-primary)"},children:"Run type"}),e.jsx("div",{className:"flex gap-2 mb-4",children:["easy","tempo","long","walk"].map(t=>e.jsx("button",{type:"button",onClick:()=>Re(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:E===t?"var(--accent)":"var(--bg-card)",color:E===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t==="walk"?"Walk":t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("p",{className:"text-sm mb-2",style:{color:"var(--text-primary)"},children:"Are you running outside or inside?"}),e.jsx("div",{className:"flex gap-2",children:["outside","inside"].map(t=>e.jsx("button",{type:"button",onClick:()=>Pe(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:j===t?"var(--accent)":"var(--bg-card)",color:j===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),j==="outside"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Are you doing a track workout?"}),e.jsx("div",{className:"flex gap-2",children:["yes","no"].map(t=>e.jsx("button",{type:"button",onClick:()=>Le(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:D===t?"var(--accent)":"var(--bg-card)",color:D===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t==="yes"?"Yes (track intervals)":"No (road run)"},t))})]}),j==="inside"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"What treadmill are you using?"}),e.jsx("select",{value:M,onChange:t=>Te(t.target.value),className:"w-full rounded-xl px-3 py-2",style:{background:"var(--bg-card)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},children:["Generic","Peloton","NordicTrack","Precor","Life Fitness","Other"].map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("input",{type:"number",step:"0.1",min:"0",required:!0,className:"text-5xl font-bold bg-transparent text-center w-32 focus:outline-none",style:{color:"var(--accent)"},value:k,onChange:t=>Ee(t.target.value),placeholder:"0.0"}),e.jsxs("div",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:["Distance (",i.distanceLabel,")"]}),W.distance&&e.jsx("p",{ref:pe,className:"text-xs mt-2",style:{color:"#ef4444"},children:W.distance}),R&&e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:["Estimated time: ",R.low,"–",R.high," min based on your recent ",Math.floor(R.avg),":",String(Math.round(R.avg%1*60)).padStart(2,"0"),"/mi average pace"]})]})}),e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"flex gap-2 justify-center",children:e.jsx("input",{type:"text",required:!0,value:q,onChange:t=>ee(t.target.value),onBlur:()=>{const t=ge(q);t&&ee(dt(t))},placeholder:"MM:SS or HH:MM:SS",className:"w-full max-w-xs rounded-full border px-4 py-3 text-center text-xl font-bold",style:{borderColor:"var(--border-subtle)",background:"var(--bg-card)",color:"var(--text-primary)"}})}),W.duration&&e.jsx("p",{ref:be,className:"text-xs mt-2 text-center",style:{color:"#ef4444"},children:W.duration}),ne.pace&&e.jsx("p",{className:"text-xs mt-2 text-center",style:{color:"#f59e0b"},children:ne.pace})]}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:e.jsx("textarea",{rows:4,placeholder:"How did it feel? Anything worth remembering?",value:Y,onChange:t=>Me(t.target.value),className:"w-full rounded-xl border px-4 py-3",style:{borderColor:"var(--border-subtle)",background:"var(--bg-card)",color:"var(--text-primary)"}})}),e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"flex gap-2 mb-4",children:Nt.map(t=>{const r=t.icon,o=H===t.value;return e.jsxs("button",{type:"button",onClick:()=>_e(t.value),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:5,padding:"10px 4px",borderRadius:12,border:o?"2px solid var(--accent)":"2px solid var(--border-subtle)",background:o?"var(--bg-card)":"var(--bg-base)",color:o?"var(--accent)":"var(--text-muted)",cursor:"pointer",fontSize:11,fontWeight:700},children:[e.jsx(r,{size:20}),e.jsx("span",{children:t.label})]},t.value)})}),e.jsx(Pt,{effort:J,setEffort:De})]}),O.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:6},children:"Running In"}),((ve=O.find(t=>t.id===_))==null?void 0:ve.alert)&&e.jsxs("p",{style:{fontSize:11,color:"#f97316",marginBottom:4},children:["This shoe is at ",(ye=O.find(t=>t.id===_))==null?void 0:ye.pct_used,"% — consider rotating to a fresh pair"]}),e.jsxs("select",{value:_,onChange:t=>Xe(t.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)",fontSize:14},children:[e.jsx("option",{value:"",children:"No shoe selected"}),O.map(t=>e.jsxs("option",{value:t.id,children:[t.brand," ",t.model,t.nickname?` (${t.nickname})`:""," — ",t.total_miles," mi"]},t.id))]}),e.jsx("button",{onClick:()=>window.location.href="/gear",style:{background:"none",border:"none",color:"var(--text-muted)",fontSize:12,cursor:"pointer",padding:"4px 0",textDecoration:"underline",marginTop:8},children:"Manage shoes / add new pair"})]}),e.jsx("input",{type:"date",value:G,onChange:t=>ze(t.target.value),className:"w-full rounded-xl border px-4 py-3",style:{borderColor:"var(--border-subtle)",background:"var(--bg-base)",color:"var(--text-primary)"}}),e.jsx("button",{type:"submit",disabled:te||We,className:"w-full rounded-xl py-3 font-semibold disabled:opacity-70",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:te?"Logging run...":"Save Run"}),oe&&e.jsx("p",{className:"mt-2 text-sm",style:{color:"var(--accent)"},children:oe}),ae&&e.jsx("div",{className:"mt-2 rounded-xl p-3",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:ae}),A&&e.jsx("div",{className:"mt-4",children:e.jsx(xt,{activityId:A,activityType:"run"})})]}),e.jsx(it,{to:"/",className:"mt-5 inline-block text-sm",style:{color:"var(--text-muted)"},children:"← Back"})]}),Ye&&e.jsx(Tt,{workout:c,onClose:()=>ue(!1)}),n&&e.jsxs("div",{className:"fixed inset-0 z-50",style:{background:"var(--bg-base)"},children:[e.jsxs("div",{className:"h-full overflow-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>$(null),style:{color:"var(--text-primary)"},children:"← Back"}),e.jsx("h3",{className:"font-bold",style:{color:"var(--text-primary)"},children:"Run Detail"}),e.jsx("button",{onClick:()=>xe(!0),style:{color:"var(--text-primary)"},children:e.jsx(vt,{size:18})})]}),f.overview&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Overview"}),e.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:n.date}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:n.surface||n.run_surface||"road"}),e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:["Effort ",n.perceived_effort||5,"/10"]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:n.type})]})]}),f.stats&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Stats"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Distance"}),e.jsxs("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:[n.distance_miles||0," mi"]})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Time"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:Ct(n.duration_seconds||0)})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Avg Pace"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:_t(n.duration_seconds,n.distance_miles)})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Calories"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:n.calories||"—"})]})]})]}),f.pace&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Pace Chart"}),he.length?e.jsx("svg",{width:"100%",height:"120",viewBox:"0 0 320 120",children:he.map((t,r)=>{const o=Number(t.seconds||t.pace_seconds||t.value||0),l=Math.max(10,100-Math.min(90,Math.floor(o/10)));return e.jsx("rect",{x:10+r*30,y:110-l,width:"20",height:l,fill:"var(--accent)"},r)})}):e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"GPS splits available in the mobile app"})]}),f.hr&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Heart Rate"}),n.avg_hr||n.avg_heart_rate?e.jsxs("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:[n.avg_hr||n.avg_heart_rate," bpm"]}):e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Connect a watch to see HR data"})]}),f.notes&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Notes"}),e.jsx("textarea",{rows:5,value:C,onChange:t=>Qe(t.target.value),className:"w-full rounded-xl border px-3 py-2",style:{borderColor:"var(--border-subtle)",background:"var(--bg-base)",color:"var(--text-primary)"}}),e.jsx("button",{onClick:st,className:"mt-2 rounded-lg px-3 py-2 text-sm font-semibold",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Save Notes"})]}),e.jsx("button",{onClick:at,className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--bg-card)",color:"var(--accent)",border:"1px solid var(--accent)"},children:"Delete Run"})]}),Je&&e.jsxs("div",{className:"fixed inset-x-0 bottom-0 z-10 rounded-t-2xl p-4",style:{background:"var(--bg-card)",borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-bold mb-3",style:{color:"var(--text-primary)"},children:"Customize Panels"}),Object.entries({overview:"Overview",stats:"Stats Grid",pace:"Pace Chart",hr:"Heart Rate",notes:"Notes"}).map(([t,r])=>e.jsxs("label",{className:"flex items-center justify-between py-2",style:{color:"var(--text-primary)"},children:[e.jsx("span",{children:r}),e.jsx("input",{type:"checkbox",checked:f[t],onChange:o=>Ke(l=>({...l,[t]:o.target.checked}))})]},t)),e.jsx("button",{onClick:()=>xe(!1),className:"w-full mt-3 rounded-xl py-2",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Done"})]})]}),Oe&&A&&e.jsx(ut,{runId:A,onDone:()=>{le(!1),s("/")}}),$e&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)"},children:e.jsxs("div",{className:"w-full max-w-sm rounded-2xl p-5",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h3",{className:"text-xl font-black",style:{color:"var(--text-primary)"},children:"Great run! Time to recover."}),e.jsx("p",{className:"mt-2 text-sm",style:{color:"var(--text-muted)"},children:"Post-run recovery uses static holds. Hold each stretch for the full duration to target the muscles you just used."}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{I(!1),s("/stretches/session?type=post")},className:"flex-1 rounded-xl px-4 py-2 font-bold",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Start Recovery"}),e.jsx("button",{onClick:()=>I(!1),className:"flex-1 rounded-xl px-4 py-2",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)",color:"var(--text-muted)"},children:"Skip"})]})]})})]}):e.jsxs("div",{className:"rounded-2xl p-6",style:{background:"var(--bg-card)"},children:[e.jsx("h2",{className:"text-xl font-black mb-2",style:{color:"var(--text-primary)"},children:"Morning Check-In Required"}),e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:"Complete your morning check-in before starting a run."}),e.jsx("button",{onClick:()=>s("/checkin"),className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Go to Check-In"})]})}export{qt as default};
