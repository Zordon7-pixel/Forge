import{b as oe,r as o,a as y,j as e}from"./index-Bez5XITZ.js";import{q as j}from"./offlineQueue-B-c8T9Pb.js";import{g as ne,a as ie}from"./athleteLanguage-Bz0_Lcws.js";const ce=[{key:"chest",label:"Chest"},{key:"back",label:"Back"},{key:"legs",label:"Legs"},{key:"shoulders",label:"Shoulders"},{key:"arms",label:"Arms"},{key:"core",label:"Core"}],w="#374151",u="#EAB308";function Y({highlight:d,sex:h="male"}){const v=m=>d==="full"||d===m?u:w,c=h==="female";return e.jsxs("svg",{viewBox:"0 0 60 90",width:"52",height:"78",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"30",cy:"9",r:"8",fill:w}),e.jsx("rect",{x:"27",y:"17",width:"6",height:"5",fill:w}),e.jsx("rect",{x:c?9:7,y:"20",width:"9",height:"24",rx:"4",fill:v("arms")}),e.jsx("rect",{x:c?42:44,y:"20",width:"9",height:"24",rx:"4",fill:v("arms")}),e.jsx("rect",{x:"16",y:"20",width:"28",height:"33",rx:"4",fill:w}),c&&e.jsx("rect",{x:"18",y:"34",width:"24",height:"8",rx:"2",fill:w}),(d==="shoulders"||d==="full")&&e.jsxs(e.Fragment,{children:[e.jsx("rect",{x:c?9:7,y:"20",width:"9",height:"11",rx:"4",fill:u}),e.jsx("rect",{x:c?42:44,y:"20",width:"9",height:"11",rx:"4",fill:u}),e.jsx("rect",{x:"15",y:"20",width:"30",height:"8",rx:"3",fill:u})]}),(d==="chest"||d==="full")&&e.jsx("rect",{x:"18",y:"23",width:"24",height:"14",rx:"3",fill:u}),(d==="back"||d==="full")&&e.jsx("rect",{x:"16",y:"22",width:"28",height:"13",rx:"3",fill:u}),(d==="core"||d==="full")&&e.jsx("rect",{x:"18",y:"37",width:"24",height:"14",rx:"3",fill:u}),e.jsx("rect",{x:c?15:17,y:"53",width:c?13:11,height:"33",rx:"4",fill:v("legs")}),e.jsx("rect",{x:32,y:"53",width:c?13:11,height:"33",rx:"4",fill:v("legs")})]})}function me(){const d=oe(),[h,v]=o.useState([]),[c,m]=o.useState(!1),[F,p]=o.useState(""),[r,T]=o.useState(null),[G,J]=o.useState("male"),[$,K]=o.useState(""),[C,Q]=o.useState(null),[k,X]=o.useState("ai"),[l,E]=o.useState(null),[O,P]=o.useState(!1),[L,B]=o.useState(null),[Z,I]=o.useState(""),[x,ee]=o.useState(null),[M,W]=o.useState(!1),[R,z]=o.useState(""),[U,g]=o.useState(""),[N,V]=o.useState([]);o.useEffect(()=>{y.get("/auth/me").then(t=>{var a;J(((a=t.data.user)==null?void 0:a.sex)||"male")}).catch(()=>{})},[]),o.useEffect(()=>{y.get("/lifts").then(t=>{var a;return V(((a=t.data)==null?void 0:a.lifts)||[])}).catch(()=>V([]))},[]);const f=h[0]||"";o.useEffect(()=>{P(!0),B(null),y.get("/ai/workout-recommendation?date=today").then(t=>{var a;E(((a=t.data)==null?void 0:a.recommendation)||null)}).catch(t=>{console.error("Failed to fetch AI recommendation:",t),B("Could not generate recommendation"),E(null)}).finally(()=>P(!1))},[]);const q=t=>v(a=>{const s=a.includes(t)?a.filter(b=>b!==t):[...a,t],n=s[0]||"";return r&&r.muscle_group!==n&&(T(null),I("")),s}),te=async()=>{var t,a;m(!0),p(""),g("");try{const n=((l==null?void 0:l.target)||"").split(/[,\/\s]+/).map(le=>le.trim().toLowerCase()).filter(Boolean),b={muscle_groups:n.length?n:["full"]};if(!navigator.onLine){await j("/api/workouts/start","POST",b),g("Saved offline — will sync when connected"),m(!1);return}const A=await y.post("/workouts/start",b);d(`/workout/active/${A.data.session.id}`,{state:{exercises:(l==null?void 0:l.main)||[],workoutName:(l==null?void 0:l.workoutName)||""}})}catch(s){if(!(s!=null&&s.response)){const b=((l==null?void 0:l.target)||"").split(/[,\/\s]+/).map(A=>A.trim().toLowerCase()).filter(Boolean);await j("/api/workouts/start","POST",{muscle_groups:b.length?b:["full"]}),g("Saved offline — will sync when connected"),p("");return}p(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.error)||"Could not start workout. Try again.")}finally{m(!1)}},se=async()=>{var t,a;m(!0),p(""),g("");try{const s={muscle_groups:h,exercise_name:(r==null?void 0:r.name)||""};if(!navigator.onLine){await j("/api/workouts/start","POST",s),g("Saved offline — will sync when connected");return}const n=await y.post("/workouts/start",s);d(`/workout/active/${n.data.session.id}`)}catch(s){if(!(s!=null&&s.response)){await j("/api/workouts/start","POST",{muscle_groups:h,exercise_name:(r==null?void 0:r.name)||""}),g("Saved offline — will sync when connected"),p("");return}p(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.error)||"Could not start workout. Try again.")}finally{m(!1)}},D=async()=>{var t,a,s;if(!(!f||!(r!=null&&r.name))){W(!0),z("");try{const n=await y.post("/ai/workout",{bodyPart:f,exercise:r.name});ee(((t=n.data)==null?void 0:t.recommendation)||null)}catch(n){z(((s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.error)||"Could not generate AI workout")}finally{W(!1)}}},ae=async()=>{var t,a;if(x){m(!0),p(""),g("");try{const n={muscle_groups:[f||"full"],exercise_name:(r==null?void 0:r.name)||""};if(!navigator.onLine){await j("/api/workouts/start","POST",n),g("Saved offline — will sync when connected");return}const b=await y.post("/workouts/start",n);d(`/workout/active/${b.data.session.id}`,{state:{exercises:(x==null?void 0:x.main)||[],workoutName:(x==null?void 0:x.workoutName)||""}})}catch(s){if(!(s!=null&&s.response)){await j("/api/workouts/start","POST",{muscle_groups:[f||"full"],exercise_name:(r==null?void 0:r.name)||""}),g("Saved offline — will sync when connected"),p("");return}p(((a=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:a.error)||"Could not start workout. Try again.")}finally{m(!1)}}},H=(t="")=>String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()),i=N[0]||null,S=o.useMemo(()=>i&&(N.slice(1).find(t=>t.exercise_name===i.exercise_name)||N[1])||null,[i,N]),_=i?ne(i.sets,i.reps,i.weight_lbs):null,re=i?ie(S?{sets:S.sets,reps:S.reps,weight:S.weight_lbs}:null,{sets:i.sets,reps:i.reps,weight:i.weight_lbs}):"";return e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-1",style:{color:"var(--text-primary)"},children:"Start Workout"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Select the muscle groups you are targeting today"})]}),i&&_&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Last Logged Lift"}),e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:i.exercise_name||"Lift"}),e.jsxs("p",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:[i.sets," x ",i.reps," @ ",i.weight_lbs," lbs"]}),e.jsxs("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:["Volume: ",_.totalLbs.toLocaleString()," lbs - ",_.label," effort"]}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:re})]}),e.jsx("div",{className:"flex gap-2",children:["manual","ai"].map(t=>e.jsx("button",{onClick:()=>X(t),className:"rounded-full px-4 py-2 text-xs font-bold",style:{background:k===t?"var(--accent)":"var(--bg-input)",color:k===t?"#000":"var(--text-muted)"},children:t==="manual"?"Manual":"AI Recommends"},t))}),k==="ai"&&e.jsxs(e.Fragment,{children:[O&&e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)",color:"var(--text-muted)"},children:e.jsx("p",{className:"text-sm",children:"Generating your personalized workout..."})}),L&&e.jsx("div",{className:"rounded-2xl p-4",style:{background:"rgba(239,68,68,0.1)",color:"#ef4444",border:"1px solid rgba(239,68,68,0.3)"},children:e.jsx("p",{className:"text-sm",children:L})}),!O&&!l&&!L&&e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)",color:"var(--text-muted)"},children:e.jsx("p",{className:"text-sm",children:"No recommendation available yet. Check back later."})}),l&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"#F5F0E8",color:"#1a1a2e",border:"1px solid #d6c9a0",position:"relative",fontFamily:"Caveat, cursive",backgroundImage:"repeating-linear-gradient(to bottom, transparent 0 27px, rgba(26,26,46,0.12) 27px 28px)"},children:[e.jsx("div",{style:{position:"absolute",top:8,right:10,fontSize:11,fontWeight:700,border:"1px solid #1a1a2e66",borderRadius:999,padding:"2px 8px"},children:"FORGE"}),e.jsx("div",{style:{position:"absolute",left:0,right:0,bottom:-1,height:14,background:"linear-gradient(135deg, #eadfcd 25%, transparent 25%) 0 0/12px 12px, linear-gradient(225deg, #eadfcd 25%, transparent 25%) 6px 0/12px 12px"}}),e.jsxs("p",{className:"text-lg font-bold",children:[l.workoutName," — ",H(l.target)]}),e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("strong",{children:"Warmup:"})," ",(l.warmup||[]).join(", ")]}),e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("strong",{children:"Main:"})," ",(l.main||[]).map(t=>`${t.name} ${t.sets}x${t.reps} (${t.rest})`).join(" • ")]}),e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("strong",{children:"Recovery:"})," ",(l.recovery||[]).join(", ")]}),e.jsx("p",{className:"text-sm mt-2",children:l.explanation}),e.jsx("p",{className:"text-xs mt-1",children:l.restExplanation}),e.jsx("button",{onClick:te,disabled:c,className:"mt-3 w-full rounded-2xl py-4 text-base font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer",opacity:c?.6:1,fontFamily:"inherit"},children:c?"Starting...":"Start Workout"})]})]}),k==="manual"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[ce.map(({key:t,label:a})=>{const s=h.includes(t);return e.jsxs("button",{onClick:()=>q(t),className:"flex flex-col items-center justify-between rounded-2xl py-3 px-2 transition-all",style:{background:s?"rgba(234,179,8,0.08)":"var(--bg-card)",border:`2px solid ${s?u:"var(--border-subtle)"}`,minHeight:110,boxShadow:s?"0 0 10px rgba(234,179,8,0.25)":"none"},children:[e.jsx(Y,{highlight:t,sex:G}),e.jsx("span",{className:"text-xs font-semibold mt-1 capitalize",style:{color:s?u:"var(--text-muted)"},children:a})]},t)}),(()=>{const t=h.includes("full");return e.jsxs("button",{onClick:()=>q("full"),className:"col-span-3 flex items-center justify-center gap-4 rounded-2xl py-3 px-4 transition-all",style:{background:t?"rgba(234,179,8,0.08)":"var(--bg-card)",border:`2px solid ${t?u:"var(--border-subtle)"}`,minHeight:72,boxShadow:t?"0 0 10px rgba(234,179,8,0.25)":"none"},children:[e.jsx(Y,{highlight:"full",sex:G}),e.jsx("span",{className:"text-sm font-bold",style:{color:t?u:"var(--text-muted)"},children:"Full Body"})]})})()]}),f&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"How much time do you have?"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["15","30","45","60","90+"].map(t=>e.jsxs("button",{type:"button",onClick:async()=>{var s;K(t);const a=await y.post("/ai/lift-plan",{bodyPart:f,timeAvailable:t,userId:"me"}).catch(()=>null);Q(((s=a==null?void 0:a.data)==null?void 0:s.plan)||null)},className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:$===t?"var(--accent)":"var(--bg-input)",color:$===t?"#000":"var(--text-muted)"},children:[t," min"]},t))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Exercise"}),e.jsx("input",{value:Z,onChange:t=>{I(t.target.value),T(t.target.value?{name:t.target.value,muscle_group:f}:null)},placeholder:"e.g. Incline Dumbbell Press",className:"w-full mt-1 rounded-xl px-3 py-2",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"}})]}),r&&e.jsxs("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:["Exercise: ",r.name]}),C&&e.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[C.workoutName," · Estimated: ",C.estimatedTime]}),f&&(r==null?void 0:r.name)&&e.jsx("button",{type:"button",onClick:D,disabled:M,className:"rounded-xl px-4 py-2 text-sm font-bold",style:{background:"#EAB308",color:"#000",border:"none"},children:M?"Generating...":`Generate AI Workout for ${H(f)}`}),R&&e.jsx("p",{className:"text-xs",style:{color:"#ef4444"},children:R}),x&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"#F5F0E8",color:"#1a1a2e",border:"1px solid #d6c9a0",position:"relative",fontFamily:"Caveat, cursive",backgroundImage:"repeating-linear-gradient(to bottom, transparent 0 27px, rgba(26,26,46,0.12) 27px 28px)"},children:[e.jsx("div",{style:{position:"absolute",top:8,right:10,fontSize:11,fontWeight:700,border:"1px solid #1a1a2e66",borderRadius:999,padding:"2px 8px"},children:"FORGE"}),e.jsx("p",{className:"text-lg font-bold",children:x.workoutName}),e.jsxs("p",{className:"text-sm mt-2",children:[e.jsx("strong",{children:"Main:"})," ",(x.main||[]).map(t=>`${t.name} ${t.sets}x${t.reps} (${t.rest})`).join(" • ")]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{type:"button",onClick:ae,className:"flex-1 rounded-xl py-2 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",fontFamily:"inherit"},children:"Accept Workout"}),e.jsx("button",{type:"button",onClick:D,className:"flex-1 rounded-xl py-2 font-bold",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)",fontFamily:"inherit"},children:"Regenerate"})]})]})]}),F&&e.jsx("p",{className:"text-sm",style:{color:"var(--accent)"},children:F}),U&&e.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:U}),e.jsx("button",{onClick:se,disabled:c||h.length===0,className:"w-full rounded-2xl py-4 text-lg font-bold disabled:opacity-60 transition-all",style:{background:"var(--accent)",color:"black"},children:c?"Starting...":"Begin Workout"})]})]})}export{me as default};
