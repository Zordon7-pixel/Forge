import{r as x,j as e,b,a as h}from"./index-DPvCFa56.js";import{H as f}from"./heart-C6YbR_HN.js";const j=["The body achieves what the mind believes.","Small daily progress creates big race-day results.","Discipline beats motivation on hard days.","One workout does not define you. Consistency does.","Show up today. Future you is watching."];function L(){const[t,l]=x.useState("feed");return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xl font-bold",style:{color:"var(--text-primary)"},children:"Community"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[{key:"feed",label:"Feed"},{key:"workouts",label:"Workouts"},{key:"routes",label:"Routes"}].map(o=>e.jsx("button",{onClick:()=>l(o.key),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:t===o.key?"var(--accent)":"var(--bg-input)",color:t===o.key?"#000":"var(--text-muted)"},children:o.label},o.key))}),t==="feed"?e.jsx(k,{}):t==="workouts"?e.jsx(N,{}):e.jsx(S,{})]})}function k(){const t=b(),[l,o]=x.useState([]),[d,m]=x.useState([]);return x.useEffect(()=>{h.get("/community/posts").then(a=>{var s;return o(((s=a.data)==null?void 0:s.posts)||[])}).catch(()=>o([])),Promise.all([h.get("/runs").catch(()=>({data:{runs:[]}})),h.get("/workouts").catch(()=>({data:{sessions:[]}}))]).then(([a,s])=>{var p,u;const r=(((p=a.data)==null?void 0:p.runs)||[]).slice(0,3).map(i=>({id:`run-${i.id}`,title:`Run · ${Number(i.distance_miles||0).toFixed(2)} mi`,sub:i.date||i.created_at})),c=(((u=s.data)==null?void 0:u.sessions)||[]).slice(0,2).map(i=>({id:`lift-${i.id}`,title:`Lift · ${Math.round((i.total_seconds||0)/60)} min`,sub:i.started_at}));m([...r,...c])}).catch(()=>m([]))},[]),l.length===0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-xl p-4",style:{background:"#1a1d2e",border:"1px solid #2a2d3e"},children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"#EAB308"},children:"Inspiration Mode"}),e.jsx("div",{className:"space-y-2 mt-3",children:j.slice(0,4).map((a,s)=>e.jsxs("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:['"',a,'"']},s))}),e.jsx("button",{onClick:()=>t("/log-run"),className:"mt-4 rounded-lg px-3 py-2 text-xs font-bold",style:{background:"#EAB308",color:"#0f1117"},children:"Be the first to share"})]}),e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Your Highlights"}),e.jsxs("div",{className:"space-y-2 mt-3",children:[d.map(a=>e.jsxs("div",{className:"rounded-lg p-2",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:a.title}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:new Date(a.sub).toLocaleDateString()})]},a.id)),d.length===0&&e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No recent workouts yet."})]})]})]}):e.jsx("div",{className:"space-y-3",children:l.map(a=>e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:a.title}),a.body&&e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:a.body}),e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:["by ",a.user_name||"Athlete"," · ",new Date(a.created_at).toLocaleDateString()]})]},a.id))})}function N(){const[t,l]=x.useState("popular"),[o,d]=x.useState(""),[m,a]=x.useState([]);return x.useEffect(()=>{h.get("/community/workouts",{params:{sort:t,target:o||void 0}}).then(s=>{var r;return a(((r=s.data)==null?void 0:r.workouts)||[])}).catch(()=>a([]))},[t,o]),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[["popular","newest"].map(s=>e.jsx("button",{onClick:()=>l(s),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:t===s?"var(--accent)":"var(--bg-input)",color:t===s?"#000":"var(--text-muted)"},children:s==="popular"?"Popular":"Newest"},s)),e.jsx("input",{value:o,onChange:s=>d(s.target.value),placeholder:"By body part",className:"rounded-full px-3 py-1 text-xs",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"}})]}),m.map(s=>e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-card)"},children:[e.jsx("p",{className:"font-semibold",style:{color:"var(--text-primary)"},children:s.workout_name}),e.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[s.target," · Used ",s.usage_count||0," times"]}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:(s.main||[]).slice(0,2).map(r=>r.name||r).join(" · ")}),e.jsx("button",{onClick:()=>h.post(`/community/workouts/${s.id}/save`).catch(()=>{}),className:"mt-2 rounded-lg px-3 py-1.5 text-xs font-semibold",style:{background:"var(--accent)",color:"#000"},children:"Save to My Plan"})]},s.id)),m.length===0&&e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"No workouts found yet."})]})}function S(){const[t,l]=x.useState([]),[o,d]=x.useState("newest"),[m,a]=x.useState(!1);x.useEffect(()=>{a(!0),h.get("/routes",{params:{sort:o==="popular"?"popular":"newest"}}).then(r=>{var c;return l(((c=r.data)==null?void 0:c.routes)||[])}).catch(()=>l([])).finally(()=>a(!1))},[o]);const s=async r=>{try{const c=await h.post(`/routes/${r}/like`);l(p=>p.map(u=>{var i,y;return u.id===r?{...u,liked:(i=c.data)==null?void 0:i.liked,likes_count:((y=c.data)==null?void 0:y.likes_count)??u.likes_count}:u}))}catch(c){console.error("Failed to toggle like",c)}};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex gap-2",children:["newest","popular"].map(r=>e.jsx("button",{onClick:()=>d(r),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:o===r?"var(--accent)":"var(--bg-input)",color:o===r?"#000":"var(--text-muted)"},children:r==="newest"?"Newest":"Popular"},r))}),m&&e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Loading routes..."}),!m&&t.length===0&&e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"No shared routes yet. Be the first to post one!"}),t.map(r=>e.jsx(w,{route:r,onLike:s},r.id))]})}function w({route:t,onLike:l}){const o=d=>{if(!d)return"--";const m=Math.floor(d/60),a=Math.round(d%60);return`${m}:${String(a).padStart(2,"0")} /mi`};return e.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:16,padding:16,border:"1px solid var(--border-subtle)",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)",margin:0},children:t.title}),e.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["by ",t.runner_name||"Athlete"," ",t.city?`· ${t.city}`:""]})]}),e.jsxs("button",{onClick:()=>l(t.id),style:{background:t.liked?"rgba(234,179,8,0.15)":"var(--bg-input)",border:`1px solid ${t.liked?"#EAB308":"var(--border-subtle)"}`,borderRadius:8,padding:"4px 10px",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[e.jsx(f,{size:14,color:t.liked?"#EAB308":"var(--text-muted)",fill:t.liked?"#EAB308":"none"}),e.jsx("span",{style:{fontSize:12,color:t.liked?"#EAB308":"var(--text-muted)"},children:t.likes_count})]})]}),e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:10},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:800,color:"var(--text-primary)",margin:0},children:Number(t.distance_miles||0).toFixed(2)}),e.jsx("p",{style:{fontSize:10,color:"var(--text-muted)",margin:0},children:"miles"})]}),t.avg_pace&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:800,color:"var(--text-primary)",margin:0},children:o(t.avg_pace)}),e.jsx("p",{style:{fontSize:10,color:"var(--text-muted)",margin:0},children:"avg pace"})]}),t.surface&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:14,fontWeight:600,color:"var(--text-muted)",margin:"4px 0 0",textTransform:"capitalize"},children:t.surface}),e.jsx("p",{style:{fontSize:10,color:"var(--text-muted)",margin:0},children:"surface"})]})]}),t.route_coords&&t.route_coords.length>=2&&e.jsx(_,{coords:t.route_coords})]})}function _({coords:t}){if(!t||t.length===0)return null;const l=t.map(n=>Array.isArray(n)?{lat:n[0],lon:n[1]}:{lat:Number(n.lat),lon:Number(n.lon)}),o=l.map(n=>n.lat),d=l.map(n=>n.lon),m=Math.min(...o),a=Math.max(...o),s=Math.min(...d),r=Math.max(...d),c=10,p=280,u=100,i=n=>c+(n-s)/(r-s||1)*(p-c*2),y=n=>c+(a-n)/(a-m||1)*(u-c*2),g=l.map((n,v)=>`${v===0?"M":"L"}${i(n.lon).toFixed(1)},${y(n.lat).toFixed(1)}`).join(" ");return e.jsx("div",{style:{borderRadius:10,overflow:"hidden",background:"#111",marginTop:8},children:e.jsxs("svg",{viewBox:`0 0 ${p} ${u}`,style:{width:"100%",height:100,display:"block"},children:[e.jsx("path",{d:g,fill:"none",stroke:"#EAB308",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:i(l[0].lon),cy:y(l[0].lat),r:"4",fill:"#22c55e"}),e.jsx("circle",{cx:i(l[l.length-1].lon),cy:y(l[l.length-1].lat),r:"4",fill:"#ef4444"})]})})}export{L as default};
