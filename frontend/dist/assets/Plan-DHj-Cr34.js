import{d as A,r as n,j as t,a as d}from"./index-BY6vNrGT.js";import{C as E}from"./circle-check-5-x0qrih.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],L=A("Circle",R);function $(o={}){if(o.type==="run"){const i=Number(o.distance_miles||0);if(i>0)return`${o.title||"Run"} · ${i.toFixed(1)} mi`}return o.title||String(o.type||"session").replace("_"," ")}function z(){var N;const[o,i]=n.useState([]),[s,y]=n.useState(null),[c,g]=n.useState(null),[_,b]=n.useState(!0),[v,h]=n.useState(null),[m,u]=n.useState(!1),x=async()=>{var e,a,w;b(!0);try{const[W,S]=await Promise.all([d.get("/plans"),d.get("/plans/my")]);i(((e=W.data)==null?void 0:e.plans)||[]),y(((a=S.data)==null?void 0:a.plan)||null),g(((w=S.data)==null?void 0:w.user_plan)||null)}finally{b(!1)}};n.useEffect(()=>{x()},[]);const C=async e=>{h(e);try{await d.post(`/plans/assign/${e}`),await x()}finally{h(null)}},l=Math.max(1,Number((c==null?void 0:c.current_week)||1)),r=n.useMemo(()=>{var a;const e=((a=s==null?void 0:s.plan_data)==null?void 0:a.weeks)||[];return e[l-1]||e[0]||null},[s,l]),p=new Set(((N=c==null?void 0:c.progress)==null?void 0:N.completedSessionIds)||[]),f=((r==null?void 0:r.sessions)||[]).filter(e=>e.type!=="rest").length,M=((r==null?void 0:r.sessions)||[]).filter(e=>e.type!=="rest"&&p.has(String(e.id))).length,j=f>0?Math.round(M/f*100):0,P=async e=>{const a=p.has(String(e));u(!0);try{await d.put("/plans/my/progress",a?{unset_session_id:e,current_week:l}:{completed_session_id:e,current_week:l}),await x()}finally{u(!1)}},k=async e=>{u(!0);try{await d.put("/plans/my/progress",{current_week:e}),await x()}finally{u(!1)}};return _?t.jsx("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",color:"var(--text-muted)"},children:"Loading training plans..."}):t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[t.jsx("h2",{className:"text-xl font-bold",style:{color:"var(--text-primary)"},children:"Training Plans"}),t.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:"Running-first plans. Strength sessions focus on injury prevention only."})]}),!s&&t.jsx("div",{className:"grid gap-3",children:o.map(e=>t.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[t.jsx("p",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:e.name}),t.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:[e.type," · ",e.weeks," weeks"]}),t.jsx("p",{className:"text-sm mt-2",style:{color:"var(--text-muted)"},children:e.description}),t.jsx("button",{onClick:()=>C(e.id),disabled:v===e.id,className:"mt-3 rounded-lg px-4 py-2 text-sm font-semibold disabled:opacity-60",style:{background:"var(--accent)",color:"#000"},children:v===e.id?"Assigning...":"Assign Plan"})]},e.id))}),s&&t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[t.jsx("p",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:s.name}),t.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:[s.type," · Week ",l," of ",s.weeks]}),t.jsx("div",{className:"mt-3 h-2 rounded-full",style:{background:"var(--bg-input)"},children:t.jsx("div",{className:"h-2 rounded-full",style:{width:`${j}%`,background:"#EAB308"}})}),t.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:[j,"% complete this week"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>k(Math.max(1,l-1)),disabled:l<=1||m,className:"rounded-lg px-3 py-1.5 text-xs font-semibold disabled:opacity-50",style:{background:"var(--bg-input)",color:"var(--text-primary)"},children:"Previous Week"}),t.jsx("button",{onClick:()=>k(Math.min(Number(s.weeks||l),l+1)),disabled:l>=Number(s.weeks||l)||m,className:"rounded-lg px-3 py-1.5 text-xs font-semibold disabled:opacity-50",style:{background:"var(--bg-input)",color:"var(--text-primary)"},children:"Next Week"})]}),t.jsx("div",{className:"rounded-xl p-4 space-y-2",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:((r==null?void 0:r.sessions)||[]).map(e=>{const a=p.has(String(e.id));return t.jsxs("button",{onClick:()=>e.type!=="rest"&&P(e.id),disabled:m||e.type==="rest",className:"w-full rounded-lg p-3 flex items-center justify-between disabled:opacity-70",style:{background:"var(--bg-input)"},children:[t.jsxs("div",{className:"text-left",children:[t.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:e.day}),t.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:$(e)})]}),e.type==="rest"?t.jsx("p",{className:"text-xs font-semibold",style:{color:"var(--text-muted)"},children:"REST"}):a?t.jsx(E,{size:18,color:"#EAB308"}):t.jsx(L,{size:18,color:"var(--text-muted)"})]},e.id)})}),t.jsx("button",{onClick:()=>{y(null),g(null)},className:"rounded-lg px-4 py-2 text-sm font-semibold",style:{background:"var(--bg-input)",color:"var(--text-primary)"},children:"Change Plan"})]})]})}export{z as default};
