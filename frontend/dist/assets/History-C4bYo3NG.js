import{d as Fe,R,r as u,j as e,a as I,e as Be,c as We,u as Ye,L as fe}from"./index-xcBp2yTO.js";import{f as he,p as Ve}from"./parseDuration-3bmQJghK.js";import{X as Ae}from"./x-BMwewO6c.js";import{B as De}from"./brain-Dx_JeS_k.js";import{L as He}from"./LoadingRunner-D_xQNgIC.js";import{i as Ge,c as ve,D as Ke,f as Ue,E as Ze,L as ie,a as te,C as Xe,A as qe,b as q,d as Je,e as de,h as Qe,g as et,j as Ce,u as tt,G as at,k as be,l as rt,X as ue,Y as me,m as st,R as ye,B as nt,T as ge,n as ot}from"./BarChart-E7CZkpv0.js";import{P as je}from"./pencil-DibQxkFa.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ke=Fe("Trash2",lt);var it=["type","layout","connectNulls","ref"],ct=["key"];function X(t){"@babel/helpers - typeof";return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},X(t)}function Ne(t,r){if(t==null)return{};var s=dt(t,r),n,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(l=0;l<i.length;l++)n=i[l],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function dt(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function J(){return J=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},J.apply(this,arguments)}function Se(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),s.push.apply(s,n)}return s}function $(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Se(Object(s),!0).forEach(function(n){B(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Se(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function Z(t){return pt(t)||xt(t)||mt(t)||ut()}function ut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mt(t,r){if(t){if(typeof t=="string")return xe(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return xe(t,r)}}function xt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pt(t){if(Array.isArray(t))return xe(t)}function xe(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function ft(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function we(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ee(n.key),n)}}function ht(t,r,s){return r&&we(t.prototype,r),s&&we(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function vt(t,r,s){return r=ae(r),bt(t,Pe()?Reflect.construct(r,s||[],ae(t).constructor):r.apply(t,s))}function bt(t,r){if(r&&(X(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yt(t)}function yt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pe=function(){return!!t})()}function ae(t){return ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},ae(t)}function gt(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&pe(t,r)}function pe(t,r){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,l){return n.__proto__=l,n},pe(t,r)}function B(t,r,s){return r=Ee(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function Ee(t){var r=jt(t,"string");return X(r)=="symbol"?r:r+""}function jt(t,r){if(X(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(X(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Q=function(t){function r(){var s;ft(this,r);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return s=vt(this,r,[].concat(l)),B(s,"state",{isAnimationFinished:!0,totalLength:0}),B(s,"generateSimpleStrokeDasharray",function(o,c){return"".concat(c,"px ").concat(o-c,"px")}),B(s,"getStrokeDasharray",function(o,c,m){var g=m.reduce(function(p,_){return p+_});if(!g)return s.generateSimpleStrokeDasharray(c,o);for(var k=Math.floor(o/g),b=o%g,N=c-o,h=[],x=0,S=0;x<m.length;S+=m[x],++x)if(S+m[x]>b){h=[].concat(Z(m.slice(0,x)),[b-S]);break}var v=h.length%2===0?[0,N]:[N];return[].concat(Z(r.repeat(m,k)),Z(h),v).map(function(p){return"".concat(p,"px")}).join(", ")}),B(s,"id",tt("recharts-line-")),B(s,"pathRef",function(o){s.mainCurve=o}),B(s,"handleAnimationEnd",function(){s.setState({isAnimationFinished:!0}),s.props.onAnimationEnd&&s.props.onAnimationEnd()}),B(s,"handleAnimationStart",function(){s.setState({isAnimationFinished:!1}),s.props.onAnimationStart&&s.props.onAnimationStart()}),s}return gt(r,t),ht(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,l){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,c=i.xAxis,m=i.yAxis,g=i.layout,k=i.children,b=Ue(k,Ze);if(!b)return null;var N=function(S,v){return{x:S.x,y:S.y,value:S.value,errorVal:Ce(S.payload,v)}},h={clipPath:n?"url(#clipPath-".concat(l,")"):null};return R.createElement(ie,h,b.map(function(x){return R.cloneElement(x,{key:"bar-".concat(x.props.dataKey),data:o,xAxis:c,yAxis:m,layout:g,dataPointFormatter:N})}))}},{key:"renderDots",value:function(n,l,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var c=this.props,m=c.dot,g=c.points,k=c.dataKey,b=te(this.props,!1),N=te(m,!0),h=g.map(function(S,v){var p=$($($({key:"dot-".concat(v),r:3},b),N),{},{index:v,cx:S.x,cy:S.y,value:S.value,dataKey:k,payload:S.payload,points:g});return r.renderDotItem(m,p)}),x={clipPath:n?"url(#clipPath-".concat(l?"":"dots-").concat(i,")"):null};return R.createElement(ie,J({className:"recharts-line-dots",key:"dots"},x),h)}},{key:"renderCurveStatically",value:function(n,l,i,o){var c=this.props,m=c.type,g=c.layout,k=c.connectNulls;c.ref;var b=Ne(c,it),N=$($($({},te(b,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:l?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:m,layout:g,connectNulls:k});return R.createElement(Xe,J({},N,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,l){var i=this,o=this.props,c=o.points,m=o.strokeDasharray,g=o.isAnimationActive,k=o.animationBegin,b=o.animationDuration,N=o.animationEasing,h=o.animationId,x=o.animateNewValues,S=o.width,v=o.height,p=this.state,_=p.prevPoints,A=p.totalLength;return R.createElement(qe,{begin:k,duration:b,isActive:g,easing:N,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(E){var y=E.t;if(_){var j=_.length/c.length,C=c.map(function(L,z){var Y=Math.floor(z*j);if(_[Y]){var D=_[Y],F=q(D.x,L.x),re=q(D.y,L.y);return $($({},L),{},{x:F(y),y:re(y)})}if(x){var ee=q(S*2,L.x),se=q(v/2,L.y);return $($({},L),{},{x:ee(y),y:se(y)})}return $($({},L),{},{x:L.x,y:L.y})});return i.renderCurveStatically(C,n,l)}var O=q(0,A),T=O(y),W;if(m){var K="".concat(m).split(/[,\s]+/gim).map(function(L){return parseFloat(L)});W=i.getStrokeDasharray(T,A,K)}else W=i.generateSimpleStrokeDasharray(A,T);return i.renderCurveStatically(c,n,l,{strokeDasharray:W})})}},{key:"renderCurve",value:function(n,l){var i=this.props,o=i.points,c=i.isAnimationActive,m=this.state,g=m.prevPoints,k=m.totalLength;return c&&o&&o.length&&(!g&&k>0||!Je(g,o))?this.renderCurveWithAnimation(n,l):this.renderCurveStatically(o,n,l)}},{key:"render",value:function(){var n,l=this.props,i=l.hide,o=l.dot,c=l.points,m=l.className,g=l.xAxis,k=l.yAxis,b=l.top,N=l.left,h=l.width,x=l.height,S=l.isAnimationActive,v=l.id;if(i||!c||!c.length)return null;var p=this.state.isAnimationFinished,_=c.length===1,A=ve("recharts-line",m),E=g&&g.allowDataOverflow,y=k&&k.allowDataOverflow,j=E||y,C=de(v)?this.id:v,O=(n=te(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},T=O.r,W=T===void 0?3:T,K=O.strokeWidth,L=K===void 0?2:K,z=Qe(o)?o:{},Y=z.clipDot,D=Y===void 0?!0:Y,F=W*2+L;return R.createElement(ie,{className:A},E||y?R.createElement("defs",null,R.createElement("clipPath",{id:"clipPath-".concat(C)},R.createElement("rect",{x:E?N:N-h/2,y:y?b:b-x/2,width:E?h:h*2,height:y?x:x*2})),!D&&R.createElement("clipPath",{id:"clipPath-dots-".concat(C)},R.createElement("rect",{x:N-F/2,y:b-F/2,width:h+F,height:x+F}))):null,!_&&this.renderCurve(j,C),this.renderErrorBar(j,C),(_||o)&&this.renderDots(j,D,C),(!S||p)&&et.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,l){return n.animationId!==l.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:l.curPoints}:n.points!==l.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,l){for(var i=n.length%2!==0?[].concat(Z(n),[0]):n,o=[],c=0;c<l;++c)o=[].concat(Z(o),Z(i));return o}},{key:"renderDotItem",value:function(n,l){var i;if(R.isValidElement(n))i=R.cloneElement(n,l);else if(Ge(n))i=n(l);else{var o=l.key,c=Ne(l,ct),m=ve("recharts-line-dot",typeof n!="boolean"?n.className:"");i=R.createElement(Ke,J({key:o},c,{className:m}))}return i}}])}(u.PureComponent);B(Q,"displayName","Line");B(Q,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!at.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});B(Q,"getComposedData",function(t){var r=t.props,s=t.xAxis,n=t.yAxis,l=t.xAxisTicks,i=t.yAxisTicks,o=t.dataKey,c=t.bandSize,m=t.displayedData,g=t.offset,k=r.layout,b=m.map(function(N,h){var x=Ce(N,o);return k==="horizontal"?{x:be({axis:s,ticks:l,bandSize:c,entry:N,index:h}),y:de(x)?null:n.scale(x),value:x,payload:N}:{x:de(x)?null:s.scale(x),y:be({axis:n,ticks:i,bandSize:c,entry:N,index:h}),value:x,payload:N}});return $({points:b,layout:k},g)});var kt=rt({chartName:"LineChart",GraphicalChild:Q,axisComponents:[{axisType:"xAxis",AxisComp:ue},{axisType:"yAxis",AxisComp:me}],formatAxisMap:st});function Nt({run:t,onSave:r,onClose:s}){var y;const[n,l]=u.useState(String(t.distance_miles||"")),[i,o]=u.useState(he(t.duration_seconds)),[c,m]=u.useState(t.duration_seconds||0),[g,k]=u.useState(t.date||((y=t.created_at)==null?void 0:y.slice(0,10))||""),[b,N]=u.useState(t.notes||""),[h,x]=u.useState(t.perceived_effort||5),[S,v]=u.useState(""),[p,_]=u.useState(!1),A=()=>{const j=Ve(i);j?(m(j),o(he(j)),v("")):i&&v('Could not understand that duration. Try "45:00" or "1 hour 30 minutes"')},E=async()=>{var j,C;_(!0),v("");try{const O=await I.put(`/runs/${t.id}`,{date:g,distance_miles:Number(n),duration_seconds:c,notes:b,perceived_effort:h});r(O.data)}catch(O){v(((C=(j=O==null?void 0:O.response)==null?void 0:j.data)==null?void 0:C.error)||"Could not save.")}finally{_(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/70",onClick:j=>j.target===j.currentTarget&&s(),children:e.jsxs("div",{className:"w-full max-w-lg rounded-t-2xl p-5 space-y-3",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-bold text-lg",style:{color:"var(--text-primary)"},children:"Edit Run"}),e.jsx("button",{onClick:s,className:"text-sm px-3 py-1 rounded-lg",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:"Cancel"})]}),[["Distance (miles)",n,l,"decimal-pad"],["Date (YYYY-MM-DD)",g,k,"default"]].map(([j,C,O,T])=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:j}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:C,onChange:W=>O(W.target.value),inputMode:T==="decimal-pad"?"decimal":void 0})]},j)),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Duration (any format)"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:i,onChange:j=>o(j.target.value),onBlur:A,placeholder:"e.g. 2 hours 45 minutes, 45:30, 1h30m"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs mb-2 block",style:{color:"var(--text-muted)"},children:["Effort: ",h,"/10"]}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5,6,7,8,9,10].map(j=>e.jsx("button",{onClick:()=>x(j),className:"flex-1 h-8 rounded text-xs font-bold",style:{background:j<=h?"var(--accent)":"var(--bg-input)",color:j<=h?"#000":"var(--text-muted)"},children:j},j))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Notes"}),e.jsx("textarea",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none resize-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:b,onChange:j=>N(j.target.value),rows:2})]}),S&&e.jsx("p",{className:"text-xs",style:{color:"#ef4444"},children:S}),e.jsx("button",{onClick:E,disabled:p,className:"w-full py-4 rounded-xl font-black text-black text-base",style:{background:"var(--accent)",opacity:p?.6:1},children:p?"Saving...":"Save Changes"})]})})}function St({lift:t,onSave:r,onClose:s}){var E;const[n,l]=u.useState(t.exercise_name||""),[i,o]=u.useState(String(t.sets??"")),[c,m]=u.useState(String(t.reps??"")),[g,k]=u.useState(String(t.weight_lbs??"")),[b,N]=u.useState(t.date||((E=t.created_at)==null?void 0:E.slice(0,10))||""),[h,x]=u.useState(t.notes||""),[S,v]=u.useState(""),[p,_]=u.useState(!1),A=async()=>{var y,j;_(!0),v("");try{const C=await I.put(`/lifts/${t.id}`,{exercise_name:n,sets:i===""?null:Number(i),reps:c===""?null:Number(c),weight_lbs:g===""?null:Number(g),date:b,notes:h});r(C.data)}catch(C){v(((j=(y=C==null?void 0:C.response)==null?void 0:y.data)==null?void 0:j.error)||"Could not save.")}finally{_(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/70",onClick:y=>y.target===y.currentTarget&&s(),children:e.jsxs("div",{className:"w-full max-w-lg rounded-t-2xl p-5 space-y-3",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-bold text-lg",style:{color:"var(--text-primary)"},children:"Edit Lift"}),e.jsx("button",{onClick:s,className:"text-sm px-3 py-1 rounded-lg",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:"Cancel"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Exercise"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:n,onChange:y=>l(y.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Sets"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:i,onChange:y=>o(y.target.value),inputMode:"numeric"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Reps"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:c,onChange:y=>m(y.target.value),inputMode:"numeric"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Weight"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:g,onChange:y=>k(y.target.value),inputMode:"decimal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Date (YYYY-MM-DD)"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:b,onChange:y=>N(y.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Notes"}),e.jsx("textarea",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none resize-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:h,onChange:y=>x(y.target.value),rows:2})]}),S&&e.jsx("p",{className:"text-xs",style:{color:"#ef4444"},children:S}),e.jsx("button",{onClick:A,disabled:p,className:"w-full py-4 rounded-xl font-black text-black text-base",style:{background:"var(--accent)",opacity:p?.6:1},children:p?"Saving...":"Save Changes"})]})})}const wt=[{value:"tired",label:"Tired / needed rest"},{value:"no_time",label:"No time"},{value:"didnt_feel_like_it",label:"Didn't feel like it"},{value:"something_came_up",label:"Something came up"},{value:"weather",label:"Weather"},{value:"sick",label:"Sick / injured"}];function _t({onClose:t}){const[r,s]=u.useState(""),[n,l]=u.useState(""),[i,o]=u.useState(!1),c=async()=>{if(r){o(!0);try{const m=await I.post("/runs/missed",{reason:r,scheduled_date:new Date().toISOString().slice(0,10)});l(m.data.message)}catch{}finally{o(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/70",onClick:m=>m.target===m.currentTarget&&t(),children:e.jsx("div",{className:"w-full max-w-lg rounded-t-2xl p-5 space-y-3",style:{background:"var(--bg-card)"},children:n?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-base leading-relaxed",style:{color:"var(--text-primary)"},children:n}),e.jsx("button",{onClick:t,className:"w-full py-4 rounded-xl font-black text-black",style:{background:"var(--accent)"},children:"Got it"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-bold text-lg",style:{color:"var(--text-primary)"},children:"What happened?"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"No judgment — I'll adjust your plan."}),e.jsx("div",{className:"space-y-2",children:wt.map(m=>e.jsx("button",{onClick:()=>s(m.value),className:"w-full p-3 rounded-xl text-left border text-sm font-medium",style:{background:r===m.value?"var(--accent-dim)":"var(--bg-input)",borderColor:r===m.value?"var(--accent)":"var(--border-subtle)",color:"var(--text-primary)"},children:m.label},m.value))}),e.jsx("button",{onClick:c,disabled:!r||i,className:"w-full py-4 rounded-xl font-black text-black",style:{background:r?"var(--accent)":"var(--bg-input)",opacity:i?.6:1},children:i?"Adjusting...":"Update My Plan"})]})})})}function At(t=0){const r=Math.floor(t/3600),s=Math.floor(t%3600/60),n=t%60;return r>0?`${r}h ${s}m`:s>0&&n>0?`${s}m ${n}s`:`${s}m`}function Dt(t,r){if(!t||!r)return"--";const s=t/60/r,n=Math.floor(s),l=Math.round((s-n)*60);return`${n}:${String(l).padStart(2,"0")} /mi`}const Ct=["","Very Easy","Easy","Easy-Moderate","Moderate","Moderate-Hard","Hard","Hard","Very Hard","Very Hard","Max"],_e=[{key:"Z1",min:.5,max:.6,name:"Recovery",color:"#6B7280"},{key:"Z2",min:.6,max:.7,name:"Aerobic Base",color:"#3B82F6"},{key:"Z3",min:.7,max:.8,name:"Tempo",color:"#22C55E"},{key:"Z4",min:.8,max:.9,name:"Threshold",color:"#EAB308"},{key:"Z5",min:.9,max:1.01,name:"Max Effort",color:"#EF4444"}];function Pt({run:t,onClose:r,onFeedbackGenerated:s}){const[n,l]=u.useState(t.ai_feedback||""),[i,o]=u.useState(!1),[c,m]=u.useState(""),g=async()=>{var v,p;o(!0),m("");try{const _=await I.post(`/runs/${t.id}/feedback`);l(_.data.feedback),s&&s(t.id,_.data.feedback)}catch(_){m(((p=(v=_.response)==null?void 0:v.data)==null?void 0:p.error)||"Could not generate feedback.")}finally{o(!1)}},k=new Date(t.date||t.created_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),b=t.avg_hr||t.avg_heart_rate||null,N=t.max_heart_rate||190,h=b&&N?b/N:null,x=h?_e.find(v=>h>=v.min&&h<v.max)||_e[4]:null,S=[{label:"Distance",value:t.distance_miles?`${Number(t.distance_miles).toFixed(2)} mi`:"--"},{label:"Duration",value:t.duration_seconds?At(t.duration_seconds):"--"},{label:"Pace",value:Dt(t.duration_seconds,t.distance_miles)},{label:"Calories",value:t.calories?`${t.calories} cal`:"--"},{label:"Effort",value:t.perceived_effort?`${t.perceived_effort}/10 - ${Ct[t.perceived_effort]||""}`:"--"},{label:"Surface",value:t.surface||t.run_type||"--"}];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{background:"rgba(0,0,0,0.7)"},onClick:r,children:e.jsxs("div",{className:"w-full rounded-t-2xl p-6 pb-10 max-h-[85vh] overflow-y-auto",style:{background:"var(--bg-card)"},onClick:v=>v.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Run Detail"}),e.jsx("button",{onClick:r,children:e.jsx(Ae,{size:20,style:{color:"var(--text-muted)"}})})]}),e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:k}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mb-5",children:S.map(({label:v,value:p})=>e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:v}),e.jsx("p",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:p})]},v))}),x&&e.jsxs("div",{className:"rounded-xl p-3 mb-5",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Heart Rate Zone"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:[b," bpm"]}),e.jsxs("span",{className:"rounded-full px-2 py-1 text-xs",style:{background:`${x.color}22`,color:x.color},children:[x.key," · ",x.name]})]}),e.jsx("div",{className:"mt-2 h-1.5 rounded-full",style:{background:"var(--bg-base)"},children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,h*100)}%`,background:x.color}})})]}),t.notes&&e.jsxs("div",{className:"rounded-xl p-3 mb-5",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Notes"}),e.jsxs("p",{className:"text-sm italic",style:{color:"var(--text-primary)"},children:['"',t.notes,'"']})]}),e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(De,{size:16,style:{color:"var(--accent)"}}),e.jsx("span",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:"AI Coach Feedback"})]}),n?e.jsx("p",{className:"text-sm leading-relaxed",style:{color:"var(--text-muted)"},children:n}):e.jsxs(e.Fragment,{children:[c&&e.jsx("p",{className:"text-xs mb-2",style:{color:"#ef4444"},children:c}),e.jsx("button",{onClick:g,disabled:i,className:"w-full py-2.5 rounded-xl text-sm font-semibold",style:{background:"var(--accent)",color:"#000"},children:i?"Analyzing your run...":"Get AI Feedback"})]})]})]})})}function Et(t=0){const r=Math.floor(t/3600),s=Math.floor(t%3600/60);return r>0?`${r}h ${s}m`:`${s}m`}function Lt({session:t,onClose:r,onFeedbackGenerated:s}){const[n,l]=u.useState([]),[i,o]=u.useState(!0),[c,m]=u.useState(t.ai_feedback||""),[g,k]=u.useState(!1),[b,N]=u.useState("");u.useEffect(()=>{I.get(`/workouts/${t.id}/sets`).then(p=>{l(p.data.sets||[]),o(!1)}).catch(()=>o(!1))},[t.id]);const h=async()=>{var p,_;k(!0),N("");try{const A=await I.post(`/workouts/${t.id}/feedback`);m(A.data.feedback),s&&s(t.id,A.data.feedback)}catch(A){N(((_=(p=A.response)==null?void 0:p.data)==null?void 0:_.error)||"Could not generate feedback.")}finally{k(!1)}},x={};for(const p of n)x[p.exercise_name]||(x[p.exercise_name]=[]),x[p.exercise_name].push(p);const S=new Date(t.started_at||t.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),v=Array.isArray(t.muscle_groups)?t.muscle_groups:[];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{background:"rgba(0,0,0,0.7)"},onClick:r,children:e.jsxs("div",{className:"w-full rounded-t-2xl p-6 pb-10 max-h-[85vh] overflow-y-auto",style:{background:"var(--bg-card)"},onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Workout Detail"}),e.jsx("button",{onClick:r,children:e.jsx(Ae,{size:20,style:{color:"var(--text-muted)"}})})]}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:S}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-5",children:[e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Duration"}),e.jsx("p",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:t.total_seconds?Et(t.total_seconds):"--"})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Total Sets"}),e.jsx("p",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:n.length})]})]}),v.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-5",children:v.map(p=>e.jsx("span",{className:"rounded-full px-3 py-1 text-xs font-semibold capitalize",style:{background:"var(--accent-dim)",color:"var(--accent)"},children:p},p))}),i?e.jsx("p",{className:"text-sm text-center py-4",style:{color:"var(--text-muted)"},children:"Loading sets..."}):Object.keys(x).length>0?e.jsx("div",{className:"space-y-4 mb-5",children:Object.entries(x).map(([p,_])=>e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"font-semibold text-sm mb-3",style:{color:"var(--text-primary)"},children:p}),e.jsx("div",{className:"space-y-2",children:_.map((A,E)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:["Set ",A.set_number||E+1]}),e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:[A.reps?`${A.reps} reps`:"--",A.weight_lbs?` @ ${A.weight_lbs} lbs`:""]})]},E))})]},p))}):e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:"No set data recorded for this session."}),t.notes&&e.jsxs("div",{className:"rounded-xl p-3 mb-5",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Notes"}),e.jsxs("p",{className:"text-sm italic",style:{color:"var(--text-primary)"},children:['"',t.notes,'"']})]}),e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(De,{size:16,style:{color:"var(--accent)"}}),e.jsx("span",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:"AI Coach Feedback"})]}),c?e.jsx("p",{className:"text-sm leading-relaxed",style:{color:"var(--text-muted)"},children:c}):e.jsxs(e.Fragment,{children:[b&&e.jsx("p",{className:"text-xs mb-2",style:{color:"#ef4444"},children:b}),e.jsx("button",{onClick:h,disabled:g,className:"w-full py-2.5 rounded-xl text-sm font-semibold",style:{background:"var(--accent)",color:"#000"},children:g?"Analyzing your workout...":"Get AI Feedback"})]})]})]})})}function ce(t){var r;return t.date||((r=t.created_at)==null?void 0:r.slice(0,10))||""}function Ot(t=0){const r=Math.floor(t/60),s=t%60;return`${r}:${String(s).padStart(2,"0")}`}function Rt(t=0){const r=Math.floor(t/3600),s=Math.floor(t%3600/60);return r>0?`${r}h ${s}m`:`${s}m`}function Wt(){const t=Be(),{fmt:r}=We(),{t:s,i18n:n}=Ye(),[l,i]=u.useState(!0),[o,c]=u.useState("all"),[m,g]=u.useState("all"),[k,b]=u.useState([]),[N,h]=u.useState([]),[x,S]=u.useState([]),[v,p]=u.useState([]),[_,A]=u.useState(null),[E,y]=u.useState(null),[j,C]=u.useState(null),[O,T]=u.useState(null),[W,K]=u.useState(!1),L=new Date().getFullYear(),[z,Y]=u.useState(null),[D,F]=u.useState({from:"",to:""}),[re,ee]=u.useState(!1);u.useEffect(()=>{(async()=>{var a,d,f,w;try{const[P,M,U,ze]=await Promise.all([I.get("/runs"),I.get("/lifts"),I.get("/workouts").catch(()=>({data:{sessions:[]}})),I.get("/races").catch(()=>({data:{races:[]}}))]);b([...Array.isArray(P.data)?P.data:((a=P.data)==null?void 0:a.runs)||[]].sort((H,G)=>ce(G).localeCompare(ce(H)))),h([...Array.isArray(M.data)?M.data:((d=M.data)==null?void 0:d.lifts)||[]].sort((H,G)=>(G.date||G.created_at||"").localeCompare(H.date||H.created_at||""))),S([...((f=U.data)==null?void 0:f.sessions)||[]].sort((H,G)=>(G.started_at||"").localeCompare(H.started_at||""))),p([...((w=ze.data)==null?void 0:w.races)||[]].sort((H,G)=>(G.race_date||"").localeCompare(H.race_date||"")))}finally{i(!1)}})()},[]),u.useEffect(()=>{if(!l){const a=new URLSearchParams(t.search),d=a.get("runId"),f=a.get("workoutId");if(d){const w=k.find(P=>P.id===d);w&&C(w)}if(f){const w=x.find(P=>P.id===f);w&&T(w)}}},[l,t.search,k,x]);const se=async(a,d)=>{d.stopPropagation(),confirm("Delete this run?")&&(await I.delete(`/runs/${a}`),b(f=>f.filter(w=>w.id!==a)))},Le=async(a,d)=>{d.stopPropagation(),confirm("Delete this lift?")&&(await I.delete(`/lifts/${a}`),h(f=>f.filter(w=>w.id!==a)))},Oe=a=>{b(d=>d.map(f=>f.id===a.id?{...f,...a}:f)),A(null)},Re=a=>{h(d=>d.map(f=>f.id===a.id?{...f,...a}:f)),y(null)},ne=(a,d)=>{if(D.from||D.to)return a.filter(P=>{const M=(P[d]||P.created_at||"").slice(0,10);return!(D.from&&M<D.from||D.to&&M>D.to)});if(z)return a.filter(P=>(P[d]||P.created_at||"").slice(0,10).startsWith(String(z)));if(m==="all")return a;const f={week:7,month:30,year:365}[m],w=new Date(Date.now()-f*864e5).toISOString().slice(0,10);return a.filter(P=>(P[d]||P.created_at||"").slice(0,10)>=w)},V=ne(k,"date"),oe=ne(N,"date"),le=ne(x,"started_at"),Me=u.useMemo(()=>V.reduce((a,d)=>a+Number(d.distance_miles||0),0),[V]),$e=u.useMemo(()=>{const a=V.filter(f=>f.distance_miles&&f.duration_seconds);if(!a.length)return"--";const d=a.reduce((f,w)=>f+w.duration_seconds/w.distance_miles,0)/a.length;return r.pace(d)},[V,r]),Ie=u.useMemo(()=>{const a=[];for(let d=7;d>=0;d-=1){const f=new Date;f.setDate(f.getDate()-d*7);const w=new Date(f);w.setDate(w.getDate()+6);const P=k.filter(M=>{const U=new Date((M.date||M.created_at||"")+"T12:00:00");return U>=f&&U<=w}).reduce((M,U)=>M+Number(U.distance_miles||0),0);a.push({week:`${f.getMonth()+1}/${f.getDate()}`,miles:Number(P.toFixed(1))})}return a},[k]),Te=u.useMemo(()=>V.slice(0,20).reverse().map((a,d)=>({idx:d+1,pace:a.distance_miles?Number((a.duration_seconds/60/a.distance_miles).toFixed(2)):0})).filter(a=>a.pace>0),[V]);return l?e.jsx(He,{message:"Loading history"}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 grid grid-cols-3 gap-2",children:[["Distance",r.distance(Me,1)],["Avg Pace",$e],["Lifts",`${oe.length+le.length}`]].map(([a,d])=>e.jsxs("div",{className:"rounded-xl p-3 text-center",style:{background:"var(--bg-card)"},children:[e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.7},children:a}),e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:d})]},a))}),e.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[e.jsx(fe,{to:"/recap",style:{display:"inline-flex",alignItems:"center",gap:6,padding:"8px 16px",borderRadius:20,background:"#EAB308",color:"#000",fontWeight:700,fontSize:13,textDecoration:"none"},children:"Weekly Recap"}),e.jsx(fe,{to:"/journal",className:"text-sm",style:{color:"var(--accent)"},children:"View Journal"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 mb-4",children:[e.jsx("div",{className:"rounded-xl p-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:e.jsx("div",{style:{width:"100%",height:180},children:e.jsx(ye,{children:e.jsxs(nt,{data:Ie,children:[e.jsx(ue,{dataKey:"week",stroke:"#fff",tick:{fontSize:10}}),e.jsx(me,{stroke:"#fff",tick:{fontSize:10}}),e.jsx(ge,{}),e.jsx(ot,{dataKey:"miles",fill:"#EAB308"})]})})})}),e.jsx("div",{className:"rounded-xl p-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:e.jsx("div",{style:{width:"100%",height:180},children:e.jsx(ye,{children:e.jsxs(kt,{data:Te,children:[e.jsx(ue,{dataKey:"idx",stroke:"#fff",tick:{fontSize:10}}),e.jsx(me,{stroke:"#fff",tick:{fontSize:10}}),e.jsx(ge,{}),e.jsx(Q,{type:"monotone",dataKey:"pace",stroke:"#EAB308",strokeWidth:2,dot:!1})]})})})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{style:{display:"flex",gap:8,overflowX:"auto",paddingBottom:4,marginBottom:12},children:[Array.from({length:1},(a,d)=>L-d).map(a=>e.jsx("button",{onClick:()=>{Y(z===a?null:a),F({from:"",to:""})},style:{flexShrink:0,padding:"6px 16px",borderRadius:20,border:`1.5px solid ${z===a?"var(--accent)":"var(--border-subtle)"}`,background:z===a?"var(--accent)":"var(--bg-input)",color:z===a?"black":"var(--text-muted)",fontWeight:700,fontSize:13,cursor:"pointer",whiteSpace:"nowrap"},children:a},a)),e.jsx("button",{onClick:()=>{ee(a=>!a),Y(null)},style:{flexShrink:0,padding:"6px 14px",borderRadius:20,border:`1.5px solid ${D.from||D.to?"var(--accent)":"var(--border-subtle)"}`,background:D.from||D.to?"var(--accent-dim)":"var(--bg-input)",color:D.from||D.to?"var(--accent)":"var(--text-muted)",fontWeight:700,fontSize:13,cursor:"pointer",whiteSpace:"nowrap"},children:"Custom Range"})]}),re&&e.jsxs("div",{className:"rounded-xl p-4 mb-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-xs font-semibold mb-3",style:{color:"var(--text-muted)"},children:"Custom Date Range"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"From"}),e.jsx("input",{type:"date",value:D.from,min:`${L-5}-01-01`,max:new Date().toISOString().slice(0,10),onChange:a=>F(d=>({...d,from:a.target.value})),style:{width:"100%",background:"var(--bg-input)",border:"1px solid var(--border-subtle)",borderRadius:8,padding:"8px 10px",color:"var(--text-primary)",fontSize:13}})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"To"}),e.jsx("input",{type:"date",value:D.to,min:`${L-5}-01-01`,max:new Date().toISOString().slice(0,10),onChange:a=>F(d=>({...d,to:a.target.value})),style:{width:"100%",background:"var(--bg-input)",border:"1px solid var(--border-subtle)",borderRadius:8,padding:"8px 10px",color:"var(--text-primary)",fontSize:13}})]})]}),(D.from||D.to)&&e.jsx("button",{onClick:()=>{F({from:"",to:""}),ee(!1)},className:"mt-3 text-xs",style:{color:"var(--text-muted)"},children:"Clear"})]})]}),e.jsx("div",{className:"mb-4 flex rounded-xl overflow-hidden border",style:{borderColor:"var(--border-subtle)",opacity:z||D.from||D.to?.4:1},children:["week","month","year","all"].map(a=>e.jsx("button",{onClick:()=>g(a),className:"flex-1 py-2 text-xs font-semibold uppercase",style:m===a?{background:"var(--accent)",color:"black"}:{background:"var(--bg-input)",color:"var(--text-muted)"},children:a==="week"?"W":a==="month"?"M":a==="year"?"Y":"All"},a))}),e.jsx("div",{className:"mb-4 flex border-b",style:{borderColor:"var(--border-subtle)"},children:[["all","All"],["runs",s("history.runs")],["lifts",s("history.workouts")],["races",s("history.races")]].map(([a,d])=>e.jsx("button",{onClick:()=>c(a),className:"px-4 py-2 text-sm font-medium border-b-2",style:o===a?{borderColor:"var(--accent)",color:"var(--text-primary)"}:{borderColor:"transparent",color:"var(--text-muted)"},children:d},a))}),(o==="all"||o==="runs")&&e.jsxs("div",{className:"space-y-3 mb-3",children:[V.map(a=>e.jsxs("div",{onClick:()=>C(a),className:"cursor-pointer rounded-xl p-4",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:new Date(ce(a)).toLocaleDateString()}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.perceived_effort?e.jsxs("span",{className:"rounded-full px-2 py-1 text-xs",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:["Effort ",a.perceived_effort,"/10"]}):null,e.jsx("button",{onClick:d=>{d.stopPropagation(),A(a)},className:"transition-colors",style:{color:"var(--text-muted)"},children:e.jsx(je,{size:14})}),e.jsx("button",{onClick:d=>se(a.id,d),className:"transition-colors",style:{color:"var(--text-muted)"},children:e.jsx(ke,{size:14})})]})]}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:[r.distance(Number(a.distance_miles||0),2)," · ",Ot(a.duration_seconds)," · ",r.pace(a.duration_seconds/a.distance_miles),(a.calories_burned||a.calories)>0&&e.jsxs("span",{children:[" · ",a.calories_burned||a.calories," cal"]})]}),a.notes&&e.jsxs("p",{className:"mt-1 text-xs italic",style:{color:"var(--text-muted)",opacity:.7},children:['"',a.notes,'"']})]},a.id)),V.length===0&&o!=="lifts"&&e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("img",{src:"/icon.svg",alt:"FORGE",className:"w-24 h-24 object-contain opacity-20"}),e.jsx("p",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:s("history.noRuns")}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Lace up and log your next run."})]}),e.jsx("button",{onClick:()=>K(!0),className:"w-full py-3 rounded-xl text-sm mt-2",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:"Miss a workout? Let me know - I'll adjust your plan"})]}),(o==="all"||o==="lifts")&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:[s("history.workouts")," & ",s("history.races")]}),le.map(a=>e.jsxs("div",{onClick:()=>T(a),className:"cursor-pointer rounded-xl p-4",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:new Date(a.started_at||a.created_at).toLocaleDateString()}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"View Details"})]}),e.jsxs("p",{className:"mt-1 text-sm",style:{color:"var(--text-primary)"},children:["Duration: ",a.total_seconds?Rt(a.total_seconds):"--",a.calories_burned>0&&e.jsxs("span",{children:[" · ",a.calories_burned," cal"]})]}),Array.isArray(a.muscle_groups)&&a.muscle_groups.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:a.muscle_groups.map(d=>e.jsx("span",{className:"rounded-full px-2 py-1 text-xs capitalize",style:{background:"var(--accent-dim)",color:"var(--accent)"},children:d},d))})]},a.id)),oe.map(a=>{let d=[];try{d=Array.isArray(a.muscle_groups)?a.muscle_groups:JSON.parse(a.muscle_groups||"[]")}catch{d=[]}return e.jsxs("div",{className:"cursor-pointer rounded-xl p-4",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:new Date(a.date||a.created_at).toLocaleDateString()}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:f=>{f.stopPropagation(),y(a)},className:"transition-colors",style:{color:"var(--text-muted)"},children:e.jsx(je,{size:14})}),e.jsx("button",{onClick:f=>Le(a.id,f),className:"transition-colors",style:{color:"var(--text-muted)"},children:e.jsx(ke,{size:14})})]})]}),e.jsx("p",{className:"mt-1 font-semibold",style:{color:"var(--text-primary)"},children:a.exercise_name}),e.jsxs("p",{className:"mt-1 text-sm",style:{color:"var(--text-muted)"},children:[a.sets," × ",a.reps," @ ",a.weight_lbs," lbs"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:d.map(f=>e.jsx("span",{className:"rounded-full px-2 py-1 text-xs capitalize",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:f},f))})]},a.id)}),oe.length===0&&le.length===0&&o!=="runs"&&e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("img",{src:"/icon.svg",alt:"FORGE",className:"w-24 h-24 object-contain opacity-20"}),e.jsx("p",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:"No lifts recorded for this period."}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Hit the weights."})]})]}),(o==="all"||o==="races")&&e.jsxs("div",{className:"space-y-3",children:[v.length===0?e.jsx("p",{className:"text-center py-8",style:{color:"var(--text-muted)",fontSize:14},children:s("history.noRaces")}):v.map(a=>e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",style:{color:"var(--text-primary)"},children:a.race_name}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[a.race_date," · ",a.distance_miles," mi",a.location?` · ${a.location}`:""]})]}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-semibold",style:{background:a.status==="completed"?"rgba(34,197,94,0.15)":"rgba(234,179,8,0.15)",color:a.status==="completed"?"#22c55e":"#EAB308"},children:a.status||"upcoming"})]}),a.goal_time_seconds&&e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:["Goal: ",Math.floor(a.goal_time_seconds/3600)>0?`${Math.floor(a.goal_time_seconds/3600)}h `:"",Math.floor(a.goal_time_seconds%3600/60),":",String(a.goal_time_seconds%60).padStart(2,"0")]})]},a.id)),e.jsx("button",{onClick:()=>window.location.href="/races",style:{width:"100%",padding:"10px 0",borderRadius:12,background:"var(--bg-input)",border:"1px solid var(--border-subtle)",color:"var(--text-muted)",fontSize:13,cursor:"pointer"},children:"+ Add Race"})]}),_&&e.jsx(Nt,{run:_,onSave:Oe,onClose:()=>A(null)}),E&&e.jsx(St,{lift:E,onSave:Re,onClose:()=>y(null)}),W&&e.jsx(_t,{onClose:()=>K(!1)}),j&&e.jsx(Pt,{run:j,onClose:()=>C(null),onFeedbackGenerated:(a,d)=>b(f=>f.map(w=>w.id===a?{...w,ai_feedback:d}:w))}),O&&e.jsx(Lt,{session:O,onClose:()=>T(null),onFeedbackGenerated:(a,d)=>S(f=>f.map(w=>w.id===a?{...w,ai_feedback:d}:w))})]})}export{Wt as default};
