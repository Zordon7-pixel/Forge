import{d as g,r as y,j as e,a as v}from"./index-xcBp2yTO.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],N=g("Copy",j);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],S=g("Share2",k);function C({open:r,loading:l,feedback:o,fallback:c,sessionId:d,onClose:n}){const[x,m]=y.useState(!1),[s,t]=y.useState(null),[i,p]=y.useState(!1);if(!r)return null;const h=async()=>{const a=o||c;if(!a)return;const b=[a.analysis,`Did well: ${a.didWell}`,`Next session: ${a.suggestion}`,`Recovery: ${a.recovery}`].filter(Boolean).join(`
`);m(!0),t(null);try{await v.post("/journal",{source:"ai_feedback",content:b,session_id:d||null}),p(!0),setTimeout(()=>p(!1),2e3)}catch(f){console.error("Failed to save to journal:",f),t("Could not save — try again")}finally{m(!1)}},u=o||c;return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{background:"rgba(0,0,0,0.6)"},onClick:n,children:e.jsxs("div",{className:"w-full rounded-t-2xl p-5",style:{background:"var(--bg-card)",borderTop:"1px solid var(--border-subtle)"},onClick:a=>a.stopPropagation(),children:[e.jsx("h3",{className:"text-lg font-bold mb-2",style:{color:"var(--text-primary)"},children:"AI Coach Feedback"}),l?e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Analyzing your session..."}):u?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:u.analysis}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Did well:"})," ",u.didWell]}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Next session:"})," ",u.suggestion]}),e.jsxs("p",{className:"text-sm",style:{color:"var(--accent)"},children:[e.jsx("strong",{children:"Recovery:"})," ",u.recovery]})]}):null,s&&e.jsx("p",{className:"text-xs mt-3",style:{color:"#ef4444"},children:s}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:n,className:"flex-1 rounded-xl py-2",style:{background:"var(--bg-input)",color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:"Dismiss"}),e.jsx("button",{onClick:h,disabled:x||i,className:"flex-1 rounded-xl py-2 font-semibold disabled:opacity-50",style:{background:i?"var(--bg-input)":"var(--accent)",color:i?"var(--text-muted)":"#000"},children:x?"Saving...":i?"Saved":"Save to Journal"})]})]})})}function E({workoutType:r="Workout",date:l,stats:o={},summaryText:c=""}){const d=y.useMemo(()=>{if(!l)return new Date().toLocaleDateString();const s=new Date(l);return Number.isNaN(s.getTime())?String(l):s.toLocaleDateString()},[l]),n=y.useMemo(()=>{if(c)return c;const s=Object.entries(o).filter(([,t])=>t!=null&&String(t)!=="").map(([t,i])=>`${t}: ${i}`).join(" | ");return`FORGE ${r} · ${d}${s?` · ${s}`:""}`},[c,r,d,o]),x=async()=>{try{await navigator.clipboard.writeText(n),window.alert("Workout summary copied")}catch{window.alert(n)}},m=async()=>{if(navigator.share)try{await navigator.share({title:`FORGE ${r}`,text:n});return}catch{}await x()};return e.jsxs("div",{className:"rounded-2xl p-4 space-y-3",style:{background:"#0f1117",border:"1px solid #2a2d3e"},children:[e.jsxs("div",{className:"rounded-xl p-4",style:{background:"#1a1d2e",border:"1px solid #2a2d3e"},children:[e.jsx("p",{className:"text-xs font-bold tracking-wide",style:{color:"#EAB308"},children:"FORGE"}),e.jsx("p",{className:"text-lg font-black mt-1",style:{color:"#ffffff"},children:r}),e.jsx("p",{className:"text-xs mt-1",style:{color:"#a1a1aa"},children:d}),e.jsx("div",{className:"grid grid-cols-2 gap-2 mt-3",children:Object.entries(o).map(([s,t])=>e.jsxs("div",{className:"rounded-lg p-2",style:{background:"#0f1117",border:"1px solid #2a2d3e"},children:[e.jsx("p",{className:"text-[10px] uppercase",style:{color:"#a1a1aa"},children:s}),e.jsx("p",{className:"text-sm font-bold",style:{color:"#EAB308"},children:t})]},s))})]}),e.jsx("p",{className:"text-xs",style:{color:"#a1a1aa"},children:"Screenshot this to share"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:x,className:"rounded-lg px-3 py-2 text-xs font-bold flex items-center gap-1",style:{background:"#1a1d2e",color:"#EAB308",border:"1px solid #2a2d3e"},children:[e.jsx(N,{size:14})," Copy Link"]}),e.jsxs("button",{onClick:m,className:"rounded-lg px-3 py-2 text-xs font-bold flex items-center gap-1",style:{background:"#EAB308",color:"#0f1117"},children:[e.jsx(S,{size:14})," Share"]})]})]})}export{C as A,E as W};
