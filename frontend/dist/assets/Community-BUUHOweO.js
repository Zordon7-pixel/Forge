import{r as x,j as e,a as p}from"./index-D4P1_Gkc.js";import{H as b}from"./heart-FKLNgysA.js";const f=["The body achieves what the mind believes.","Small daily progress creates big race-day results.","Discipline beats motivation on hard days.","One workout does not define you. Consistency does.","Show up today. Future you is watching."];function B(){const[t,l]=x.useState("feed");return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xl font-bold",style:{color:"var(--text-primary)"},children:"Community"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[{key:"feed",label:"Feed"},{key:"workouts",label:"Workouts"},{key:"routes",label:"Routes"}].map(o=>e.jsx("button",{onClick:()=>l(o.key),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:t===o.key?"var(--accent)":"var(--bg-input)",color:t===o.key?"#000":"var(--text-muted)"},children:o.label},o.key))}),t==="feed"?e.jsx(j,{}):t==="workouts"?e.jsx(k,{}):e.jsx(N,{})]})}function j(){const[t,l]=x.useState([]),[o,m]=x.useState([]);return x.useEffect(()=>{p.get("/community/posts").then(s=>{var n;return l(((n=s.data)==null?void 0:n.posts)||[])}).catch(()=>l([])),Promise.all([p.get("/runs").catch(()=>({data:{runs:[]}})),p.get("/workouts").catch(()=>({data:{sessions:[]}}))]).then(([s,n])=>{var d,u;const a=(((d=s.data)==null?void 0:d.runs)||[]).slice(0,3).map(i=>({id:`run-${i.id}`,title:`Run · ${Number(i.distance_miles||0).toFixed(2)} mi`,sub:i.date||i.created_at})),r=(((u=n.data)==null?void 0:u.sessions)||[]).slice(0,2).map(i=>({id:`lift-${i.id}`,title:`Lift · ${Math.round((i.total_seconds||0)/60)} min`,sub:i.started_at}));m([...a,...r])}).catch(()=>m([]))},[]),t.length===0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"rounded-xl p-4",style:{background:"#1a1d2e",border:"1px solid #2a2d3e"},children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"#EAB308"},children:"Inspiration Mode"}),e.jsx("div",{className:"space-y-2 mt-3",children:f.slice(0,4).map((s,n)=>e.jsxs("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:['"',s,'"']},n))}),e.jsx("button",{className:"mt-4 rounded-lg px-3 py-2 text-xs font-bold",style:{background:"#EAB308",color:"#0f1117"},children:"Be the first to share"})]}),e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:"Your Highlights"}),e.jsxs("div",{className:"space-y-2 mt-3",children:[o.map(s=>e.jsxs("div",{className:"rounded-lg p-2",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:s.title}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:new Date(s.sub).toLocaleDateString()})]},s.id)),o.length===0&&e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"No recent workouts yet."})]})]})]}):e.jsx("div",{className:"space-y-3",children:t.map(s=>e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:s.title}),s.body&&e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:s.body}),e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:["by ",s.user_name||"Athlete"," · ",new Date(s.created_at).toLocaleDateString()]})]},s.id))})}function k(){const[t,l]=x.useState("popular"),[o,m]=x.useState(""),[s,n]=x.useState([]);return x.useEffect(()=>{p.get("/community/workouts",{params:{sort:t,target:o||void 0}}).then(a=>{var r;return n(((r=a.data)==null?void 0:r.workouts)||[])}).catch(()=>n([]))},[t,o]),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[["popular","newest"].map(a=>e.jsx("button",{onClick:()=>l(a),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:t===a?"var(--accent)":"var(--bg-input)",color:t===a?"#000":"var(--text-muted)"},children:a==="popular"?"Popular":"Newest"},a)),e.jsx("input",{value:o,onChange:a=>m(a.target.value),placeholder:"By body part",className:"rounded-full px-3 py-1 text-xs",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"}})]}),s.map(a=>e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-card)"},children:[e.jsx("p",{className:"font-semibold",style:{color:"var(--text-primary)"},children:a.workout_name}),e.jsxs("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:[a.target," · Used ",a.usage_count||0," times"]}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:(a.main||[]).slice(0,2).map(r=>r.name||r).join(" · ")}),e.jsx("button",{onClick:()=>p.post(`/community/workouts/${a.id}/save`).catch(()=>{}),className:"mt-2 rounded-lg px-3 py-1.5 text-xs font-semibold",style:{background:"var(--accent)",color:"#000"},children:"Save to My Plan"})]},a.id)),s.length===0&&e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"No workouts found yet."})]})}function N(){const[t,l]=x.useState([]),[o,m]=x.useState("newest"),[s,n]=x.useState(!1);x.useEffect(()=>{n(!0),p.get("/routes",{params:{sort:o==="popular"?"popular":"newest"}}).then(r=>{var d;return l(((d=r.data)==null?void 0:d.routes)||[])}).catch(()=>l([])).finally(()=>n(!1))},[o]);const a=async r=>{try{const d=await p.post(`/routes/${r}/like`);l(u=>u.map(i=>{var h,y;return i.id===r?{...i,liked:(h=d.data)==null?void 0:h.liked,likes_count:((y=d.data)==null?void 0:y.likes_count)??i.likes_count}:i}))}catch(d){console.error("Failed to toggle like",d)}};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex gap-2",children:["newest","popular"].map(r=>e.jsx("button",{onClick:()=>m(r),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:o===r?"var(--accent)":"var(--bg-input)",color:o===r?"#000":"var(--text-muted)"},children:r==="newest"?"Newest":"Popular"},r))}),s&&e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Loading routes..."}),!s&&t.length===0&&e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"No shared routes yet. Be the first to post one!"}),t.map(r=>e.jsx(S,{route:r,onLike:a},r.id))]})}function S({route:t,onLike:l}){const o=m=>{if(!m)return"--";const s=Math.floor(m/60),n=Math.round(m%60);return`${s}:${String(n).padStart(2,"0")} /mi`};return e.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:16,padding:16,border:"1px solid var(--border-subtle)",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)",margin:0},children:t.title}),e.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"2px 0 0"},children:["by ",t.runner_name||"Athlete"," ",t.city?`· ${t.city}`:""]})]}),e.jsxs("button",{onClick:()=>l(t.id),style:{background:t.liked?"rgba(234,179,8,0.15)":"var(--bg-input)",border:`1px solid ${t.liked?"#EAB308":"var(--border-subtle)"}`,borderRadius:8,padding:"4px 10px",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[e.jsx(b,{size:14,color:t.liked?"#EAB308":"var(--text-muted)",fill:t.liked?"#EAB308":"none"}),e.jsx("span",{style:{fontSize:12,color:t.liked?"#EAB308":"var(--text-muted)"},children:t.likes_count})]})]}),e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:10},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:800,color:"var(--text-primary)",margin:0},children:Number(t.distance_miles||0).toFixed(2)}),e.jsx("p",{style:{fontSize:10,color:"var(--text-muted)",margin:0},children:"miles"})]}),t.avg_pace&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:800,color:"var(--text-primary)",margin:0},children:o(t.avg_pace)}),e.jsx("p",{style:{fontSize:10,color:"var(--text-muted)",margin:0},children:"avg pace"})]}),t.surface&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:14,fontWeight:600,color:"var(--text-muted)",margin:"4px 0 0",textTransform:"capitalize"},children:t.surface}),e.jsx("p",{style:{fontSize:10,color:"var(--text-muted)",margin:0},children:"surface"})]})]}),t.route_coords&&t.route_coords.length>=2&&e.jsx(w,{coords:t.route_coords})]})}function w({coords:t}){if(!t||t.length===0)return null;const l=t.map(c=>Array.isArray(c)?{lat:c[0],lon:c[1]}:{lat:Number(c.lat),lon:Number(c.lon)}),o=l.map(c=>c.lat),m=l.map(c=>c.lon),s=Math.min(...o),n=Math.max(...o),a=Math.min(...m),r=Math.max(...m),d=10,u=280,i=100,h=c=>d+(c-a)/(r-a||1)*(u-d*2),y=c=>d+(n-c)/(n-s||1)*(i-d*2),g=l.map((c,v)=>`${v===0?"M":"L"}${h(c.lon).toFixed(1)},${y(c.lat).toFixed(1)}`).join(" ");return e.jsx("div",{style:{borderRadius:10,overflow:"hidden",background:"#111",marginTop:8},children:e.jsxs("svg",{viewBox:`0 0 ${u} ${i}`,style:{width:"100%",height:100,display:"block"},children:[e.jsx("path",{d:g,fill:"none",stroke:"#EAB308",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:h(l[0].lon),cy:y(l[0].lat),r:"4",fill:"#22c55e"}),e.jsx("circle",{cx:h(l[l.length-1].lon),cy:y(l[l.length-1].lat),r:"4",fill:"#ef4444"})]})})}export{B as default};
