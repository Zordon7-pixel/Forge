import{d as Fe,R as $,r as d,j as e,a as z,e as Be,c as We,u as Ye,L as fe}from"./index-BY6vNrGT.js";import{f as he,p as Ve}from"./parseDuration-3bmQJghK.js";import{a as He}from"./validation-CCcprX5w.js";import{X as Ae}from"./x-BDpRvfbL.js";import{B as De}from"./brain-C5ul75pR.js";import{L as Ge}from"./LoadingRunner-e_BIMidb.js";import{b as Ke}from"./athleteLanguage-Bz0_Lcws.js";import{i as Ze,c as be,D as Ue,f as Xe,E as qe,L as ie,a as te,C as Je,A as Qe,b as q,d as et,e as de,h as tt,g as at,j as Ce,u as rt,G as st,k as ve,l as nt,X as ue,Y as me,m as ot,R as ye,B as lt,T as ge,n as it}from"./BarChart-DaUpfchP.js";import{P as je}from"./pencil-xhxwYFnI.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],ke=Fe("Trash2",ct);var dt=["type","layout","connectNulls","ref"],ut=["key"];function X(t){"@babel/helpers - typeof";return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},X(t)}function Ne(t,r){if(t==null)return{};var s=mt(t,r),n,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(l=0;l<i.length;l++)n=i[l],!(r.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(s[n]=t[n])}return s}function mt(t,r){if(t==null)return{};var s={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(r.indexOf(n)>=0)continue;s[n]=t[n]}return s}function J(){return J=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},J.apply(this,arguments)}function Se(t,r){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),s.push.apply(s,n)}return s}function T(t){for(var r=1;r<arguments.length;r++){var s=arguments[r]!=null?arguments[r]:{};r%2?Se(Object(s),!0).forEach(function(n){W(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):Se(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function U(t){return ht(t)||ft(t)||pt(t)||xt()}function xt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pt(t,r){if(t){if(typeof t=="string")return xe(t,r);var s=Object.prototype.toString.call(t).slice(8,-1);if(s==="Object"&&t.constructor&&(s=t.constructor.name),s==="Map"||s==="Set")return Array.from(t);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return xe(t,r)}}function ft(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ht(t){if(Array.isArray(t))return xe(t)}function xe(t,r){(r==null||r>t.length)&&(r=t.length);for(var s=0,n=new Array(r);s<r;s++)n[s]=t[s];return n}function bt(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function we(t,r){for(var s=0;s<r.length;s++){var n=r[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ee(n.key),n)}}function vt(t,r,s){return r&&we(t.prototype,r),s&&we(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t}function yt(t,r,s){return r=ae(r),gt(t,Pe()?Reflect.construct(r,s||[],ae(t).constructor):r.apply(t,s))}function gt(t,r){if(r&&(X(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jt(t)}function jt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Pe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Pe=function(){return!!t})()}function ae(t){return ae=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},ae(t)}function kt(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),r&&pe(t,r)}function pe(t,r){return pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,l){return n.__proto__=l,n},pe(t,r)}function W(t,r,s){return r=Ee(r),r in t?Object.defineProperty(t,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[r]=s,t}function Ee(t){var r=Nt(t,"string");return X(r)=="symbol"?r:r+""}function Nt(t,r){if(X(t)!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,r);if(X(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Q=function(t){function r(){var s;bt(this,r);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return s=yt(this,r,[].concat(l)),W(s,"state",{isAnimationFinished:!0,totalLength:0}),W(s,"generateSimpleStrokeDasharray",function(o,c){return"".concat(c,"px ").concat(o-c,"px")}),W(s,"getStrokeDasharray",function(o,c,m){var v=m.reduce(function(f,_){return f+_});if(!v)return s.generateSimpleStrokeDasharray(c,o);for(var N=Math.floor(o/v),y=o%v,S=c-o,h=[],p=0,w=0;p<m.length;w+=m[p],++p)if(w+m[p]>y){h=[].concat(U(m.slice(0,p)),[y-w]);break}var b=h.length%2===0?[0,S]:[S];return[].concat(U(r.repeat(m,N)),U(h),b).map(function(f){return"".concat(f,"px")}).join(", ")}),W(s,"id",rt("recharts-line-")),W(s,"pathRef",function(o){s.mainCurve=o}),W(s,"handleAnimationEnd",function(){s.setState({isAnimationFinished:!0}),s.props.onAnimationEnd&&s.props.onAnimationEnd()}),W(s,"handleAnimationStart",function(){s.setState({isAnimationFinished:!1}),s.props.onAnimationStart&&s.props.onAnimationStart()}),s}return kt(r,t),vt(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,l){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,c=i.xAxis,m=i.yAxis,v=i.layout,N=i.children,y=Xe(N,qe);if(!y)return null;var S=function(w,b){return{x:w.x,y:w.y,value:w.value,errorVal:Ce(w.payload,b)}},h={clipPath:n?"url(#clipPath-".concat(l,")"):null};return $.createElement(ie,h,y.map(function(p){return $.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:o,xAxis:c,yAxis:m,layout:v,dataPointFormatter:S})}))}},{key:"renderDots",value:function(n,l,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var c=this.props,m=c.dot,v=c.points,N=c.dataKey,y=te(this.props,!1),S=te(m,!0),h=v.map(function(w,b){var f=T(T(T({key:"dot-".concat(b),r:3},y),S),{},{index:b,cx:w.x,cy:w.y,value:w.value,dataKey:N,payload:w.payload,points:v});return r.renderDotItem(m,f)}),p={clipPath:n?"url(#clipPath-".concat(l?"":"dots-").concat(i,")"):null};return $.createElement(ie,J({className:"recharts-line-dots",key:"dots"},p),h)}},{key:"renderCurveStatically",value:function(n,l,i,o){var c=this.props,m=c.type,v=c.layout,N=c.connectNulls;c.ref;var y=Ne(c,dt),S=T(T(T({},te(y,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:l?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:m,layout:v,connectNulls:N});return $.createElement(Je,J({},S,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,l){var i=this,o=this.props,c=o.points,m=o.strokeDasharray,v=o.isAnimationActive,N=o.animationBegin,y=o.animationDuration,S=o.animationEasing,h=o.animationId,p=o.animateNewValues,w=o.width,b=o.height,f=this.state,_=f.prevPoints,A=f.totalLength;return $.createElement(Qe,{begin:N,duration:y,isActive:v,easing:S,from:{t:0},to:{t:1},key:"line-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(O){var C=O.t;if(_){var j=_.length/c.length,g=c.map(function(L,F){var Y=Math.floor(F*j);if(_[Y]){var D=_[Y],B=q(D.x,L.x),re=q(D.y,L.y);return T(T({},L),{},{x:B(C),y:re(C)})}if(p){var ee=q(w*2,L.x),se=q(b/2,L.y);return T(T({},L),{},{x:ee(C),y:se(C)})}return T(T({},L),{},{x:L.x,y:L.y})});return i.renderCurveStatically(g,n,l)}var P=q(0,A),M=P(C),R;if(m){var K="".concat(m).split(/[,\s]+/gim).map(function(L){return parseFloat(L)});R=i.getStrokeDasharray(M,A,K)}else R=i.generateSimpleStrokeDasharray(A,M);return i.renderCurveStatically(c,n,l,{strokeDasharray:R})})}},{key:"renderCurve",value:function(n,l){var i=this.props,o=i.points,c=i.isAnimationActive,m=this.state,v=m.prevPoints,N=m.totalLength;return c&&o&&o.length&&(!v&&N>0||!et(v,o))?this.renderCurveWithAnimation(n,l):this.renderCurveStatically(o,n,l)}},{key:"render",value:function(){var n,l=this.props,i=l.hide,o=l.dot,c=l.points,m=l.className,v=l.xAxis,N=l.yAxis,y=l.top,S=l.left,h=l.width,p=l.height,w=l.isAnimationActive,b=l.id;if(i||!c||!c.length)return null;var f=this.state.isAnimationFinished,_=c.length===1,A=be("recharts-line",m),O=v&&v.allowDataOverflow,C=N&&N.allowDataOverflow,j=O||C,g=de(b)?this.id:b,P=(n=te(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},M=P.r,R=M===void 0?3:M,K=P.strokeWidth,L=K===void 0?2:K,F=tt(o)?o:{},Y=F.clipDot,D=Y===void 0?!0:Y,B=R*2+L;return $.createElement(ie,{className:A},O||C?$.createElement("defs",null,$.createElement("clipPath",{id:"clipPath-".concat(g)},$.createElement("rect",{x:O?S:S-h/2,y:C?y:y-p/2,width:O?h:h*2,height:C?p:p*2})),!D&&$.createElement("clipPath",{id:"clipPath-dots-".concat(g)},$.createElement("rect",{x:S-B/2,y:y-B/2,width:h+B,height:p+B}))):null,!_&&this.renderCurve(j,g),this.renderErrorBar(j,g),(_||o)&&this.renderDots(j,D,g),(!w||f)&&at.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(n,l){return n.animationId!==l.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:l.curPoints}:n.points!==l.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,l){for(var i=n.length%2!==0?[].concat(U(n),[0]):n,o=[],c=0;c<l;++c)o=[].concat(U(o),U(i));return o}},{key:"renderDotItem",value:function(n,l){var i;if($.isValidElement(n))i=$.cloneElement(n,l);else if(Ze(n))i=n(l);else{var o=l.key,c=Ne(l,ut),m=be("recharts-line-dot",typeof n!="boolean"?n.className:"");i=$.createElement(Ue,J({key:o},c,{className:m}))}return i}}])}(d.PureComponent);W(Q,"displayName","Line");W(Q,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!st.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});W(Q,"getComposedData",function(t){var r=t.props,s=t.xAxis,n=t.yAxis,l=t.xAxisTicks,i=t.yAxisTicks,o=t.dataKey,c=t.bandSize,m=t.displayedData,v=t.offset,N=r.layout,y=m.map(function(S,h){var p=Ce(S,o);return N==="horizontal"?{x:ve({axis:s,ticks:l,bandSize:c,entry:S,index:h}),y:de(p)?null:n.scale(p),value:p,payload:S}:{x:de(p)?null:s.scale(p),y:ve({axis:n,ticks:i,bandSize:c,entry:S,index:h}),value:p,payload:S}});return T({points:y,layout:N},v)});var St=nt({chartName:"LineChart",GraphicalChild:Q,axisComponents:[{axisType:"xAxis",AxisComp:ue},{axisType:"yAxis",AxisComp:me}],formatAxisMap:ot});function wt({run:t,onSave:r,onClose:s}){var C;const[n,l]=d.useState(String(t.distance_miles||"")),[i,o]=d.useState(he(t.duration_seconds)),[c,m]=d.useState(t.duration_seconds||0),[v,N]=d.useState(t.date||((C=t.created_at)==null?void 0:C.slice(0,10))||""),[y,S]=d.useState(t.notes||""),[h,p]=d.useState(t.perceived_effort||5),[w,b]=d.useState(""),[f,_]=d.useState(!1),A=()=>{const j=Ve(i);j?(m(j),o(he(j)),b("")):i&&b('Could not understand that duration. Try "45:00" or "1 hour 30 minutes"')},O=async()=>{var j,g;_(!0),b("");try{const P=await z.put(`/runs/${t.id}`,{date:v,distance_miles:Number(n),duration_seconds:c,notes:y,perceived_effort:h});r(P.data)}catch(P){b(((g=(j=P==null?void 0:P.response)==null?void 0:j.data)==null?void 0:g.error)||"Could not save.")}finally{_(!1)}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/70",onClick:j=>j.target===j.currentTarget&&s(),children:e.jsxs("div",{className:"w-full max-w-lg rounded-t-2xl p-5 space-y-3",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-bold text-lg",style:{color:"var(--text-primary)"},children:"Edit Run"}),e.jsx("button",{onClick:s,className:"text-sm px-3 py-1 rounded-lg",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:"Cancel"})]}),[["Distance (miles)",n,l,"decimal-pad"],["Date (YYYY-MM-DD)",v,N,"default"]].map(([j,g,P,M])=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:j}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:g,onChange:R=>P(R.target.value),inputMode:M==="decimal-pad"?"decimal":void 0})]},j)),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Duration (any format)"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:i,onChange:j=>o(j.target.value),onBlur:A,placeholder:"e.g. 2 hours 45 minutes, 45:30, 1h30m"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs mb-2 block",style:{color:"var(--text-muted)"},children:["Effort: ",h,"/10"]}),e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5,6,7,8,9,10].map(j=>e.jsx("button",{onClick:()=>p(j),className:"flex-1 h-8 rounded text-xs font-bold",style:{background:j<=h?"var(--accent)":"var(--bg-input)",color:j<=h?"#000":"var(--text-muted)"},children:j},j))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Notes"}),e.jsx("textarea",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none resize-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:y,onChange:j=>S(j.target.value),rows:2})]}),w&&e.jsx("p",{className:"text-xs",style:{color:"#ef4444"},children:w}),e.jsx("button",{onClick:O,disabled:f,className:"w-full py-4 rounded-xl font-black text-black text-base",style:{background:"var(--accent)",opacity:f?.6:1},children:f?"Saving...":"Save Changes"})]})})}function _t({lift:t,onSave:r,onClose:s}){var j;const[n,l]=d.useState(t.exercise_name||""),[i,o]=d.useState(String(t.sets??"")),[c,m]=d.useState(String(t.reps??"")),[v,N]=d.useState(String(t.weight_lbs??"")),[y,S]=d.useState(t.date||((j=t.created_at)==null?void 0:j.slice(0,10))||""),[h,p]=d.useState(t.notes||""),[w,b]=d.useState(""),[f,_]=d.useState({}),[A,O]=d.useState(!1),C=async()=>{var P,M;const{errors:g}=He({reps:c,weight:v});if((!Number.isFinite(Number(i))||Number(i)<=0)&&(g.sets="Sets must be a positive number."),_(g),!Object.keys(g).length){O(!0),b("");try{const R=await z.put(`/lifts/${t.id}`,{exercise_name:n,sets:i===""?null:Number(i),reps:c===""?null:Number(c),weight_lbs:v===""?null:Number(v),date:y,notes:h});r(R.data)}catch(R){b(((M=(P=R==null?void 0:R.response)==null?void 0:P.data)==null?void 0:M.error)||"Could not save.")}finally{O(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/70",onClick:g=>g.target===g.currentTarget&&s(),children:e.jsxs("div",{className:"w-full max-w-lg rounded-t-2xl p-5 space-y-3",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-bold text-lg",style:{color:"var(--text-primary)"},children:"Edit Lift"}),e.jsx("button",{onClick:s,className:"text-sm px-3 py-1 rounded-lg",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:"Cancel"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Exercise"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:n,onChange:g=>l(g.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Sets"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:i,onChange:g=>o(g.target.value),inputMode:"numeric"}),f.sets&&e.jsx("p",{className:"text-xs mt-1",style:{color:"#ef4444"},children:f.sets})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Reps"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:c,onChange:g=>m(g.target.value),inputMode:"numeric"}),f.reps&&e.jsx("p",{className:"text-xs mt-1",style:{color:"#ef4444"},children:f.reps})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Weight"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:v,onChange:g=>N(g.target.value),inputMode:"decimal"}),f.weight&&e.jsx("p",{className:"text-xs mt-1",style:{color:"#ef4444"},children:f.weight})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Date (YYYY-MM-DD)"}),e.jsx("input",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:y,onChange:g=>S(g.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"Notes"}),e.jsx("textarea",{className:"w-full px-4 py-3 rounded-xl text-sm outline-none resize-none",style:{background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},value:h,onChange:g=>p(g.target.value),rows:2})]}),w&&e.jsx("p",{className:"text-xs",style:{color:"#ef4444"},children:w}),e.jsx("button",{onClick:C,disabled:A,className:"w-full py-4 rounded-xl font-black text-black text-base",style:{background:"var(--accent)",opacity:A?.6:1},children:A?"Saving...":"Save Changes"})]})})}const At=[{value:"tired",label:"Tired / needed rest"},{value:"no_time",label:"No time"},{value:"didnt_feel_like_it",label:"Didn't feel like it"},{value:"something_came_up",label:"Something came up"},{value:"weather",label:"Weather"},{value:"sick",label:"Sick / injured"}];function Dt({onClose:t}){const[r,s]=d.useState(""),[n,l]=d.useState(""),[i,o]=d.useState(!1),c=async()=>{if(r){o(!0);try{const m=await z.post("/runs/missed",{reason:r,scheduled_date:new Date().toISOString().slice(0,10)});l(m.data.message)}catch{}finally{o(!1)}}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center bg-black/70",onClick:m=>m.target===m.currentTarget&&t(),children:e.jsx("div",{className:"w-full max-w-lg rounded-t-2xl p-5 space-y-3",style:{background:"var(--bg-card)"},children:n?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-base leading-relaxed",style:{color:"var(--text-primary)"},children:n}),e.jsx("button",{onClick:t,className:"w-full py-4 rounded-xl font-black text-black",style:{background:"var(--accent)"},children:"Got it"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-bold text-lg",style:{color:"var(--text-primary)"},children:"What happened?"}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"No judgment — I'll adjust your plan."}),e.jsx("div",{className:"space-y-2",children:At.map(m=>e.jsx("button",{onClick:()=>s(m.value),className:"w-full p-3 rounded-xl text-left border text-sm font-medium",style:{background:r===m.value?"var(--accent-dim)":"var(--bg-input)",borderColor:r===m.value?"var(--accent)":"var(--border-subtle)",color:"var(--text-primary)"},children:m.label},m.value))}),e.jsx("button",{onClick:c,disabled:!r||i,className:"w-full py-4 rounded-xl font-black text-black",style:{background:r?"var(--accent)":"var(--bg-input)",opacity:i?.6:1},children:i?"Adjusting...":"Update My Plan"})]})})})}function Ct(t=0){const r=Math.floor(t/3600),s=Math.floor(t%3600/60),n=t%60;return r>0?`${r}h ${s}m`:s>0&&n>0?`${s}m ${n}s`:`${s}m`}function Pt(t,r){if(!t||!r)return"--";const s=t/60/r,n=Math.floor(s),l=Math.round((s-n)*60);return`${n}:${String(l).padStart(2,"0")} /mi`}const Et=["","Very Easy","Easy","Easy-Moderate","Moderate","Moderate-Hard","Hard","Hard","Very Hard","Very Hard","Max"],_e=[{key:"Z1",min:.5,max:.6,name:"Recovery",color:"#6B7280"},{key:"Z2",min:.6,max:.7,name:"Aerobic Base",color:"#3B82F6"},{key:"Z3",min:.7,max:.8,name:"Tempo",color:"#22C55E"},{key:"Z4",min:.8,max:.9,name:"Threshold",color:"#EAB308"},{key:"Z5",min:.9,max:1.01,name:"Max Effort",color:"#EF4444"}];function Ot({run:t,onClose:r,onFeedbackGenerated:s}){const[n,l]=d.useState(t.ai_feedback||""),[i,o]=d.useState(!1),[c,m]=d.useState(""),v=async()=>{var b,f;o(!0),m("");try{const _=await z.post(`/runs/${t.id}/feedback`);l(_.data.feedback),s&&s(t.id,_.data.feedback)}catch(_){m(((f=(b=_.response)==null?void 0:b.data)==null?void 0:f.error)||"Could not generate feedback.")}finally{o(!1)}},N=new Date(t.date||t.created_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),y=t.avg_hr||t.avg_heart_rate||null,S=t.max_heart_rate||190,h=y&&S?y/S:null,p=h?_e.find(b=>h>=b.min&&h<b.max)||_e[4]:null,w=[{label:"Distance",value:t.distance_miles?`${Number(t.distance_miles).toFixed(2)} mi`:"--"},{label:"Duration",value:t.duration_seconds?Ct(t.duration_seconds):"--"},{label:"Pace",value:Pt(t.duration_seconds,t.distance_miles)},{label:"Calories",value:t.calories?`${t.calories} cal`:"--"},{label:"Effort",value:t.perceived_effort?`${t.perceived_effort}/10 - ${Et[t.perceived_effort]||""}`:"--"},{label:"Surface",value:t.surface||t.run_type||"--"}];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{background:"rgba(0,0,0,0.7)"},onClick:r,children:e.jsxs("div",{className:"w-full rounded-t-2xl p-6 pb-10 max-h-[85vh] overflow-y-auto",style:{background:"var(--bg-card)"},onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Run Detail"}),e.jsx("button",{onClick:r,children:e.jsx(Ae,{size:20,style:{color:"var(--text-muted)"}})})]}),e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:N}),e.jsx("div",{className:"grid grid-cols-2 gap-3 mb-5",children:w.map(({label:b,value:f})=>e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:b}),e.jsx("p",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:f})]},b))}),p&&e.jsxs("div",{className:"rounded-xl p-3 mb-5",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Heart Rate Zone"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:[y," bpm"]}),e.jsxs("span",{className:"rounded-full px-2 py-1 text-xs",style:{background:`${p.color}22`,color:p.color},children:[p.key," · ",p.name]})]}),e.jsx("div",{className:"mt-2 h-1.5 rounded-full",style:{background:"var(--bg-base)"},children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${Math.min(100,h*100)}%`,background:p.color}})})]}),t.notes&&e.jsxs("div",{className:"rounded-xl p-3 mb-5",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Notes"}),e.jsxs("p",{className:"text-sm italic",style:{color:"var(--text-primary)"},children:['"',t.notes,'"']})]}),e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(De,{size:16,style:{color:"var(--accent)"}}),e.jsx("span",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:"AI Coach Feedback"})]}),n?e.jsx("p",{className:"text-sm leading-relaxed",style:{color:"var(--text-muted)"},children:n}):e.jsxs(e.Fragment,{children:[c&&e.jsx("p",{className:"text-xs mb-2",style:{color:"#ef4444"},children:c}),e.jsx("button",{onClick:v,disabled:i,className:"w-full py-2.5 rounded-xl text-sm font-semibold",style:{background:"var(--accent)",color:"#000"},children:i?"Analyzing your run...":"Get AI Feedback"})]})]})]})})}function Lt(t=0){const r=Math.floor(t/3600),s=Math.floor(t%3600/60);return r>0?`${r}h ${s}m`:`${s}m`}function Rt({session:t,onClose:r,onFeedbackGenerated:s}){const[n,l]=d.useState([]),[i,o]=d.useState(!0),[c,m]=d.useState(t.ai_feedback||""),[v,N]=d.useState(!1),[y,S]=d.useState("");d.useEffect(()=>{z.get(`/workouts/${t.id}/sets`).then(f=>{l(f.data.sets||[]),o(!1)}).catch(()=>o(!1))},[t.id]);const h=async()=>{var f,_;N(!0),S("");try{const A=await z.post(`/workouts/${t.id}/feedback`);m(A.data.feedback),s&&s(t.id,A.data.feedback)}catch(A){S(((_=(f=A.response)==null?void 0:f.data)==null?void 0:_.error)||"Could not generate feedback.")}finally{N(!1)}},p={};for(const f of n)p[f.exercise_name]||(p[f.exercise_name]=[]),p[f.exercise_name].push(f);const w=new Date(t.started_at||t.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),b=Array.isArray(t.muscle_groups)?t.muscle_groups:[];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{background:"rgba(0,0,0,0.7)"},onClick:r,children:e.jsxs("div",{className:"w-full rounded-t-2xl p-6 pb-10 max-h-[85vh] overflow-y-auto",style:{background:"var(--bg-card)"},onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h2",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:"Workout Detail"}),e.jsx("button",{onClick:r,children:e.jsx(Ae,{size:20,style:{color:"var(--text-muted)"}})})]}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:w}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-5",children:[e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Duration"}),e.jsx("p",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:t.total_seconds?Lt(t.total_seconds):"--"})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Total Sets"}),e.jsx("p",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:n.length})]})]}),b.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-5",children:b.map(f=>e.jsx("span",{className:"rounded-full px-3 py-1 text-xs font-semibold capitalize",style:{background:"var(--accent-dim)",color:"var(--accent)"},children:f},f))}),i?e.jsx("p",{className:"text-sm text-center py-4",style:{color:"var(--text-muted)"},children:"Loading sets..."}):Object.keys(p).length>0?e.jsx("div",{className:"space-y-4 mb-5",children:Object.entries(p).map(([f,_])=>e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"font-semibold text-sm mb-3",style:{color:"var(--text-primary)"},children:f}),e.jsx("div",{className:"space-y-2",children:_.map((A,O)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:["Set ",A.set_number||O+1]}),e.jsxs("span",{className:"text-sm font-medium",style:{color:"var(--text-primary)"},children:[A.reps?`${A.reps} reps`:"--",A.weight_lbs?` @ ${A.weight_lbs} lbs`:""]})]},O))})]},f))}):e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:"No set data recorded for this session."}),t.notes&&e.jsxs("div",{className:"rounded-xl p-3 mb-5",style:{background:"var(--bg-input)"},children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Notes"}),e.jsxs("p",{className:"text-sm italic",style:{color:"var(--text-primary)"},children:['"',t.notes,'"']})]}),e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(De,{size:16,style:{color:"var(--accent)"}}),e.jsx("span",{className:"font-semibold text-sm",style:{color:"var(--text-primary)"},children:"AI Coach Feedback"})]}),c?e.jsx("p",{className:"text-sm leading-relaxed",style:{color:"var(--text-muted)"},children:c}):e.jsxs(e.Fragment,{children:[y&&e.jsx("p",{className:"text-xs mb-2",style:{color:"#ef4444"},children:y}),e.jsx("button",{onClick:h,disabled:v,className:"w-full py-2.5 rounded-xl text-sm font-semibold",style:{background:"var(--accent)",color:"#000"},children:v?"Analyzing your workout...":"Get AI Feedback"})]})]})]})})}function ce(t){var r;return t.date||((r=t.created_at)==null?void 0:r.slice(0,10))||""}function Mt(t=0){const r=Math.floor(t/60),s=t%60;return`${r}:${String(s).padStart(2,"0")}`}function $t(t=0){const r=Math.floor(t/3600),s=Math.floor(t%3600/60);return r>0?`${r}h ${s}m`:`${s}m`}function Gt(){const t=Be(),{fmt:r}=We(),{t:s,i18n:n}=Ye(),[l,i]=d.useState(!0),[o,c]=d.useState("all"),[m,v]=d.useState("all"),[N,y]=d.useState([]),[S,h]=d.useState([]),[p,w]=d.useState([]),[b,f]=d.useState([]),[_,A]=d.useState(null),[O,C]=d.useState(null),[j,g]=d.useState(null),[P,M]=d.useState(null),[R,K]=d.useState(!1),L=new Date().getFullYear(),[F,Y]=d.useState(null),[D,B]=d.useState({from:"",to:""}),[re,ee]=d.useState(!1);d.useEffect(()=>{(async()=>{var a,u,x,k;try{const[E,I,Z,ze]=await Promise.all([z.get("/runs"),z.get("/lifts"),z.get("/workouts").catch(()=>({data:{sessions:[]}})),z.get("/races").catch(()=>({data:{races:[]}}))]);y([...Array.isArray(E.data)?E.data:((a=E.data)==null?void 0:a.runs)||[]].sort((H,G)=>ce(G).localeCompare(ce(H)))),h([...Array.isArray(I.data)?I.data:((u=I.data)==null?void 0:u.lifts)||[]].sort((H,G)=>(G.date||G.created_at||"").localeCompare(H.date||H.created_at||""))),w([...((x=Z.data)==null?void 0:x.sessions)||[]].sort((H,G)=>(G.started_at||"").localeCompare(H.started_at||""))),f([...((k=ze.data)==null?void 0:k.races)||[]].sort((H,G)=>(G.race_date||"").localeCompare(H.race_date||"")))}finally{i(!1)}})()},[]),d.useEffect(()=>{if(!l){const a=new URLSearchParams(t.search),u=a.get("runId"),x=a.get("workoutId");if(u){const k=N.find(E=>E.id===u);k&&g(k)}if(x){const k=p.find(E=>E.id===x);k&&M(k)}}},[l,t.search,N,p]);const se=async(a,u)=>{u.stopPropagation(),confirm("Delete this run?")&&(await z.delete(`/runs/${a}`),y(x=>x.filter(k=>k.id!==a)))},Oe=async(a,u)=>{u.stopPropagation(),confirm("Delete this lift?")&&(await z.delete(`/lifts/${a}`),h(x=>x.filter(k=>k.id!==a)))},Le=a=>{y(u=>u.map(x=>x.id===a.id?{...x,...a}:x)),A(null)},Re=a=>{h(u=>u.map(x=>x.id===a.id?{...x,...a}:x)),C(null)},ne=(a,u)=>{if(D.from||D.to)return a.filter(E=>{const I=(E[u]||E.created_at||"").slice(0,10);return!(D.from&&I<D.from||D.to&&I>D.to)});if(F)return a.filter(E=>(E[u]||E.created_at||"").slice(0,10).startsWith(String(F)));if(m==="all")return a;const x={week:7,month:30,year:365}[m],k=new Date(Date.now()-x*864e5).toISOString().slice(0,10);return a.filter(E=>(E[u]||E.created_at||"").slice(0,10)>=k)},V=ne(N,"date"),oe=ne(S,"date"),le=ne(p,"started_at"),Me=d.useMemo(()=>V.reduce((a,u)=>a+Number(u.distance_miles||0),0),[V]),$e=d.useMemo(()=>{const a=V.filter(x=>x.distance_miles&&x.duration_seconds);if(!a.length)return"--";const u=a.reduce((x,k)=>x+k.duration_seconds/k.distance_miles,0)/a.length;return r.pace(u)},[V,r]),Ie=d.useMemo(()=>{const a=[];for(let u=7;u>=0;u-=1){const x=new Date;x.setDate(x.getDate()-u*7);const k=new Date(x);k.setDate(k.getDate()+6);const E=N.filter(I=>{const Z=new Date((I.date||I.created_at||"")+"T12:00:00");return Z>=x&&Z<=k}).reduce((I,Z)=>I+Number(Z.distance_miles||0),0);a.push({week:`${x.getMonth()+1}/${x.getDate()}`,miles:Number(E.toFixed(1))})}return a},[N]),Te=d.useMemo(()=>V.slice(0,20).reverse().map((a,u)=>({idx:u+1,pace:a.distance_miles?Number((a.duration_seconds/60/a.distance_miles).toFixed(2)):0})).filter(a=>a.pace>0),[V]);return l?e.jsx(Ge,{message:"Loading history"}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 grid grid-cols-3 gap-2",children:[["Distance",r.distance(Me,1)],["Avg Pace",$e],["Lifts",`${oe.length+le.length}`]].map(([a,u])=>e.jsxs("div",{className:"rounded-xl p-3 text-center",style:{background:"var(--bg-card)"},children:[e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.7},children:a}),e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:u})]},a))}),e.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[e.jsx(fe,{to:"/recap",style:{display:"inline-flex",alignItems:"center",gap:6,padding:"8px 16px",borderRadius:20,background:"#EAB308",color:"#000",fontWeight:700,fontSize:13,textDecoration:"none"},children:"Weekly Recap"}),e.jsx(fe,{to:"/journal",className:"text-sm",style:{color:"var(--accent)"},children:"View Journal"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 mb-4",children:[e.jsx("div",{className:"rounded-xl p-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:e.jsx("div",{style:{width:"100%",height:180},children:e.jsx(ye,{children:e.jsxs(lt,{data:Ie,children:[e.jsx(ue,{dataKey:"week",stroke:"#fff",tick:{fontSize:10}}),e.jsx(me,{stroke:"#fff",tick:{fontSize:10}}),e.jsx(ge,{}),e.jsx(it,{dataKey:"miles",fill:"#EAB308"})]})})})}),e.jsx("div",{className:"rounded-xl p-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:e.jsx("div",{style:{width:"100%",height:180},children:e.jsx(ye,{children:e.jsxs(St,{data:Te,children:[e.jsx(ue,{dataKey:"idx",stroke:"#fff",tick:{fontSize:10}}),e.jsx(me,{stroke:"#fff",tick:{fontSize:10}}),e.jsx(ge,{}),e.jsx(Q,{type:"monotone",dataKey:"pace",stroke:"#EAB308",strokeWidth:2,dot:!1})]})})})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{style:{display:"flex",gap:8,overflowX:"auto",paddingBottom:4,marginBottom:12},children:[Array.from({length:1},(a,u)=>L-u).map(a=>e.jsx("button",{onClick:()=>{Y(F===a?null:a),B({from:"",to:""})},style:{flexShrink:0,padding:"6px 16px",borderRadius:20,border:`1.5px solid ${F===a?"var(--accent)":"var(--border-subtle)"}`,background:F===a?"var(--accent)":"var(--bg-input)",color:F===a?"black":"var(--text-muted)",fontWeight:700,fontSize:13,cursor:"pointer",whiteSpace:"nowrap"},children:a},a)),e.jsx("button",{onClick:()=>{ee(a=>!a),Y(null)},style:{flexShrink:0,padding:"6px 14px",borderRadius:20,border:`1.5px solid ${D.from||D.to?"var(--accent)":"var(--border-subtle)"}`,background:D.from||D.to?"var(--accent-dim)":"var(--bg-input)",color:D.from||D.to?"var(--accent)":"var(--text-muted)",fontWeight:700,fontSize:13,cursor:"pointer",whiteSpace:"nowrap"},children:"Custom Range"})]}),re&&e.jsxs("div",{className:"rounded-xl p-4 mb-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-xs font-semibold mb-3",style:{color:"var(--text-muted)"},children:"Custom Date Range"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"From"}),e.jsx("input",{type:"date",value:D.from,min:`${L-5}-01-01`,max:new Date().toISOString().slice(0,10),onChange:a=>B(u=>({...u,from:a.target.value})),style:{width:"100%",background:"var(--bg-input)",border:"1px solid var(--border-subtle)",borderRadius:8,padding:"8px 10px",color:"var(--text-primary)",fontSize:13}})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs mb-1 block",style:{color:"var(--text-muted)"},children:"To"}),e.jsx("input",{type:"date",value:D.to,min:`${L-5}-01-01`,max:new Date().toISOString().slice(0,10),onChange:a=>B(u=>({...u,to:a.target.value})),style:{width:"100%",background:"var(--bg-input)",border:"1px solid var(--border-subtle)",borderRadius:8,padding:"8px 10px",color:"var(--text-primary)",fontSize:13}})]})]}),(D.from||D.to)&&e.jsx("button",{onClick:()=>{B({from:"",to:""}),ee(!1)},className:"mt-3 text-xs",style:{color:"var(--text-muted)"},children:"Clear"})]})]}),e.jsx("div",{className:"mb-4 flex rounded-xl overflow-hidden border",style:{borderColor:"var(--border-subtle)",opacity:F||D.from||D.to?.4:1},children:["week","month","year","all"].map(a=>e.jsx("button",{onClick:()=>v(a),className:"flex-1 py-2 text-xs font-semibold uppercase",style:m===a?{background:"var(--accent)",color:"black"}:{background:"var(--bg-input)",color:"var(--text-muted)"},children:a==="week"?"W":a==="month"?"M":a==="year"?"Y":"All"},a))}),e.jsx("div",{className:"mb-4 flex border-b",style:{borderColor:"var(--border-subtle)"},children:[["all","All"],["runs",s("history.runs")],["lifts",s("history.workouts")],["races",s("history.races")]].map(([a,u])=>e.jsx("button",{onClick:()=>c(a),className:"px-4 py-2 text-sm font-medium border-b-2",style:o===a?{borderColor:"var(--accent)",color:"var(--text-primary)"}:{borderColor:"transparent",color:"var(--text-muted)"},children:u},a))}),(o==="all"||o==="runs")&&e.jsxs("div",{className:"space-y-3 mb-3",children:[V.map(a=>e.jsxs("div",{onClick:()=>g(a),className:"cursor-pointer rounded-xl p-4",style:{background:"var(--bg-card)"},children:[(()=>{const u=a.distance_miles?a.duration_seconds/60/a.distance_miles:null,x=Ke(u);return e.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:new Date(ce(a)).toLocaleDateString()}),e.jsxs("div",{className:"flex items-center gap-2",children:[x?e.jsx("span",{className:"rounded-full px-2 py-1 text-xs font-semibold",style:{background:`${x.color}22`,color:x.color},children:`Zone ${x.zone}`}):null,a.perceived_effort?e.jsxs("span",{className:"rounded-full px-2 py-1 text-xs",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:["Effort ",a.perceived_effort,"/10"]}):null,e.jsx("button",{onClick:k=>{k.stopPropagation(),A(a)},className:"transition-colors",style:{color:"var(--text-muted)"},children:e.jsx(je,{size:14})}),e.jsx("button",{onClick:k=>se(a.id,k),className:"transition-colors",style:{color:"var(--text-muted)"},children:e.jsx(ke,{size:14})})]})]})})(),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:[r.distance(Number(a.distance_miles||0),2)," · ",Mt(a.duration_seconds)," · ",r.pace(a.duration_seconds/a.distance_miles),(a.calories_burned||a.calories)>0&&e.jsxs("span",{children:[" · ",a.calories_burned||a.calories," cal"]})]}),a.notes&&e.jsxs("p",{className:"mt-1 text-xs italic",style:{color:"var(--text-muted)",opacity:.7},children:['"',a.notes,'"']})]},a.id)),V.length===0&&o!=="lifts"&&e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("img",{src:"/icon.svg",alt:"FORGE",className:"w-24 h-24 object-contain opacity-20"}),e.jsx("p",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:s("history.noRuns")}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Lace up and log your next run."})]}),e.jsx("button",{onClick:()=>K(!0),className:"w-full py-3 rounded-xl text-sm mt-2",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:"Miss a workout? Let me know - I'll adjust your plan"})]}),(o==="all"||o==="lifts")&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:[s("history.workouts")," & ",s("history.races")]}),le.map(a=>e.jsxs("div",{onClick:()=>M(a),className:"cursor-pointer rounded-xl p-4",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:new Date(a.started_at||a.created_at).toLocaleDateString()}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:"View Details"})]}),e.jsxs("p",{className:"mt-1 text-sm",style:{color:"var(--text-primary)"},children:["Duration: ",a.total_seconds?$t(a.total_seconds):"--",a.calories_burned>0&&e.jsxs("span",{children:[" · ",a.calories_burned," cal"]})]}),Array.isArray(a.muscle_groups)&&a.muscle_groups.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:a.muscle_groups.map(u=>e.jsx("span",{className:"rounded-full px-2 py-1 text-xs capitalize",style:{background:"var(--accent-dim)",color:"var(--accent)"},children:u},u))})]},a.id)),oe.map(a=>{let u=[];try{u=Array.isArray(a.muscle_groups)?a.muscle_groups:JSON.parse(a.muscle_groups||"[]")}catch{u=[]}return e.jsxs("div",{className:"cursor-pointer rounded-xl p-4",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:new Date(a.date||a.created_at).toLocaleDateString()}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:x=>{x.stopPropagation(),C(a)},className:"transition-colors",style:{color:"var(--text-muted)"},children:e.jsx(je,{size:14})}),e.jsx("button",{onClick:x=>Oe(a.id,x),className:"transition-colors",style:{color:"var(--text-muted)"},children:e.jsx(ke,{size:14})})]})]}),e.jsx("p",{className:"mt-1 font-semibold",style:{color:"var(--text-primary)"},children:a.exercise_name}),e.jsxs("p",{className:"mt-1 text-sm",style:{color:"var(--text-muted)"},children:[a.sets," × ",a.reps," @ ",a.weight_lbs," lbs"]}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:u.map(x=>e.jsx("span",{className:"rounded-full px-2 py-1 text-xs capitalize",style:{background:"var(--bg-input)",color:"var(--text-muted)"},children:x},x))})]},a.id)}),oe.length===0&&le.length===0&&o!=="runs"&&e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[e.jsx("img",{src:"/icon.svg",alt:"FORGE",className:"w-24 h-24 object-contain opacity-20"}),e.jsx("p",{className:"text-base font-semibold",style:{color:"var(--text-primary)"},children:"No lifts recorded for this period."}),e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Hit the weights."})]})]}),(o==="all"||o==="races")&&e.jsxs("div",{className:"space-y-3",children:[b.length===0?e.jsx("p",{className:"text-center py-8",style:{color:"var(--text-muted)",fontSize:14},children:s("history.noRaces")}):b.map(a=>e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",style:{color:"var(--text-primary)"},children:a.race_name}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[a.race_date," · ",a.distance_miles," mi",a.location?` · ${a.location}`:""]})]}),e.jsx("span",{className:"text-xs px-2 py-1 rounded-full font-semibold",style:{background:a.status==="completed"?"rgba(34,197,94,0.15)":"rgba(234,179,8,0.15)",color:a.status==="completed"?"#22c55e":"#EAB308"},children:a.status||"upcoming"})]}),a.goal_time_seconds&&e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:["Goal: ",Math.floor(a.goal_time_seconds/3600)>0?`${Math.floor(a.goal_time_seconds/3600)}h `:"",Math.floor(a.goal_time_seconds%3600/60),":",String(a.goal_time_seconds%60).padStart(2,"0")]})]},a.id)),e.jsx("button",{onClick:()=>window.location.href="/races",style:{width:"100%",padding:"10px 0",borderRadius:12,background:"var(--bg-input)",border:"1px solid var(--border-subtle)",color:"var(--text-muted)",fontSize:13,cursor:"pointer"},children:"+ Add Race"})]}),_&&e.jsx(wt,{run:_,onSave:Le,onClose:()=>A(null)}),O&&e.jsx(_t,{lift:O,onSave:Re,onClose:()=>C(null)}),R&&e.jsx(Dt,{onClose:()=>K(!1)}),j&&e.jsx(Ot,{run:j,onClose:()=>g(null),onFeedbackGenerated:(a,u)=>y(x=>x.map(k=>k.id===a?{...k,ai_feedback:u}:k))}),P&&e.jsx(Rt,{session:P,onClose:()=>M(null),onFeedbackGenerated:(a,u)=>w(x=>x.map(k=>k.id===a?{...k,ai_feedback:u}:k))})]})}export{Gt as default};
