import{r,j as e,a as j}from"./index-BaOvKJ5T.js";function f({open:m,loading:v,feedback:l,fallback:o,sessionId:y,onClose:n}){const[c,i]=r.useState(!1),[d,x]=r.useState(null),[a,u]=r.useState(!1);if(!m)return null;const p=async()=>{const s=l||o;if(!s)return;const b=[s.analysis,`Did well: ${s.didWell}`,`Next session: ${s.suggestion}`,`Recovery: ${s.recovery}`].filter(Boolean).join(`
`);i(!0),x(null);try{await j.post("/journal",{source:"ai_feedback",content:b,session_id:y||null}),u(!0),setTimeout(()=>u(!1),2e3)}catch(g){console.error("Failed to save to journal:",g),x("Could not save â€” try again")}finally{i(!1)}},t=l||o;return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{background:"rgba(0,0,0,0.6)"},onClick:n,children:e.jsxs("div",{className:"w-full rounded-t-2xl p-5",style:{background:"var(--bg-card)",borderTop:"1px solid var(--border-subtle)"},onClick:s=>s.stopPropagation(),children:[e.jsx("h3",{className:"text-lg font-bold mb-2",style:{color:"var(--text-primary)"},children:"AI Coach Feedback"}),v?e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Analyzing your session..."}):t?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:t.analysis}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Did well:"})," ",t.didWell]}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Next session:"})," ",t.suggestion]}),e.jsxs("p",{className:"text-sm",style:{color:"var(--accent)"},children:[e.jsx("strong",{children:"Recovery:"})," ",t.recovery]})]}):null,d&&e.jsx("p",{className:"text-xs mt-3",style:{color:"#ef4444"},children:d}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:n,className:"flex-1 rounded-xl py-2",style:{background:"var(--bg-input)",color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:"Dismiss"}),e.jsx("button",{onClick:p,disabled:c||a,className:"flex-1 rounded-xl py-2 font-semibold disabled:opacity-50",style:{background:a?"var(--bg-input)":"var(--accent)",color:a?"var(--text-muted)":"#000"},children:c?"Saving...":a?"Saved":"Save to Journal"})]})]})})}export{f as A};
