import{d as he,b as Qe,e as Ve,c as Xe,r as a,a as m,j as e,L as Ze}from"./index-DyTTJOv2.js";import{p as xe,f as et}from"./parseDuration-3bmQJghK.js";import{P as tt}from"./PostRunCheckIn-mBD7XCXc.js";import{P as rt}from"./PhotoUploader-BqnCSOvt.js";import{R as st}from"./refresh-cw-DVAef6RK.js";import{M as at}from"./mountain-CDhlKRUX.js";import{P as ot}from"./pencil-ClUQ3-qI.js";import"./check-vhBUD5zA.js";import"./camera-DCil1mdz.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],lt=he("Gauge",nt);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],me=he("MapPin",ct);function dt(){return new Date().toISOString().slice(0,10)}const it=["Leg swings — 10 each side","High knees — 30 seconds","Ankle circles — 10 each side","Hip circles — 10 each direction","Arm swings — 20 reps"],ut=[{value:"road",label:"Road",icon:me},{value:"track",label:"Track",icon:st},{value:"trail",label:"Trail",icon:at},{value:"treadmill",label:"Treadmill",icon:lt},{value:"other",label:"Other",icon:me}],pe="forge_run_detail_panels",be={overview:!0,stats:!0,pace:!0,hr:!0,notes:!0};function xt(s){return s<=3?"var(--text-muted)":s<=6?"var(--text-primary)":"var(--accent)"}function mt(s){return s<=3?"Easy":s<=6?"Moderate":s<=8?"Hard":"Max Effort"}function pt(s){const i=Math.floor(s/3600),d=Math.floor(s%3600/60),u=s%60;return i>0?`${i}:${String(d).padStart(2,"0")}:${String(u).padStart(2,"0")}`:`${d}:${String(u).padStart(2,"0")}`}function bt(s,i){if(!s||!i)return"—";const d=Math.round(s/i),u=Math.floor(d/60),M=d%60;return`${u}:${String(M).padStart(2,"0")}/mi`}function ht(s){const i=(s==null?void 0:s.splits)||(s==null?void 0:s.splits_json)||(s==null?void 0:s.gps_splits);if(!i)return[];if(Array.isArray(i))return i;if(typeof i=="string")try{const d=JSON.parse(i);return Array.isArray(d)?d:[]}catch{return[]}return[]}function vt({effort:s,setEffort:i}){return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:4},children:Array.from({length:10},(d,u)=>u+1).map(d=>{const u=d<=s;return e.jsx("button",{type:"button",onClick:()=>i(d),style:{flex:1,height:40,borderRadius:6,border:"1px solid var(--border-subtle)",cursor:"pointer",background:u?"var(--accent)":"var(--bg-base)"}},d)})}),e.jsxs("div",{style:{marginTop:10,textAlign:"center"},children:[e.jsx("span",{style:{fontSize:36,fontWeight:900,color:xt(s),lineHeight:1},children:s}),e.jsx("div",{style:{fontSize:13,color:"var(--text-muted)",marginTop:3,fontWeight:600},children:mt(s)})]})]})}function yt({workout:s,onClose:i}){if(!s)return null;const d=async()=>{const u=`${s.day}: ${s.typeLabel}
Distance: ${s.distanceLabel}
${s.pace?`Pace: ${s.pace}
`:""}${s.description?`Notes: ${s.description}`:""}`;try{await navigator.clipboard.writeText(u)}catch{}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)"},children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl p-5",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h3",{className:"text-xl font-black mb-4",style:{color:"var(--text-primary)"},children:"Today's Workout"}),e.jsxs("div",{className:"rounded-xl p-4 mb-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"text-xs font-semibold uppercase mb-2",style:{color:"var(--text-muted)"},children:s.day}),e.jsx("span",{className:"inline-block rounded-full px-3 py-1 text-xs font-bold mb-3",style:{background:"var(--accent)",color:"#000"},children:s.typeLabel}),e.jsxs("div",{className:"text-sm mb-1",style:{color:"var(--text-primary)"},children:[e.jsx("strong",{children:"Distance:"})," ",s.distanceLabel]}),s.pace&&e.jsxs("div",{className:"text-sm mb-1",style:{color:"var(--text-primary)"},children:[e.jsx("strong",{children:"Pace:"})," ",s.pace]}),s.description&&e.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s.description})]}),e.jsx("button",{onClick:d,className:"w-full rounded-xl py-3 font-bold mb-3",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Copy Workout"}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"Automatic watch sync is coming in the FORGE mobile app"}),e.jsx("button",{onClick:i,className:"w-full rounded-xl py-2",style:{background:"var(--bg-base)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},children:"Close"})]})})}function Lt(){var ce,de;const s=Qe();Ve();const{units:i,fmt:d}=Xe(),[u,M]=a.useState(()=>new URLSearchParams(window.location.search).get("warmup")==="true"?"warmup":"done"),[p,E]=a.useState("today"),[ve,gt]=a.useState(3),[U,ye]=a.useState("road"),[D,ge]=a.useState("easy"),[g,fe]=a.useState("outside"),[I,je]=a.useState("Generic"),[f,H]=a.useState(null),[C,ke]=a.useState("no"),[G,Ne]=a.useState(dt()),[j,Se]=a.useState(""),[A,q]=a.useState("30:00"),[Y,we]=a.useState(""),[J,Ce]=a.useState(5),[K,Q]=a.useState(!1),[_e,V]=a.useState(!1),[X,W]=a.useState(""),[Z,$]=a.useState(""),[Re,_]=a.useState(!1),[Pe,ee]=a.useState(!1),[R,Te]=a.useState(null),[O,B]=a.useState([]),[ft,jt]=a.useState(!1),[c,ze]=a.useState(null),[Le,te]=a.useState(!1),[k,Me]=a.useState(null),[re,se]=a.useState(!1),[Ee,De]=a.useState(null),[Ie,ae]=a.useState(!1),[n,P]=a.useState(null),[Ae,oe]=a.useState(!1),[h,We]=a.useState(()=>{try{return{...be,...JSON.parse(localStorage.getItem(pe)||"{}")}}catch{return be}}),[N,$e]=a.useState(""),[T,Oe]=a.useState([]),[z,Be]=a.useState(""),[Fe,Ue]=a.useState(!0),[He,ne]=a.useState(!1);a.useEffect(()=>{u==="done"&&E("today")},[u]),a.useEffect(()=>{let t=!0;return(async()=>{try{const{data:o}=await m.get("/checkin/today"),l=!!((o==null?void 0:o.completed)??(o==null?void 0:o.id)??o);t&&ne(l)}catch{t&&ne(!1)}finally{t&&Ue(!1)}})(),()=>{t=!1}},[]),a.useEffect(()=>{p!=="today"||c||(te(!0),m.get("/plans/today").then(t=>{var o;const r=((o=t.data)==null?void 0:o.today)||null;r&&ze({day:r.day||r.day_of_week||new Date().toLocaleDateString(void 0,{weekday:"short"}),typeLabel:String(r.type||"run").replace("-"," ").replace(/\b\w/g,l=>l.toUpperCase()),distanceLabel:Number(r.distance_miles)>0?`${Number(r.distance_miles).toFixed(1)} miles`:"No distance target",pace:r.pace_target||r.pace||r.target_pace||"",description:r.description||r.notes||""})}).catch(()=>{}).finally(()=>te(!1)))},[p,c]),a.useEffect(()=>{localStorage.setItem(pe,JSON.stringify(h))},[h]),a.useEffect(()=>{m.get("/gear/shoes").then(t=>{var r;return Oe(((r=t.data)==null?void 0:r.shoes)||[])}).catch(()=>{})},[]),a.useEffect(()=>{p!=="week"||k||(se(!0),m.get("/plans").then(t=>{var o,l,b;const r=(l=(o=t.data)==null?void 0:o.plan)==null?void 0:l.plan_json;(b=r==null?void 0:r.weeks)!=null&&b.length&&Me(r.weeks[0].days||[])}).catch(()=>{}).finally(()=>se(!1)))},[p,k]),a.useEffect(()=>{const t=(n==null?void 0:n.id)||(c==null?void 0:c.id);t&&m.get(`/ai/run-brief?sessionId=${t}`).then(r=>H(r.data||null)).catch(()=>H(null))},[n==null?void 0:n.id,c==null?void 0:c.id]);const S=a.useMemo(()=>{var v;const t=Number(j||((v=c==null?void 0:c.distanceLabel)==null?void 0:v.split(" ")[0])||0);if(!t||O.length===0)return null;const r=O.filter(x=>x.distance_miles>0&&x.duration_seconds>0).map(x=>x.duration_seconds/60/x.distance_miles);if(!r.length)return null;const o=r.reduce((x,L)=>x+L,0)/r.length,l=Math.round(o*.95*t),b=Math.round(o*1.05*t);return{low:l,high:b,avg:o}},[j,c,O]),Ge=async t=>{var o,l,b,v,x,L;t.preventDefault(),$(""),W("");const r=xe(A);if(!r)return $("Please enter a valid duration.");try{Q(!0);const y=g==="inside"?"treadmill":U;if(y==="treadmill"){s("/run/treadmill",{state:{treadmillType:I}});return}const Je=i==="metric"?d.milesFromKm(Number(j)):Number(j),ie=await m.post("/runs",{date:G,type:D,surface:y,run_surface:y,distance_miles:Je,duration_seconds:r,notes:Y,perceived_effort:Number(J),treadmill_brand:I,shoe_id:z||null}),w=((o=ie.data)==null?void 0:o.id)||((b=(l=ie.data)==null?void 0:l.run)==null?void 0:b.id);if(w&&m.post("/prs/auto-detect",{run_id:w}).catch(()=>{}),m.post("/badges/check",{}).catch(()=>{}),!w){W("Feedback coming soon..."),_(!0);return}Te(w),ee(!0),V(!0);let ue=0,F="";for(;ue<5&&!F;)ue+=1,await new Promise(Ke=>setTimeout(Ke,2e3)),F=((v=(await m.get(`/coach/feedback/${w}`)).data)==null?void 0:v.ai_feedback)||"";W(F||"Your coach is thinking... check back after your next run."),_(!0)}catch(y){$(((L=(x=y==null?void 0:y.response)==null?void 0:x.data)==null?void 0:L.error)||"Could not save run. Check your connection and try again.")}finally{Q(!1),V(!1)}},le=a.useMemo(()=>ht(n),[n]),qe=async()=>{if(n)try{const r=(await m.patch(`/runs/${n.id}`,{notes:N})).data||{...n,notes:N};P(r),B(o=>o.map(l=>l.id===r.id?{...l,notes:r.notes}:l))}catch{try{const r=(await m.put(`/runs/${n.id}`,{notes:N})).data||{...n,notes:N};P(r),B(o=>o.map(l=>l.id===r.id?{...l,notes:r.notes}:l))}catch{}}},Ye=async()=>{n&&window.confirm("Are you sure? This can't be undone.")&&(await m.delete(`/runs/${n.id}`),B(t=>t.filter(r=>r.id!==n.id)),P(null))};return Fe?e.jsx("div",{className:"p-4",style:{color:"var(--text-muted)"},children:"Checking today's check-in..."}):He?u==="warmup"?e.jsxs("div",{className:"rounded-2xl p-6",style:{background:"var(--bg-card)"},children:[e.jsx("h2",{className:"text-xl font-black mb-1",style:{color:"var(--text-primary)"},children:"Dynamic Warm-Up"}),e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:"Complete each movement before you run."}),e.jsx("div",{className:"space-y-3 mb-6",children:it.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl p-3",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{style:{width:30,height:30,borderRadius:"50%",background:"var(--accent)",color:"#000",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:900,fontSize:13,flexShrink:0},children:r+1}),e.jsx("span",{style:{color:"var(--text-primary)",fontSize:14,fontWeight:500},children:t})]},r))}),e.jsx("button",{onClick:()=>M("done"),className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer",fontSize:16},children:"Done — Start Run"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsx("div",{className:"flex gap-2 mb-5 flex-wrap",children:[{key:"today",label:"Today"},{key:"week",label:"Week"},{key:"log",label:"Manual"}].map(t=>e.jsx("button",{onClick:()=>E(t.key),style:{padding:"5px 18px",borderRadius:999,border:p===t.key?"1.5px solid var(--accent)":"1.5px solid var(--border-subtle)",background:p===t.key?"var(--accent)":"transparent",color:p===t.key?"#000":"var(--text-muted)",fontWeight:700,fontSize:13,cursor:"pointer"},children:t.label},t.key))}),p==="today"&&e.jsxs("div",{children:[f&&e.jsxs("div",{className:"rounded-xl p-3 mb-3",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:f.why}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:["Effort: ",f.effort," · BPM: ",f.bpmRange," · Cadence: ",f.cadence]})]}),Le?e.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading workout..."}):c?e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("span",{className:"inline-block rounded-full px-3 py-1 text-xs font-bold mb-3",style:{background:"var(--accent)",color:"#000"},children:c.typeLabel}),e.jsx("p",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:c.distanceLabel}),c.pace&&e.jsx("p",{className:"mt-1",style:{color:"var(--text-muted)"},children:c.pace}),c.description&&e.jsx("p",{className:"mt-3 text-sm",style:{color:"var(--text-muted)"},children:c.description}),e.jsx("button",{onClick:()=>ae(!0),className:"w-full mt-4 rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Send to Watch"})]}):e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{style:{color:"var(--text-muted)"},children:"No workout scheduled today — rest up or log a free run."}),e.jsx("button",{onClick:()=>E("log"),className:"mt-4 rounded-xl px-4 py-2 font-semibold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Log Free Run"})]})]}),p==="week"&&e.jsxs("div",{children:[re&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:14},children:"Loading your week..."}),!re&&!k&&e.jsx("div",{style:{textAlign:"center",padding:"24px 0",color:"var(--text-muted)",fontSize:14},children:"No training plan yet. Go to your Plan tab to generate one."}),k&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:(()=>{const t=new Date().toLocaleDateString("en-US",{weekday:"short"});return k.map((r,o)=>{const l=r.day===t,b=Ee===o,v=r.rest?"var(--text-muted)":r.type==="long"?"#3b82f6":"var(--accent)";return e.jsxs("div",{onClick:()=>De(b?null:o),style:{borderRadius:14,padding:"12px 16px",cursor:"pointer",background:l?"var(--accent-dim)":"var(--bg-base)",border:`1.5px solid ${l?"var(--accent)":"var(--border-subtle)"}`,transition:"background 0.15s"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{width:36,textAlign:"center"},children:[e.jsx("p",{style:{fontSize:12,fontWeight:700,color:l?"var(--accent)":"var(--text-muted)"},children:r.day}),l&&e.jsx("p",{style:{fontSize:9,color:"var(--accent)",fontWeight:700},children:"TODAY"})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)",textTransform:"capitalize"},children:r.rest?"Rest Day":r.type==="long"?"Long Run":r.type==="easy"?"Easy Run":String(r.type).replace(/_/g," ")}),!r.rest&&r.distance_miles>0&&e.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)"},children:[Number(r.distance_miles).toFixed(1)," miles"]})]})]}),e.jsx("span",{style:{fontSize:11,fontWeight:700,color:v,background:r.rest?"var(--bg-card)":"transparent",padding:"3px 8px",borderRadius:8,border:`1px solid ${v}`},children:r.rest?"Rest":r.type==="long"?"Long":"Easy"})]}),b&&e.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid var(--border-subtle)"},children:[r.description&&e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",lineHeight:1.6,marginBottom:12},children:r.description}),!r.rest&&e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12},children:[r.distance_miles>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:Number(r.distance_miles).toFixed(1)}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"miles"})]}),r.duration_min>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:r.duration_min}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"minutes"})]}),r.pace_target&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:r.pace_target}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"target pace"})]})]}),!r.rest&&l&&e.jsx("button",{onClick:x=>{x.stopPropagation(),s("/run/active",{state:{countdown:ve,runType:r.type||"easy",runEnvironment:"outdoor",surface:C==="yes"?"track":"road",mapMyRun:!0,trackMode:C==="yes"}})},style:{width:"100%",background:"var(--accent)",color:"#000",fontWeight:900,borderRadius:10,padding:"12px",border:"none",cursor:"pointer",fontSize:14},children:"Start This Run"})]})]},o)})})()})]}),p==="log"&&e.jsxs("form",{onSubmit:Ge,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm mb-2",style:{color:"var(--text-primary)"},children:"Run type"}),e.jsx("div",{className:"flex gap-2 mb-4",children:["easy","tempo","long","walk"].map(t=>e.jsx("button",{type:"button",onClick:()=>ge(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:D===t?"var(--accent)":"var(--bg-card)",color:D===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t==="walk"?"Walk":t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("p",{className:"text-sm mb-2",style:{color:"var(--text-primary)"},children:"Are you running outside or inside?"}),e.jsx("div",{className:"flex gap-2",children:["outside","inside"].map(t=>e.jsx("button",{type:"button",onClick:()=>fe(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:g===t?"var(--accent)":"var(--bg-card)",color:g===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),g==="outside"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Are you doing a track workout?"}),e.jsx("div",{className:"flex gap-2",children:["yes","no"].map(t=>e.jsx("button",{type:"button",onClick:()=>ke(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:C===t?"var(--accent)":"var(--bg-card)",color:C===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t==="yes"?"Yes (track intervals)":"No (road run)"},t))})]}),g==="inside"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"What treadmill are you using?"}),e.jsx("select",{value:I,onChange:t=>je(t.target.value),className:"w-full rounded-xl px-3 py-2",style:{background:"var(--bg-card)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},children:["Generic","Peloton","NordicTrack","Precor","Life Fitness","Other"].map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("input",{type:"number",step:"0.1",min:"0",required:!0,className:"text-5xl font-bold bg-transparent text-center w-32 focus:outline-none",style:{color:"var(--accent)"},value:j,onChange:t=>Se(t.target.value),placeholder:"0.0"}),e.jsxs("div",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:["Distance (",d.distanceLabel,")"]}),S&&e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:["Estimated time: ",S.low,"–",S.high," min based on your recent ",Math.floor(S.avg),":",String(Math.round(S.avg%1*60)).padStart(2,"0"),"/mi average pace"]})]})}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:e.jsx("div",{className:"flex gap-2 justify-center",children:e.jsx("input",{type:"text",required:!0,value:A,onChange:t=>q(t.target.value),onBlur:()=>{const t=xe(A);t&&q(et(t))},placeholder:"MM:SS or HH:MM:SS",className:"w-full max-w-xs rounded-full border px-4 py-3 text-center text-xl font-bold",style:{borderColor:"var(--border-subtle)",background:"var(--bg-card)",color:"var(--text-primary)"}})})}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:e.jsx("textarea",{rows:4,placeholder:"How did it feel? Anything worth remembering?",value:Y,onChange:t=>we(t.target.value),className:"w-full rounded-xl border px-4 py-3",style:{borderColor:"var(--border-subtle)",background:"var(--bg-card)",color:"var(--text-primary)"}})}),e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"flex gap-2 mb-4",children:ut.map(t=>{const r=t.icon,o=U===t.value;return e.jsxs("button",{type:"button",onClick:()=>ye(t.value),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:5,padding:"10px 4px",borderRadius:12,border:o?"2px solid var(--accent)":"2px solid var(--border-subtle)",background:o?"var(--bg-card)":"var(--bg-base)",color:o?"var(--accent)":"var(--text-muted)",cursor:"pointer",fontSize:11,fontWeight:700},children:[e.jsx(r,{size:20}),e.jsx("span",{children:t.label})]},t.value)})}),e.jsx(vt,{effort:J,setEffort:Ce})]}),T.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:6},children:"Running In"}),((ce=T.find(t=>t.id===z))==null?void 0:ce.alert)&&e.jsxs("p",{style:{fontSize:11,color:"#f97316",marginBottom:4},children:["This shoe is at ",(de=T.find(t=>t.id===z))==null?void 0:de.pct_used,"% — consider rotating to a fresh pair"]}),e.jsxs("select",{value:z,onChange:t=>Be(t.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)",fontSize:14},children:[e.jsx("option",{value:"",children:"No shoe selected"}),T.map(t=>e.jsxs("option",{value:t.id,children:[t.brand," ",t.model,t.nickname?` (${t.nickname})`:""," — ",t.total_miles," mi"]},t.id))]}),e.jsx("button",{onClick:()=>window.location.href="/gear",style:{background:"none",border:"none",color:"var(--text-muted)",fontSize:12,cursor:"pointer",padding:"4px 0",textDecoration:"underline",marginTop:8},children:"Manage shoes / add new pair"})]}),e.jsx("input",{type:"date",value:G,onChange:t=>Ne(t.target.value),className:"w-full rounded-xl border px-4 py-3",style:{borderColor:"var(--border-subtle)",background:"var(--bg-base)",color:"var(--text-primary)"}}),e.jsx("button",{type:"submit",disabled:K||_e,className:"w-full rounded-xl py-3 font-semibold disabled:opacity-70",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:K?"Logging run...":"Save Run"}),Z&&e.jsx("p",{className:"mt-2 text-sm",style:{color:"var(--accent)"},children:Z}),X&&e.jsx("div",{className:"mt-2 rounded-xl p-3",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:X}),R&&e.jsx("div",{className:"mt-4",children:e.jsx(rt,{activityId:R,activityType:"run"})})]}),e.jsx(Ze,{to:"/",className:"mt-5 inline-block text-sm",style:{color:"var(--text-muted)"},children:"← Back"})]}),Ie&&e.jsx(yt,{workout:c,onClose:()=>ae(!1)}),n&&e.jsxs("div",{className:"fixed inset-0 z-50",style:{background:"var(--bg-base)"},children:[e.jsxs("div",{className:"h-full overflow-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>P(null),style:{color:"var(--text-primary)"},children:"← Back"}),e.jsx("h3",{className:"font-bold",style:{color:"var(--text-primary)"},children:"Run Detail"}),e.jsx("button",{onClick:()=>oe(!0),style:{color:"var(--text-primary)"},children:e.jsx(ot,{size:18})})]}),h.overview&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Overview"}),e.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:n.date}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:n.surface||n.run_surface||"road"}),e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:["Effort ",n.perceived_effort||5,"/10"]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:n.type})]})]}),h.stats&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Stats"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Distance"}),e.jsxs("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:[n.distance_miles||0," mi"]})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Time"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:pt(n.duration_seconds||0)})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Avg Pace"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:bt(n.duration_seconds,n.distance_miles)})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Calories"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:n.calories||"—"})]})]})]}),h.pace&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Pace Chart"}),le.length?e.jsx("svg",{width:"100%",height:"120",viewBox:"0 0 320 120",children:le.map((t,r)=>{const o=Number(t.seconds||t.pace_seconds||t.value||0),l=Math.max(10,100-Math.min(90,Math.floor(o/10)));return e.jsx("rect",{x:10+r*30,y:110-l,width:"20",height:l,fill:"var(--accent)"},r)})}):e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"GPS splits available in the mobile app"})]}),h.hr&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Heart Rate"}),n.avg_hr||n.avg_heart_rate?e.jsxs("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:[n.avg_hr||n.avg_heart_rate," bpm"]}):e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Connect a watch to see HR data"})]}),h.notes&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Notes"}),e.jsx("textarea",{rows:5,value:N,onChange:t=>$e(t.target.value),className:"w-full rounded-xl border px-3 py-2",style:{borderColor:"var(--border-subtle)",background:"var(--bg-base)",color:"var(--text-primary)"}}),e.jsx("button",{onClick:qe,className:"mt-2 rounded-lg px-3 py-2 text-sm font-semibold",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Save Notes"})]}),e.jsx("button",{onClick:Ye,className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--bg-card)",color:"var(--accent)",border:"1px solid var(--accent)"},children:"Delete Run"})]}),Ae&&e.jsxs("div",{className:"fixed inset-x-0 bottom-0 z-10 rounded-t-2xl p-4",style:{background:"var(--bg-card)",borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-bold mb-3",style:{color:"var(--text-primary)"},children:"Customize Panels"}),Object.entries({overview:"Overview",stats:"Stats Grid",pace:"Pace Chart",hr:"Heart Rate",notes:"Notes"}).map(([t,r])=>e.jsxs("label",{className:"flex items-center justify-between py-2",style:{color:"var(--text-primary)"},children:[e.jsx("span",{children:r}),e.jsx("input",{type:"checkbox",checked:h[t],onChange:o=>We(l=>({...l,[t]:o.target.checked}))})]},t)),e.jsx("button",{onClick:()=>oe(!1),className:"w-full mt-3 rounded-xl py-2",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Done"})]})]}),Pe&&R&&e.jsx(tt,{runId:R,onDone:()=>{ee(!1),s("/")}}),Re&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)"},children:e.jsxs("div",{className:"w-full max-w-sm rounded-2xl p-5",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h3",{className:"text-xl font-black",style:{color:"var(--text-primary)"},children:"Great run! Time to recover."}),e.jsx("p",{className:"mt-2 text-sm",style:{color:"var(--text-muted)"},children:"Post-run recovery uses static holds. Hold each stretch for the full duration to target the muscles you just used."}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{_(!1),s("/stretches/session?type=post")},className:"flex-1 rounded-xl px-4 py-2 font-bold",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Start Recovery"}),e.jsx("button",{onClick:()=>_(!1),className:"flex-1 rounded-xl px-4 py-2",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)",color:"var(--text-muted)"},children:"Skip"})]})]})})]}):e.jsxs("div",{className:"rounded-2xl p-6",style:{background:"var(--bg-card)"},children:[e.jsx("h2",{className:"text-xl font-black mb-2",style:{color:"var(--text-primary)"},children:"Morning Check-In Required"}),e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:"Complete your morning check-in before starting a run."}),e.jsx("button",{onClick:()=>s("/checkin"),className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Go to Check-In"})]})}export{Lt as default};
