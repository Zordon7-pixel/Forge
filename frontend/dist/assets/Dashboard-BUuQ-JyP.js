import{b as Le,c as Be,u as Ie,r as a,a as h,j as e,R as te}from"./index-BaOvKJ5T.js";import{A as Ge}from"./AchievementUnlock-BnW6bq5U.js";import{L as Ee}from"./LoadingRunner-C88D-dCI.js";import{F as He}from"./flame-DPoPXVJY.js";import{A as Ue,a as Pe}from"./arrow-up-right-BzFpnqvU.js";import{W as Fe}from"./watch-3HsPBlXE.js";function se(s){if(!s)return"0 min";const n=Math.floor(s/3600),i=Math.floor(s%3600/60);return n>0?i>0?`${n}h ${i}min`:`${n}h`:`${i} min`}function Oe(s){if(!s)return"0m";const n=Math.floor(s/3600),i=Math.floor(s%3600/60);return n>0?`${n}h ${i}m`:`${i}m`}function E(s,n=900){const[i,d]=te.useState(0);return te.useEffect(()=>{if(!s){d(0);return}let r=0;const v=s/(n/16),u=setInterval(()=>{r+=v,r>=s?(d(s),clearInterval(u)):d(Math.floor(r))},16);return()=>clearInterval(u)},[s,n]),i}function Ve({data:s=[]}){if(!s.length)return null;const n=Math.max(...s.map(u=>u.miles),1),i=100,d=40,r=s.map((u,x)=>{const f=x/(s.length-1)*i,_=d-u.miles/n*d;return`${f},${_}`}).join(" "),v=`0,${d} `+r+` ${i},${d}`;return e.jsxs("svg",{viewBox:`0 0 ${i} ${d}`,className:"w-full h-16",preserveAspectRatio:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"trendGrad",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"var(--accent)",stopOpacity:"0.4"}),e.jsx("stop",{offset:"100%",stopColor:"var(--accent)",stopOpacity:"0"})]})}),e.jsx("polygon",{points:v,fill:"url(#trendGrad)"}),e.jsx("polyline",{points:r,fill:"none",stroke:"var(--accent)",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),s.map((u,x)=>{const f=x/(s.length-1)*i,_=d-u.miles/n*d;return u.miles>0?e.jsx("circle",{cx:f,cy:_,r:"1.5",fill:"var(--accent)"},x):null})]})}function Ye({score:s,onClick:n}){const v=2*Math.PI*28,u=s/100*v,x=s>=75?"#22c55e":s>=50?"var(--accent)":"#ef4444",f=s>=80?"Optimal":s>=60?"Good":s>=40?"Moderate":"Low";return e.jsxs("div",{onClick:n,style:{cursor:"pointer"},className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("svg",{width:"72",height:"72",viewBox:"0 0 72 72",children:[e.jsx("circle",{cx:36,cy:36,r:28,fill:"none",stroke:"var(--border-subtle)",strokeWidth:"5"}),e.jsx("circle",{cx:36,cy:36,r:28,fill:"none",stroke:x,strokeWidth:"5",strokeDasharray:`${u} ${v}`,strokeLinecap:"round",transform:"rotate(-90 36 36)"}),e.jsx("text",{x:36,y:37,textAnchor:"middle",dominantBaseline:"middle",fontSize:"13",fontWeight:"bold",fill:x,children:s})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-base",style:{color:"var(--text-primary)"},children:f}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:"Training readiness"}),e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)",opacity:.7},children:s>=75?"Go hard today.":s>=50?"Moderate effort.":"Take it easy today."})]})]}),e.jsx("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)",opacity:.6},children:"Tap to see breakdown"})]})}function Ke(){const[s,n]=a.useState(null),[i,d]=a.useState(!1),[r,v]=a.useState(!1);a.useEffect(()=>{const f=localStorage.getItem("forge_token");if(!f)return;fetch("/api/watch-sync/status",{headers:{Authorization:`Bearer ${f}`}}).then(p=>p.ok?p.json():null).then(p=>n(p)).catch(()=>{});const _=setInterval(()=>{fetch("/api/watch-sync/status",{headers:{Authorization:`Bearer ${f}`}}).then(p=>p.ok?p.json():null).then(p=>{p&&s&&p.synced_at!==(s==null?void 0:s.synced_at)&&(v(!0),setTimeout(()=>v(!1),3e3)),n(p)}).catch(()=>{})},1e4);return()=>clearInterval(_)},[]);const u=(s==null?void 0:s.treadmill_brand)||(s==null?void 0:s.watch_mode)||null,x=s&&(s.avg_heart_rate||s.distance_miles);return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("style",{children:`
        @keyframes watchPulse { 0%,100% { box-shadow: 0 0 0 0 rgba(234,179,8,0.4); } 50% { box-shadow: 0 0 0 8px rgba(234,179,8,0); } }
        @keyframes syncFlash { 0% { background: rgba(34,197,94,0.3); } 100% { background: transparent; } }
      `}),e.jsxs("button",{onClick:()=>{d(!0),setTimeout(()=>d(!1),1500)},style:{display:"flex",alignItems:"center",gap:6,background:x?"rgba(234,179,8,0.1)":"var(--bg-input)",border:`1px solid ${x?"rgba(234,179,8,0.4)":"var(--border-subtle)"}`,borderRadius:10,padding:"6px 12px",cursor:"pointer",animation:i?"watchPulse 1s ease-in-out infinite":"none",transition:"all 0.3s ease",...r?{animation:"syncFlash 1s ease forwards"}:{}},children:[e.jsx(Fe,{size:14,color:x?"#EAB308":"var(--text-muted)"}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsx("p",{style:{fontSize:9,color:"var(--text-muted)",margin:0,letterSpacing:.5,textTransform:"uppercase"},children:u||"Watch"}),e.jsx("p",{style:{fontSize:11,fontWeight:700,color:x?"#EAB308":"var(--text-muted)",margin:0},children:r?"Synced!":x?`HR ${s.avg_heart_rate||"--"} bpm`:"No data"})]}),x&&e.jsx("div",{style:{width:6,height:6,borderRadius:"50%",background:"#22c55e",animation:"watchPulse 2s ease infinite"}})]}),e.jsx("p",{style:{fontSize:9,color:"var(--text-muted)",textAlign:"center",marginTop:2},children:"+ Meta Glasses (soon)"})]})}function nt(){var q,X;const s=Le(),{fmt:n}=Be(),{t:i}=Ie(),d={day:"Today",week:i("dashboard.thisWeek"),month:"This Month",year:"This Year",all:"All Time"},[r,v]=a.useState(null),[u,x]=a.useState([]),[f,_]=a.useState([]),[p,ae]=a.useState(!1),[re,ne]=a.useState(!0),[W,oe]=a.useState("week"),[A,le]=a.useState(!1),[H,ie]=a.useState(!1),[U,ce]=a.useState("auto"),[L,de]=a.useState(null),[Je,Qe]=a.useState(!1),[qe,Xe]=a.useState(""),[ue,B]=a.useState(!1),[l,I]=a.useState(null),[y,P]=a.useState(null),[F,xe]=a.useState([]),[me,he]=a.useState({currentStreak:0,bestStreak:0}),[O,V]=a.useState([]),[Y,K]=a.useState(null),[b,pe]=a.useState(null),[J,ye]=a.useState(!1),[k,ge]=a.useState(null),[G,fe]=a.useState(null),[be,ve]=a.useState(Number(localStorage.getItem("forge_load_warning_dismissed_until")||0)),[je,ke]=a.useState([]),[Se,we]=a.useState(0);a.useEffect(()=>{(async()=>{var t,o,m,g,c,j;try{const[S,R,w,T,M,z,ze,We,De,Me,$e,Ae]=await Promise.all([h.get("/auth/me/stats"),h.get("/runs",{params:{limit:5}}),h.get("/lifts"),h.get("/coach/warning"),h.get("/checkin/today").catch(()=>({data:null})),h.get("/users/goal").catch(()=>({data:null})),h.get("/auth/me/streak").catch(()=>({data:{currentStreak:0,bestStreak:0}})),h.get("/milestones/new").catch(()=>({data:{milestones:[]}})),h.get("/plans/compliance").catch(()=>({data:null})),h.get("/runs/load-analysis").catch(()=>({data:null})),h.get("/races/next").catch(()=>({data:{race:null}})),h.get("/gear/shoes").catch(()=>({data:{shoes:[]}}))]);v(S.data);const Z=Array.isArray(R.data)?R.data:((t=R.data)==null?void 0:t.runs)||[];x(Z),ie(Z.some(N=>N.avg_heart_rate||N.watch_mode||N.route_coords)),_(Array.isArray(w.data)?w.data:((o=w.data)==null?void 0:o.lifts)||[]),ae(((m=T.data)==null?void 0:m.warning)===!0),M.data&&le(!0),z.data&&(ce(z.data.mode||"auto"),de(z.data.miles||null)),he(ze.data||{currentStreak:0,bestStreak:0});const $=((g=We.data)==null?void 0:g.milestones)||[];V($),$.length>0&&K(N=>N||{name:$[0].title,description:$[0].description,icon:"Award",color:"#EAB308"}),pe(De.data),ge(Me.data),fe(((c=$e.data)==null?void 0:c.race)||null),ke((((j=Ae.data)==null?void 0:j.shoes)||[]).filter(N=>N.alert)),h.get("/recap/weekly").then(N=>{var ee;return we(((ee=N.data)==null?void 0:ee.totalCalories)||0)}).catch(()=>{})}finally{ne(!1)}})()},[]),a.useEffect(()=>{const t=localStorage.getItem("forge_last_watch_sync_seen_at")||"1970-01-01T00:00:00";h.get("/watch-sync/recent",{params:{since:t}}).then(o=>{var g;const m=((g=o.data)==null?void 0:g.items)||[];m.length&&(xe(m.filter(c=>c.routed_section==="other")),P(m[0]))}).catch(()=>{})},[]);const{readiness:C,readinessBreakdown:Ne}=a.useMemo(()=>{var M;if(!r||!A||!H)return{readiness:null,readinessBreakdown:[]};const{streak:t,week:o,all:m}=r;let g=50;const c=[];c.push({label:"Base score",value:50,delta:0,reason:"Starting point for all athletes."});const j=Math.min(t*4,20);g+=j,c.push({label:"Consistency streak",value:j,delta:j,reason:t>0?`${t}-day active streak adds +${j} pts. Staying consistent pays off.`:"No active streak. Logging runs builds your streak bonus."});const S=m.miles/Math.max((M=r.weeklyTrend)==null?void 0:M.filter(z=>z.miles>0).length,1),R=S>0?o.miles/S:0;let w=0,T="";return R<.5?(w=15,T=`This week you ran ${n.distance(o.miles,1)} vs your avg ${n.distance(S,1)} — low volume means your legs are fresh.`):R>1.3?(w=-15,T=`This week you ran ${n.distance(o.miles,1)} vs your avg ${n.distance(S,1)} — high volume week, body needs recovery.`):T=`This week (${n.distance(o.miles,1)}) is on par with your average (${n.distance(S,1)}) — balanced load.`,g+=w,c.push({label:"Weekly load",value:w,delta:w,reason:T}),{readiness:Math.max(1,Math.min(99,Math.round(g))),readinessBreakdown:c}},[r,A,H]);a.useMemo(()=>{var g;if(!r)return null;const t=((g=r.month)==null?void 0:g.miles)||0;let o;U==="manual"&&L?o=L:o=Math.max(25,Math.ceil(t/25)*25+(t>=25?25:0));const m=Math.min(t/o*100,100);return{miles:t,goal:o,pct:m}},[r,U,L]);const D=(r==null?void 0:r[W])||{},_e=E(Math.round((D.miles||0)*10),900),Re=E(D.count||0,900);E(me.currentStreak||0,900);const Q=a.useMemo(()=>{const t=u.slice(0,3).map(c=>({...c,_type:"run"})),o=(f||[]).slice(0,3).map(c=>({...c,_type:"lift"})),m=(F||[]).slice(0,3).map(c=>({...c,_type:"other"}));return[...t,...o,...m].sort((c,j)=>{const S=c.date||c.started_at||c.created_at||"";return(j.date||j.started_at||j.created_at||"").localeCompare(S)}).slice(0,4)},[u,f,F]),Ce=k&&["elevated","high","danger"].includes(k.loadStatus)&&Date.now()>be,Te=(b==null?void 0:b.score)>=80?"#22c55e":(b==null?void 0:b.score)>=50?"#EAB308":"#ef4444";return re?e.jsx(Ee,{message:"Getting ready"}):e.jsxs("div",{className:"space-y-4",children:[Y&&e.jsx(Ge,{badge:Y,onDismiss:()=>K(null)}),e.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes ringClose {
          0% { opacity: 1; stroke-dasharray: 157 0; }
          80% { opacity: 1; stroke-dasharray: 157 0; }
          100% { opacity: 0; stroke-dasharray: 157 0; }
        }
      `}),e.jsx(Ke,{}),Ce&&e.jsxs("div",{className:"rounded-xl p-3",style:{background:k.loadStatus==="danger"?"rgba(239,68,68,0.12)":k.loadStatus==="high"?"rgba(249,115,22,0.12)":"rgba(234,179,8,0.12)",border:`1px solid ${k.loadStatus==="danger"?"rgba(239,68,68,0.35)":k.loadStatus==="high"?"rgba(249,115,22,0.35)":"rgba(234,179,8,0.35)"}`},children:[e.jsxs("p",{className:"text-xs font-bold uppercase",style:{color:"var(--text-primary)"},children:[k.loadStatus," load"]}),e.jsx("p",{className:"text-sm mt-1",style:{color:"var(--text-primary)"},children:k.warning||k.recommendation}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{className:"rounded-lg px-3 py-1.5 text-xs font-bold",style:{background:"var(--accent)",color:"#000"},onClick:()=>s("/plan",{state:{suggestEasyDay:!0}}),children:"Take Easy Day"}),e.jsx("button",{className:"rounded-lg px-3 py-1.5 text-xs",style:{background:"var(--bg-input)",color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},onClick:()=>{const t=Date.now()+864e5;localStorage.setItem("forge_load_warning_dismissed_until",String(t)),ve(t)},children:"OK"})]})]}),G&&(()=>{const t=Math.ceil((new Date(`${G.race_date}T12:00:00`).getTime()-Date.now())/864e5);return t>0&&t<=60?e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Next Race"}),e.jsx("p",{className:"text-base font-bold",style:{color:"var(--text-primary)"},children:G.race_name}),e.jsxs("p",{className:"text-sm",style:{color:"var(--accent)"},children:[t," days to go"]})]}):null})(),b&&e.jsxs("div",{className:"rounded-xl p-4",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},onClick:()=>ye(!J),children:[e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:[i("dashboard.thisWeek"),": ",b.completed,"/",b.planned," sessions — ",b.score,"%"]}),e.jsx("div",{className:"w-full h-2 rounded-full mt-2",style:{background:"var(--bg-input)"},children:e.jsx("div",{className:"h-2 rounded-full",style:{width:`${b.score}%`,background:Te}})}),J&&e.jsx("div",{className:"mt-3 space-y-1",children:(b.sessions||[]).map((t,o)=>e.jsxs("p",{className:"text-xs",style:{color:t.completed?"#22c55e":"#ef4444"},children:[t.day,": ",t.type," ",t.completed?"hit":"missed"]},o))})]}),O.length>0&&e.jsx("div",{className:"space-y-2",children:O.map(t=>e.jsxs("div",{className:"rounded-xl p-3 flex items-center justify-between",style:{background:"rgba(234,179,8,0.12)",border:"1px solid rgba(234,179,8,0.3)"},children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:t.title}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:t.description})]}),e.jsx("button",{onClick:()=>V(o=>o.filter(m=>m.key!==t.key)),className:"text-xs",style:{color:"var(--text-muted)"},children:"Dismiss"})]},t.key))}),!A&&e.jsxs("a",{href:"/checkin",style:{display:"block",background:"rgba(234,179,8,0.12)",border:"1px solid rgba(234,179,8,0.3)",borderRadius:14,padding:"12px 16px",marginBottom:12,textDecoration:"none"},children:[e.jsx("p",{style:{color:"var(--accent)",fontWeight:700,fontSize:14,margin:0},children:"Quick check-in — 3 taps"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:12,margin:"2px 0 0"},children:"Help me adjust today's plan around your day"})]}),y&&e.jsxs("div",{className:"rounded-xl p-3",style:{background:"rgba(234,179,8,0.12)",border:"1px solid rgba(234,179,8,0.3)"},children:[e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--text-primary)"},children:["New activity synced from your watch — ",y.activity_name,". View it in ",y.routed_section==="lift"?"Lift":y.routed_section==="other"?"History":"Run"," tab."]}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("button",{onClick:()=>{localStorage.setItem("forge_last_watch_sync_seen_at",y.synced_at),y.routed_section==="lift"?s("/log-lift"):y.normalized_type==="treadmill"?s("/run/treadmill",{state:{incline:y.incline_pct,speed:y.belt_speed_mph,durationSeconds:y.duration_seconds,treadmillType:y.treadmill_brand||"Generic",watchMetrics:y}}):s("/log-run")},className:"rounded-lg px-3 py-1.5 text-xs font-bold",style:{background:"var(--accent)",color:"#000"},children:"View"}),e.jsx("button",{onClick:()=>{localStorage.setItem("forge_last_watch_sync_seen_at",y.synced_at),P(null)},className:"rounded-lg px-3 py-1.5 text-xs",style:{background:"var(--bg-input)",color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:"Dismiss"})]})]}),e.jsxs("div",{className:"rounded-2xl p-6 flex flex-col items-center",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h2",{className:"text-2xl font-black mb-1",style:{color:"var(--text-primary)"},children:"Ready to Run?"}),e.jsx("p",{className:"text-sm mb-10 text-center",style:{color:"var(--text-muted)"},children:"Dynamic warm-up reduces injury risk and improves performance."}),e.jsxs("button",{onClick:()=>s("/log-run?warmup=true"),className:"rounded-full w-28 h-28 mb-3 font-black flex flex-col items-center justify-center",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:[e.jsx(He,{className:"mb-1"}),e.jsx("span",{className:"text-xs font-black",children:"Start Warm-Up"})]}),e.jsx("button",{onClick:()=>s("/log-run"),style:{background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",fontSize:14,padding:"8px 0"},children:"Skip warm-up"})]}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:C===null?e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Complete your daily check-in and sync your watch to unlock your Training Readiness score"}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{score:C,onClick:()=>B(!0)}),e.jsx("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:"Based on your HRV, sleep, soreness, and energy levels"})]})}),(r==null?void 0:r.calendarDays)&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsx("p",{className:"text-xs font-medium mb-3",style:{color:"var(--text-muted)"},children:i("dashboard.thisWeek")}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:r.calendarDays.map(t=>e.jsxs("div",{className:"flex flex-col items-center gap-1",onClick:()=>I(t),style:{cursor:"pointer"},children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.6},children:t.day}),e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border",style:{background:t.hasRun||t.hasLift?"var(--accent)":"var(--bg-input)",borderColor:t.isToday?"var(--accent)":"transparent",borderWidth:t.isToday?2:1},children:t.hasRun&&t.hasLift?e.jsx("span",{className:"text-xs font-bold text-black",children:"R+L"}):t.hasRun?e.jsx("span",{className:"text-xs font-bold text-black",children:"R"}):t.hasLift?e.jsx("span",{className:"text-xs font-bold text-black",children:"L"}):e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.4},children:"·"})})]},t.date))})]}),e.jsxs("div",{className:"rounded-2xl p-4 space-y-3",style:{background:"var(--bg-card)"},children:[e.jsx("div",{className:"flex gap-2",children:[{key:"day",label:"D"},{key:"week",label:"W"},{key:"month",label:"M"},{key:"all",label:"All"}].map(({key:t,label:o})=>e.jsx("button",{onClick:()=>oe(t),className:"px-4 py-1.5 rounded-full text-xs font-semibold transition-all",style:W===t?{background:"var(--accent)",color:"#000"}:{background:"var(--bg-input)",color:"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:o},t))}),e.jsx("p",{className:"text-xs",style:{color:"var(--text-muted)"},children:d[W]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-5xl font-black tabular-nums",style:{color:"var(--text-primary)"},children:n.distanceValue(_e/10).toFixed(1)}),e.jsxs("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:[n.distanceLabel.charAt(0).toUpperCase()+n.distanceLabel.slice(1),"s"]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{label:"Runs",value:Re},{label:"Time",value:Oe(D.seconds)},{label:"Cal",value:W==="week"?Se.toLocaleString():(D.calories||0).toLocaleString()}].map((t,o)=>{const m=o%2===0;return e.jsxs("div",{className:"rounded-lg p-2",style:{border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:t.value}),e.jsxs("p",{className:"text-xs flex items-center gap-1",style:{color:"var(--text-muted)"},children:[t.label,m?e.jsx(Ue,{size:12,color:"#22c55e"}):e.jsx(Pe,{size:12,color:"#ef4444"})]})]},t.label)})})]}),(r==null?void 0:r.weeklyTrend)&&r.weeklyTrend.some(t=>t.miles>0)&&e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-xs font-medium",style:{color:"var(--text-muted)"},children:"Past 12 Weeks"}),e.jsxs("p",{className:"text-xs font-semibold",style:{color:"var(--accent)"},children:[n.distance((q=r.weeklyTrend[r.weeklyTrend.length-1])==null?void 0:q.miles,1)," last week"]})]}),e.jsx(Ve,{data:r.weeklyTrend}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.5},children:new Date((X=r.weeklyTrend[0])==null?void 0:X.week).toLocaleDateString("en-US",{month:"short"})}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)",opacity:.5},children:"Now"})]})]}),p&&e.jsx("div",{className:"rounded-xl border p-3 text-sm",style:{borderColor:"rgba(234,179,8,0.3)",background:"rgba(234,179,8,0.08)",color:"var(--accent)"},children:"Heavy legs detected — consider a rest day or easy run today"}),je.map(t=>e.jsxs("div",{style:{background:"rgba(249,115,22,0.08)",border:"1px solid rgba(249,115,22,0.3)",borderRadius:12,padding:"10px 14px"},children:[e.jsxs("p",{style:{fontSize:13,fontWeight:700,color:"#f97316",margin:0},children:[t.brand," ",t.model," is at ",t.pct_used,"% — ",t.pct_used>=100?"replace now":"start looking for a replacement"]}),e.jsxs("p",{style:{fontSize:11,color:"var(--text-muted)",margin:"2px 0 0"},children:[t.total_miles," of ",t.recommended_miles," miles used"]})]},t.id)),e.jsxs("section",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsx("h3",{className:"text-base font-bold mb-3",style:{color:"var(--text-primary)",borderBottom:"1px solid rgba(234,179,8,0.45)",paddingBottom:6},children:"Recent Activity"}),e.jsxs("div",{className:"space-y-3",children:[Q.map(t=>t._type==="run"?e.jsxs("div",{onClick:()=>s(`/history?runId=${t.id}`),className:"rounded-xl p-3 border",style:{background:"var(--bg-input)",borderColor:"var(--border-subtle)",borderLeft:"4px solid #EAB308",cursor:"pointer"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium",style:{background:"var(--accent-dim)",color:"var(--accent)"},children:"Run"}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:new Date(t.date||t.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsxs("div",{className:"flex gap-4 mt-1",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:n.distance(Number(t.distance_miles||0),2)})}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:n.pace(t.duration_seconds/t.distance_miles)})}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:se(t.duration_seconds)})}),t.calories>0&&e.jsx("div",{children:e.jsxs("p",{className:"text-sm font-bold",style:{color:"var(--text-primary)"},children:[t.calories," cal"]})})]})]},t.id):t._type==="other"?e.jsxs("div",{className:"rounded-xl p-3 border",style:{background:"var(--bg-input)",borderColor:"var(--border-subtle)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium",style:{background:"rgba(234,179,8,0.2)",color:"var(--accent)"},children:"Other Activity"}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:new Date(t.synced_at||t.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsx("p",{className:"text-sm font-bold mt-1",style:{color:"var(--text-primary)"},children:t.activity_name||t.activity_type||"Synced activity"})]},t.id):e.jsxs("div",{onClick:()=>s(`/history?workoutId=${t.id}`),className:"rounded-xl p-3 border",style:{background:"var(--bg-input)",borderColor:"var(--border-subtle)",borderLeft:"4px solid #ffffff",cursor:"pointer"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium",style:{background:"rgba(139,92,246,0.15)",color:"#a78bfa"},children:"Lift"}),e.jsx("span",{className:"text-xs",style:{color:"var(--text-muted)"},children:new Date(t.date||t.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsx("p",{className:"text-sm font-bold mt-1",style:{color:"var(--text-primary)"},children:t.exercise_name||(Array.isArray(t.muscle_groups)?t.muscle_groups.join(", "):"Workout")}),t.sets&&e.jsxs("p",{className:"text-xs mt-0.5",style:{color:"var(--text-muted)"},children:[t.sets," sets · ",t.reps," reps · ",t.weight_lbs," lbs"]})]},t.id)),Q.length===0&&e.jsx("p",{className:"text-sm py-4 text-center",style:{color:"var(--text-muted)"},children:i("dashboard.noActivity")})]})]}),l&&e.jsx("div",{onClick:()=>I(null),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",zIndex:50,display:"flex",alignItems:"flex-end"},children:e.jsxs("div",{onClick:t=>t.stopPropagation(),style:{background:"var(--bg-card)",borderRadius:"20px 20px 0 0",padding:24,width:"100%",maxHeight:"60vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:new Date(l.date+"T12:00:00").toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}),e.jsx("p",{style:{fontSize:20,fontWeight:900,color:"var(--text-primary)"},children:l.hasRun||l.hasLift?"Active Day":"Rest Day"})]}),e.jsx("button",{onClick:()=>I(null),style:{background:"var(--bg-input)",border:"none",borderRadius:10,padding:"8px 14px",color:"var(--text-muted)",cursor:"pointer",fontSize:13},children:"Close"})]}),l.run&&e.jsxs("div",{style:{background:"var(--bg-base)",borderRadius:14,padding:16,marginBottom:12},children:[e.jsx("p",{style:{fontSize:11,fontWeight:700,color:"var(--accent)",letterSpacing:1,textTransform:"uppercase",marginBottom:10},children:"Run"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:22,fontWeight:900,color:"var(--text-primary)"},children:Number(l.run.distance||0).toFixed(2)}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"miles"})]}),l.run.duration>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:22,fontWeight:900,color:"var(--text-primary)"},children:se(l.run.duration)}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"duration"})]}),l.run.distance>0&&l.run.duration>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:22,fontWeight:900,color:"var(--text-primary)"},children:(()=>{const t=l.run.duration/l.run.distance;return`${Math.floor(t/60)}:${String(Math.round(t%60)).padStart(2,"0")}`})()}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"avg pace /mi"})]}),l.run.surface&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)",textTransform:"capitalize"},children:l.run.surface}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"surface"})]})]}),l.run.notes&&e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",marginTop:12,lineHeight:1.5,borderTop:"1px solid var(--border-subtle)",paddingTop:10},children:l.run.notes})]}),l.lifts&&e.jsxs("div",{style:{background:"var(--bg-base)",borderRadius:14,padding:16,marginBottom:12},children:[e.jsx("p",{style:{fontSize:11,fontWeight:700,color:"var(--accent)",letterSpacing:1,textTransform:"uppercase",marginBottom:8},children:"Strength"}),e.jsxs("p",{style:{fontSize:20,fontWeight:900,color:"var(--text-primary)"},children:[l.lifts," workout session",l.lifts>1?"s":""]})]}),!l.hasRun&&!l.hasLift&&e.jsxs("div",{style:{background:"var(--bg-base)",borderRadius:14,padding:20,textAlign:"center"},children:[e.jsx("p",{style:{fontSize:15,fontWeight:700,color:"var(--text-primary)",marginBottom:6},children:"Rest day"}),e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",lineHeight:1.6},children:l.isToday?"No activity logged yet today.":"Recovery is part of training. Rest days make you stronger."})]})]})}),ue&&e.jsx("div",{onClick:()=>B(!1),style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",zIndex:50,display:"flex",alignItems:"flex-end"},children:e.jsxs("div",{onClick:t=>t.stopPropagation(),style:{background:"var(--bg-card)",borderRadius:"20px 20px 0 0",padding:24,width:"100%",maxHeight:"70vh",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"Training Readiness"}),e.jsxs("p",{style:{fontSize:28,fontWeight:900,color:"var(--accent)"},children:[C," ",e.jsx("span",{style:{fontSize:14,fontWeight:400,color:"var(--text-muted)"},children:"/ 100"})]}),e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",marginTop:2},children:C>=80?"Go hard today.":C>=60?"Moderate effort — push but listen to your body.":C>=40?"Take it easy — a recovery run or rest day is smart.":"Rest today. Your body is telling you something."})]}),e.jsx("button",{onClick:()=>B(!1),style:{background:"var(--bg-input)",border:"none",borderRadius:10,padding:"8px 14px",color:"var(--text-muted)",cursor:"pointer",fontSize:13},children:"Close"})]}),e.jsx("p",{style:{fontSize:11,fontWeight:700,color:"var(--text-muted)",letterSpacing:1,textTransform:"uppercase",marginBottom:12},children:"Score Breakdown"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:Ne.map((t,o)=>e.jsxs("div",{style:{background:"var(--bg-base)",borderRadius:12,padding:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsx("p",{style:{fontSize:13,fontWeight:700,color:"var(--text-primary)"},children:t.label}),e.jsx("p",{style:{fontSize:13,fontWeight:700,color:t.delta>0?"#22c55e":t.delta<0?"#ef4444":"var(--text-muted)"},children:t.delta>0?`+${t.delta}`:t.delta<0?`${t.delta}`:`${t.value}`})]}),e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",lineHeight:1.5},children:t.reason})]},o))}),e.jsxs("div",{style:{marginTop:20,padding:14,background:"var(--bg-base)",borderRadius:12,borderLeft:"3px solid var(--accent)"},children:[e.jsx("p",{style:{fontSize:12,fontWeight:700,color:"var(--accent)",marginBottom:6},children:"How to improve your score"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",lineHeight:1.6},children:"Log runs consistently to build your streak. Keep weekly mileage within 10–20% of your average. Connect your Garmin for HRV and sleep data — that unlocks a much more accurate score."})]})]})})]})}export{nt as default};
