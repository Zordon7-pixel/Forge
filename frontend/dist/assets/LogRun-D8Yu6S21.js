import{d as ge,b as Xe,e as Ze,c as et,r as a,a as p,j as e,L as tt}from"./index-vmUng2Mm.js";import{p as pe,f as rt}from"./parseDuration-3bmQJghK.js";import{P as st}from"./PostRunCheckIn-TProgxfG.js";import{P as at}from"./PhotoUploader-CYV1RGOl.js";import{q as be}from"./offlineQueue-B-c8T9Pb.js";import{R as ot}from"./refresh-cw-CDXnuG9r.js";import{M as nt}from"./mountain-D0tE-zc6.js";import{P as lt}from"./pencil-C8QU9mSB.js";import"./check-F2jNoXHm.js";import"./camera-CeHwqKvj.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],it=ge("Gauge",ct);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],he=ge("MapPin",dt);function ut(){return new Date().toISOString().slice(0,10)}const xt=["Leg swings — 10 each side","High knees — 30 seconds","Ankle circles — 10 each side","Hip circles — 10 each direction","Arm swings — 20 reps"],mt=[{value:"road",label:"Road",icon:he},{value:"track",label:"Track",icon:ot},{value:"trail",label:"Trail",icon:nt},{value:"treadmill",label:"Treadmill",icon:it},{value:"other",label:"Other",icon:he}],ve="forge_run_detail_panels",ye={overview:!0,stats:!0,pace:!0,hr:!0,notes:!0};function pt(s){return s<=3?"var(--text-muted)":s<=6?"var(--text-primary)":"var(--accent)"}function bt(s){return s<=3?"Easy":s<=6?"Moderate":s<=8?"Hard":"Max Effort"}function ht(s){const d=Math.floor(s/3600),i=Math.floor(s%3600/60),x=s%60;return d>0?`${d}:${String(i).padStart(2,"0")}:${String(x).padStart(2,"0")}`:`${i}:${String(x).padStart(2,"0")}`}function vt(s,d){if(!s||!d)return"—";const i=Math.round(s/d),x=Math.floor(i/60),O=i%60;return`${x}:${String(O).padStart(2,"0")}/mi`}function yt(s){const d=(s==null?void 0:s.splits)||(s==null?void 0:s.splits_json)||(s==null?void 0:s.gps_splits);if(!d)return[];if(Array.isArray(d))return d;if(typeof d=="string")try{const i=JSON.parse(d);return Array.isArray(i)?i:[]}catch{return[]}return[]}function gt({effort:s,setEffort:d}){return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:4},children:Array.from({length:10},(i,x)=>x+1).map(i=>{const x=i<=s;return e.jsx("button",{type:"button",onClick:()=>d(i),style:{flex:1,height:40,borderRadius:6,border:"1px solid var(--border-subtle)",cursor:"pointer",background:x?"var(--accent)":"var(--bg-base)"}},i)})}),e.jsxs("div",{style:{marginTop:10,textAlign:"center"},children:[e.jsx("span",{style:{fontSize:36,fontWeight:900,color:pt(s),lineHeight:1},children:s}),e.jsx("div",{style:{fontSize:13,color:"var(--text-muted)",marginTop:3,fontWeight:600},children:bt(s)})]})]})}function ft({workout:s,onClose:d}){if(!s)return null;const i=async()=>{const x=`${s.day}: ${s.typeLabel}
Distance: ${s.distanceLabel}
${s.pace?`Pace: ${s.pace}
`:""}${s.description?`Notes: ${s.description}`:""}`;try{await navigator.clipboard.writeText(x)}catch{}};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)"},children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl p-5",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h3",{className:"text-xl font-black mb-4",style:{color:"var(--text-primary)"},children:"Today's Workout"}),e.jsxs("div",{className:"rounded-xl p-4 mb-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"text-xs font-semibold uppercase mb-2",style:{color:"var(--text-muted)"},children:s.day}),e.jsx("span",{className:"inline-block rounded-full px-3 py-1 text-xs font-bold mb-3",style:{background:"var(--accent)",color:"#000"},children:s.typeLabel}),e.jsxs("div",{className:"text-sm mb-1",style:{color:"var(--text-primary)"},children:[e.jsx("strong",{children:"Distance:"})," ",s.distanceLabel]}),s.pace&&e.jsxs("div",{className:"text-sm mb-1",style:{color:"var(--text-primary)"},children:[e.jsx("strong",{children:"Pace:"})," ",s.pace]}),s.description&&e.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:s.description})]}),e.jsx("button",{onClick:i,className:"w-full rounded-xl py-3 font-bold mb-3",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Copy Workout"}),e.jsx("p",{className:"text-sm mb-4",style:{color:"var(--text-muted)"},children:"Automatic watch sync is coming in the FORGE mobile app"}),e.jsx("button",{onClick:d,className:"w-full rounded-xl py-2",style:{background:"var(--bg-base)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},children:"Close"})]})})}function Dt(){var ue,xe;const s=Xe();Ze();const{units:d,fmt:i}=et(),[x,O]=a.useState(()=>new URLSearchParams(window.location.search).get("warmup")==="true"?"warmup":"done"),[v,F]=a.useState("today"),[fe,jt]=a.useState(3),[B,je]=a.useState("road"),[z,ke]=a.useState("easy"),[N,Ne]=a.useState("outside"),[L,Se]=a.useState("Generic"),[S,Q]=a.useState(null),[M,we]=a.useState("no"),[U,Ce]=a.useState(ut()),[f,_e]=a.useState(""),[H,V]=a.useState("30:00"),[G,Re]=a.useState(""),[q,Pe]=a.useState(5),[X,Z]=a.useState(!1),[Te,ee]=a.useState(!1),[te,w]=a.useState(""),[re,E]=a.useState(""),[ze,D]=a.useState(!1),[Le,se]=a.useState(!1),[I,Me]=a.useState(null),[Y,K]=a.useState([]),[kt,Nt]=a.useState(!1),[c,Ee]=a.useState(null),[De,ae]=a.useState(!1),[C,Ie]=a.useState(null),[oe,ne]=a.useState(!1),[We,Ae]=a.useState(null),[$e,le]=a.useState(!1),[n,W]=a.useState(null),[Oe,ce]=a.useState(!1),[g,Fe]=a.useState(()=>{try{return{...ye,...JSON.parse(localStorage.getItem(ve)||"{}")}}catch{return ye}}),[_,Be]=a.useState(""),[A,Ue]=a.useState([]),[R,He]=a.useState(""),[Ge,qe]=a.useState(!0),[Ye,ie]=a.useState(!1);a.useEffect(()=>{x==="done"&&F("today")},[x]),a.useEffect(()=>{let t=!0;return(async()=>{try{const{data:o}=await p.get("/checkin/today"),l=!!((o==null?void 0:o.completed)??(o==null?void 0:o.id)??o);t&&ie(l)}catch{t&&ie(!1)}finally{t&&qe(!1)}})(),()=>{t=!1}},[]),a.useEffect(()=>{v!=="today"||c||(ae(!0),p.get("/plans/today").then(t=>{var o;const r=((o=t.data)==null?void 0:o.today)||null;r&&Ee({day:r.day||r.day_of_week||new Date().toLocaleDateString(void 0,{weekday:"short"}),typeLabel:String(r.type||"run").replace("-"," ").replace(/\b\w/g,l=>l.toUpperCase()),distanceLabel:Number(r.distance_miles)>0?`${Number(r.distance_miles).toFixed(1)} miles`:"No distance target",pace:r.pace_target||r.pace||r.target_pace||"",description:r.description||r.notes||""})}).catch(()=>{}).finally(()=>ae(!1)))},[v,c]),a.useEffect(()=>{localStorage.setItem(ve,JSON.stringify(g))},[g]),a.useEffect(()=>{p.get("/gear/shoes").then(t=>{var r;return Ue(((r=t.data)==null?void 0:r.shoes)||[])}).catch(()=>{})},[]),a.useEffect(()=>{v!=="week"||C||(ne(!0),p.get("/plans/my").then(t=>{var l,y,b,u,j,m,k;const r=((y=(l=t.data)==null?void 0:l.plan)==null?void 0:y.plan_data)||((u=(b=t.data)==null?void 0:b.plan)==null?void 0:u.plan_json),o=Math.max(1,Number(((m=(j=t.data)==null?void 0:j.user_plan)==null?void 0:m.current_week)||1));if((k=r==null?void 0:r.weeks)!=null&&k.length){const h=r.weeks[o-1]||r.weeks[0];Ie((h==null?void 0:h.days)||(h==null?void 0:h.sessions)||[])}}).catch(()=>{}).finally(()=>ne(!1)))},[v,C]),a.useEffect(()=>{const t=(n==null?void 0:n.id)||(c==null?void 0:c.id);t&&p.get(`/ai/run-brief?sessionId=${t}`).then(r=>Q(r.data||null)).catch(()=>Q(null))},[n==null?void 0:n.id,c==null?void 0:c.id]);const P=a.useMemo(()=>{var b;const t=Number(f||((b=c==null?void 0:c.distanceLabel)==null?void 0:b.split(" ")[0])||0);if(!t||Y.length===0)return null;const r=Y.filter(u=>u.distance_miles>0&&u.duration_seconds>0).map(u=>u.duration_seconds/60/u.distance_miles);if(!r.length)return null;const o=r.reduce((u,j)=>u+j,0)/r.length,l=Math.round(o*.95*t),y=Math.round(o*1.05*t);return{low:l,high:y,avg:o}},[f,c,Y]),Ke=async t=>{var o,l,y,b,u,j;t.preventDefault(),E(""),w("");const r=pe(H);if(!r)return E("Please enter a valid duration.");try{Z(!0);const m=N==="inside"?"treadmill":B;if(m==="treadmill"){s("/run/treadmill",{state:{treadmillType:L}});return}const k=d==="metric"?i.milesFromKm(Number(f)):Number(f),h={date:U,type:z,surface:m,run_surface:m,distance_miles:k,duration_seconds:r,notes:G,perceived_effort:Number(q),treadmill_brand:L,shoe_id:R||null};if(!navigator.onLine){await be("/api/runs","POST",h),w("Saved offline — will sync when connected");return}const $=await p.post("/runs",h),T=((o=$.data)==null?void 0:o.id)||((y=(l=$.data)==null?void 0:l.run)==null?void 0:y.id);if(T&&p.post("/prs/auto-detect",{run_id:T}).catch(()=>{}),p.post("/badges/check",{}).catch(()=>{}),!T){w("Feedback coming soon..."),D(!0);return}Me(T),se(!0),ee(!0);let me=0,J="";for(;me<5&&!J;)me+=1,await new Promise(Ve=>setTimeout(Ve,2e3)),J=((b=(await p.get(`/coach/feedback/${T}`)).data)==null?void 0:b.ai_feedback)||"";w(J||"Your coach is thinking... check back after your next run."),D(!0)}catch(m){if(!(m!=null&&m.response)){const k=N==="inside"?"treadmill":B,h=d==="metric"?i.milesFromKm(Number(f)):Number(f),$={date:U,type:z,surface:k,run_surface:k,distance_miles:h,duration_seconds:r,notes:G,perceived_effort:Number(q),treadmill_brand:L,shoe_id:R||null};await be("/api/runs","POST",$),w("Saved offline — will sync when connected"),E("");return}E(((j=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:j.error)||"Could not save run. Check your connection and try again.")}finally{Z(!1),ee(!1)}},de=a.useMemo(()=>yt(n),[n]),Je=async()=>{if(n)try{const r=(await p.patch(`/runs/${n.id}`,{notes:_})).data||{...n,notes:_};W(r),K(o=>o.map(l=>l.id===r.id?{...l,notes:r.notes}:l))}catch{try{const r=(await p.put(`/runs/${n.id}`,{notes:_})).data||{...n,notes:_};W(r),K(o=>o.map(l=>l.id===r.id?{...l,notes:r.notes}:l))}catch{}}},Qe=async()=>{n&&window.confirm("Are you sure? This can't be undone.")&&(await p.delete(`/runs/${n.id}`),K(t=>t.filter(r=>r.id!==n.id)),W(null))};return Ge?e.jsx("div",{className:"p-4",style:{color:"var(--text-muted)"},children:"Checking today's check-in..."}):Ye?x==="warmup"?e.jsxs("div",{className:"rounded-2xl p-6",style:{background:"var(--bg-card)"},children:[e.jsx("h2",{className:"text-xl font-black mb-1",style:{color:"var(--text-primary)"},children:"Dynamic Warm-Up"}),e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:"Complete each movement before you run."}),e.jsx("div",{className:"space-y-3 mb-6",children:xt.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-3 rounded-xl p-3",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{style:{width:30,height:30,borderRadius:"50%",background:"var(--accent)",color:"#000",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:900,fontSize:13,flexShrink:0},children:r+1}),e.jsx("span",{style:{color:"var(--text-primary)",fontSize:14,fontWeight:500},children:t})]},r))}),e.jsx("button",{onClick:()=>O("done"),className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer",fontSize:16},children:"Done — Start Run"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-card)"},children:[e.jsx("div",{className:"flex gap-2 mb-5 flex-wrap",children:[{key:"today",label:"Today"},{key:"week",label:"Week"},{key:"log",label:"Manual"}].map(t=>e.jsx("button",{onClick:()=>F(t.key),style:{padding:"5px 18px",borderRadius:999,border:v===t.key?"1.5px solid var(--accent)":"1.5px solid var(--border-subtle)",background:v===t.key?"var(--accent)":"transparent",color:v===t.key?"#000":"var(--text-muted)",fontWeight:700,fontSize:13,cursor:"pointer"},children:t.label},t.key))}),v==="today"&&e.jsxs("div",{children:[S&&e.jsxs("div",{className:"rounded-xl p-3 mb-3",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm",style:{color:"var(--text-primary)"},children:S.why}),e.jsxs("p",{className:"text-xs mt-1",style:{color:"var(--text-muted)"},children:["Effort: ",S.effort," · BPM: ",S.bpmRange," · Cadence: ",S.cadence]})]}),De?e.jsx("p",{style:{color:"var(--text-muted)"},children:"Loading workout..."}):c?e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("span",{className:"inline-block rounded-full px-3 py-1 text-xs font-bold mb-3",style:{background:"var(--accent)",color:"#000"},children:c.typeLabel}),e.jsx("p",{className:"text-lg font-bold",style:{color:"var(--text-primary)"},children:c.distanceLabel}),c.pace&&e.jsx("p",{className:"mt-1",style:{color:"var(--text-muted)"},children:c.pace}),c.description&&e.jsx("p",{className:"mt-3 text-sm",style:{color:"var(--text-muted)"},children:c.description}),e.jsx("button",{onClick:()=>le(!0),className:"w-full mt-4 rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Send to Watch"})]}):e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{style:{color:"var(--text-muted)"},children:"No workout scheduled today — rest up or log a free run."}),e.jsx("button",{onClick:()=>F("log"),className:"mt-4 rounded-xl px-4 py-2 font-semibold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Log Free Run"})]})]}),v==="week"&&e.jsxs("div",{children:[oe&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:14},children:"Loading your week..."}),!oe&&!C&&e.jsx("div",{style:{textAlign:"center",padding:"24px 0",color:"var(--text-muted)",fontSize:14},children:"No training plan yet. Go to your Plan tab to generate one."}),C&&e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:(()=>{const t=new Date().toLocaleDateString("en-US",{weekday:"short"});return C.map((r,o)=>{const l=r.day===t,y=We===o,b=r.rest?"var(--text-muted)":r.type==="long"?"#3b82f6":"var(--accent)";return e.jsxs("div",{onClick:()=>Ae(y?null:o),style:{borderRadius:14,padding:"12px 16px",cursor:"pointer",background:l?"var(--accent-dim)":"var(--bg-base)",border:`1.5px solid ${l?"var(--accent)":"var(--border-subtle)"}`,transition:"background 0.15s"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{width:36,textAlign:"center"},children:[e.jsx("p",{style:{fontSize:12,fontWeight:700,color:l?"var(--accent)":"var(--text-muted)"},children:r.day}),l&&e.jsx("p",{style:{fontSize:9,color:"var(--accent)",fontWeight:700},children:"TODAY"})]}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:14,fontWeight:700,color:"var(--text-primary)",textTransform:"capitalize"},children:r.rest?"Rest Day":r.type==="long"?"Long Run":r.type==="easy"?"Easy Run":String(r.type).replace(/_/g," ")}),!r.rest&&r.distance_miles>0&&e.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)"},children:[Number(r.distance_miles).toFixed(1)," miles"]})]})]}),e.jsx("span",{style:{fontSize:11,fontWeight:700,color:b,background:r.rest?"var(--bg-card)":"transparent",padding:"3px 8px",borderRadius:8,border:`1px solid ${b}`},children:r.rest?"Rest":r.type==="long"?"Long":"Easy"})]}),y&&e.jsxs("div",{style:{marginTop:12,paddingTop:12,borderTop:"1px solid var(--border-subtle)"},children:[r.description&&e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)",lineHeight:1.6,marginBottom:12},children:r.description}),!r.rest&&e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:12},children:[r.distance_miles>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:Number(r.distance_miles).toFixed(1)}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"miles"})]}),r.duration_min>0&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:r.duration_min}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"minutes"})]}),r.pace_target&&e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:18,fontWeight:900,color:"var(--text-primary)"},children:r.pace_target}),e.jsx("p",{style:{fontSize:11,color:"var(--text-muted)"},children:"target pace"})]})]}),!r.rest&&l&&e.jsx("button",{onClick:u=>{u.stopPropagation(),s("/run/active",{state:{countdown:fe,runType:r.type||"easy",runEnvironment:"outdoor",surface:M==="yes"?"track":"road",mapMyRun:!0,trackMode:M==="yes"}})},style:{width:"100%",background:"var(--accent)",color:"#000",fontWeight:900,borderRadius:10,padding:"12px",border:"none",cursor:"pointer",fontSize:14},children:"Start This Run"})]})]},o)})})()})]}),v==="log"&&e.jsxs("form",{onSubmit:Ke,className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("p",{className:"text-sm mb-2",style:{color:"var(--text-primary)"},children:"Run type"}),e.jsx("div",{className:"flex gap-2 mb-4",children:["easy","tempo","long","walk"].map(t=>e.jsx("button",{type:"button",onClick:()=>ke(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:z===t?"var(--accent)":"var(--bg-card)",color:z===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t==="walk"?"Walk":t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsx("p",{className:"text-sm mb-2",style:{color:"var(--text-primary)"},children:"Are you running outside or inside?"}),e.jsx("div",{className:"flex gap-2",children:["outside","inside"].map(t=>e.jsx("button",{type:"button",onClick:()=>Ne(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:N===t?"var(--accent)":"var(--bg-card)",color:N===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),N==="outside"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"Are you doing a track workout?"}),e.jsx("div",{className:"flex gap-2",children:["yes","no"].map(t=>e.jsx("button",{type:"button",onClick:()=>we(t),className:"rounded-full px-3 py-1 text-xs font-semibold",style:{background:M===t?"var(--accent)":"var(--bg-card)",color:M===t?"#000":"var(--text-muted)",border:"1px solid var(--border-subtle)"},children:t==="yes"?"Yes (track intervals)":"No (road run)"},t))})]}),N==="inside"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs mb-1",style:{color:"var(--text-muted)"},children:"What treadmill are you using?"}),e.jsx("select",{value:L,onChange:t=>Se(t.target.value),className:"w-full rounded-xl px-3 py-2",style:{background:"var(--bg-card)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)"},children:["Generic","Peloton","NordicTrack","Precor","Life Fitness","Other"].map(t=>e.jsx("option",{value:t,children:t},t))})]})]}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("input",{type:"number",step:"0.1",min:"0",required:!0,className:"text-5xl font-bold bg-transparent text-center w-32 focus:outline-none",style:{color:"var(--accent)"},value:f,onChange:t=>_e(t.target.value),placeholder:"0.0"}),e.jsxs("div",{className:"text-sm mt-1",style:{color:"var(--text-muted)"},children:["Distance (",i.distanceLabel,")"]}),P&&e.jsxs("p",{className:"text-xs mt-2",style:{color:"var(--text-muted)"},children:["Estimated time: ",P.low,"–",P.high," min based on your recent ",Math.floor(P.avg),":",String(Math.round(P.avg%1*60)).padStart(2,"0"),"/mi average pace"]})]})}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:e.jsx("div",{className:"flex gap-2 justify-center",children:e.jsx("input",{type:"text",required:!0,value:H,onChange:t=>V(t.target.value),onBlur:()=>{const t=pe(H);t&&V(rt(t))},placeholder:"MM:SS or HH:MM:SS",className:"w-full max-w-xs rounded-full border px-4 py-3 text-center text-xl font-bold",style:{borderColor:"var(--border-subtle)",background:"var(--bg-card)",color:"var(--text-primary)"}})})}),e.jsx("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:e.jsx("textarea",{rows:4,placeholder:"How did it feel? Anything worth remembering?",value:G,onChange:t=>Re(t.target.value),className:"w-full rounded-xl border px-4 py-3",style:{borderColor:"var(--border-subtle)",background:"var(--bg-card)",color:"var(--text-primary)"}})}),e.jsxs("div",{className:"rounded-2xl p-4",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)"},children:[e.jsx("div",{className:"flex gap-2 mb-4",children:mt.map(t=>{const r=t.icon,o=B===t.value;return e.jsxs("button",{type:"button",onClick:()=>je(t.value),style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:5,padding:"10px 4px",borderRadius:12,border:o?"2px solid var(--accent)":"2px solid var(--border-subtle)",background:o?"var(--bg-card)":"var(--bg-base)",color:o?"var(--accent)":"var(--text-muted)",cursor:"pointer",fontSize:11,fontWeight:700},children:[e.jsx(r,{size:20}),e.jsx("span",{children:t.label})]},t.value)})}),e.jsx(gt,{effort:q,setEffort:Pe})]}),A.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:6},children:"Running In"}),((ue=A.find(t=>t.id===R))==null?void 0:ue.alert)&&e.jsxs("p",{style:{fontSize:11,color:"#f97316",marginBottom:4},children:["This shoe is at ",(xe=A.find(t=>t.id===R))==null?void 0:xe.pct_used,"% — consider rotating to a fresh pair"]}),e.jsxs("select",{value:R,onChange:t=>He(t.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,background:"var(--bg-input)",color:"var(--text-primary)",border:"1px solid var(--border-subtle)",fontSize:14},children:[e.jsx("option",{value:"",children:"No shoe selected"}),A.map(t=>e.jsxs("option",{value:t.id,children:[t.brand," ",t.model,t.nickname?` (${t.nickname})`:""," — ",t.total_miles," mi"]},t.id))]}),e.jsx("button",{onClick:()=>window.location.href="/gear",style:{background:"none",border:"none",color:"var(--text-muted)",fontSize:12,cursor:"pointer",padding:"4px 0",textDecoration:"underline",marginTop:8},children:"Manage shoes / add new pair"})]}),e.jsx("input",{type:"date",value:U,onChange:t=>Ce(t.target.value),className:"w-full rounded-xl border px-4 py-3",style:{borderColor:"var(--border-subtle)",background:"var(--bg-base)",color:"var(--text-primary)"}}),e.jsx("button",{type:"submit",disabled:X||Te,className:"w-full rounded-xl py-3 font-semibold disabled:opacity-70",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:X?"Logging run...":"Save Run"}),re&&e.jsx("p",{className:"mt-2 text-sm",style:{color:"var(--accent)"},children:re}),te&&e.jsx("div",{className:"mt-2 rounded-xl p-3",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:te}),I&&e.jsx("div",{className:"mt-4",children:e.jsx(at,{activityId:I,activityType:"run"})})]}),e.jsx(tt,{to:"/",className:"mt-5 inline-block text-sm",style:{color:"var(--text-muted)"},children:"← Back"})]}),$e&&e.jsx(ft,{workout:c,onClose:()=>le(!1)}),n&&e.jsxs("div",{className:"fixed inset-0 z-50",style:{background:"var(--bg-base)"},children:[e.jsxs("div",{className:"h-full overflow-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>W(null),style:{color:"var(--text-primary)"},children:"← Back"}),e.jsx("h3",{className:"font-bold",style:{color:"var(--text-primary)"},children:"Run Detail"}),e.jsx("button",{onClick:()=>ce(!0),style:{color:"var(--text-primary)"},children:e.jsx(lt,{size:18})})]}),g.overview&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Overview"}),e.jsx("div",{className:"text-sm",style:{color:"var(--text-muted)"},children:n.date}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:n.surface||n.run_surface||"road"}),e.jsxs("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:["Effort ",n.perceived_effort||5,"/10"]}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{background:"var(--bg-base)",color:"var(--text-primary)"},children:n.type})]})]}),g.stats&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Stats"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Distance"}),e.jsxs("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:[n.distance_miles||0," mi"]})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Time"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:ht(n.duration_seconds||0)})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Avg Pace"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:vt(n.duration_seconds,n.distance_miles)})]}),e.jsxs("div",{className:"rounded-xl p-3",style:{background:"var(--bg-base)"},children:[e.jsx("div",{className:"text-xs",style:{color:"var(--text-muted)"},children:"Calories"}),e.jsx("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:n.calories||"—"})]})]})]}),g.pace&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Pace Chart"}),de.length?e.jsx("svg",{width:"100%",height:"120",viewBox:"0 0 320 120",children:de.map((t,r)=>{const o=Number(t.seconds||t.pace_seconds||t.value||0),l=Math.max(10,100-Math.min(90,Math.floor(o/10)));return e.jsx("rect",{x:10+r*30,y:110-l,width:"20",height:l,fill:"var(--accent)"},r)})}):e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"GPS splits available in the mobile app"})]}),g.hr&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Heart Rate"}),n.avg_hr||n.avg_heart_rate?e.jsxs("div",{className:"text-2xl font-black",style:{color:"var(--text-primary)"},children:[n.avg_hr||n.avg_heart_rate," bpm"]}):e.jsx("p",{className:"text-sm",style:{color:"var(--text-muted)"},children:"Connect a watch to see HR data"})]}),g.notes&&e.jsxs("div",{className:"rounded-xl p-4 mb-3",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-semibold mb-2",style:{color:"var(--text-primary)"},children:"Notes"}),e.jsx("textarea",{rows:5,value:_,onChange:t=>Be(t.target.value),className:"w-full rounded-xl border px-3 py-2",style:{borderColor:"var(--border-subtle)",background:"var(--bg-base)",color:"var(--text-primary)"}}),e.jsx("button",{onClick:Je,className:"mt-2 rounded-lg px-3 py-2 text-sm font-semibold",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Save Notes"})]}),e.jsx("button",{onClick:Qe,className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--bg-card)",color:"var(--accent)",border:"1px solid var(--accent)"},children:"Delete Run"})]}),Oe&&e.jsxs("div",{className:"fixed inset-x-0 bottom-0 z-10 rounded-t-2xl p-4",style:{background:"var(--bg-card)",borderTop:"1px solid var(--border-subtle)"},children:[e.jsx("h4",{className:"font-bold mb-3",style:{color:"var(--text-primary)"},children:"Customize Panels"}),Object.entries({overview:"Overview",stats:"Stats Grid",pace:"Pace Chart",hr:"Heart Rate",notes:"Notes"}).map(([t,r])=>e.jsxs("label",{className:"flex items-center justify-between py-2",style:{color:"var(--text-primary)"},children:[e.jsx("span",{children:r}),e.jsx("input",{type:"checkbox",checked:g[t],onChange:o=>Fe(l=>({...l,[t]:o.target.checked}))})]},t)),e.jsx("button",{onClick:()=>ce(!1),className:"w-full mt-3 rounded-xl py-2",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Done"})]})]}),Le&&I&&e.jsx(st,{runId:I,onDone:()=>{se(!1),s("/")}}),ze&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center px-4",style:{background:"rgba(0,0,0,0.7)"},children:e.jsxs("div",{className:"w-full max-w-sm rounded-2xl p-5",style:{background:"var(--bg-card)",border:"1px solid var(--border-subtle)"},children:[e.jsx("h3",{className:"text-xl font-black",style:{color:"var(--text-primary)"},children:"Great run! Time to recover."}),e.jsx("p",{className:"mt-2 text-sm",style:{color:"var(--text-muted)"},children:"Post-run recovery uses static holds. Hold each stretch for the full duration to target the muscles you just used."}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{D(!1),s("/stretches/session?type=post")},className:"flex-1 rounded-xl px-4 py-2 font-bold",style:{background:"var(--accent)",color:"#000",border:"none"},children:"Start Recovery"}),e.jsx("button",{onClick:()=>D(!1),className:"flex-1 rounded-xl px-4 py-2",style:{background:"var(--bg-base)",border:"1px solid var(--border-subtle)",color:"var(--text-muted)"},children:"Skip"})]})]})})]}):e.jsxs("div",{className:"rounded-2xl p-6",style:{background:"var(--bg-card)"},children:[e.jsx("h2",{className:"text-xl font-black mb-2",style:{color:"var(--text-primary)"},children:"Morning Check-In Required"}),e.jsx("p",{className:"text-sm mb-5",style:{color:"var(--text-muted)"},children:"Complete your morning check-in before starting a run."}),e.jsx("button",{onClick:()=>s("/checkin"),className:"w-full rounded-xl py-3 font-bold",style:{background:"var(--accent)",color:"#000",border:"none",cursor:"pointer"},children:"Go to Check-In"})]})}export{Dt as default};
